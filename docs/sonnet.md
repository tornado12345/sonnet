<!-- This file is machine generated: DO NOT EDIT THIS FILE.
     Edits will be overwritten the next time the file is generated. -->
<!-- common_typos_disable -->
<!--* freshness: { exempt: true } *-->

# sonnet - module reference
This python module contains Neural Network Modules for TensorFlow.

Each module is a Python object which conceptually "owns" any
variables required in that part of the Neural Network. The `__call__` function
on the object is used to connect that Module into the Graph, and this may be
called repeatedly with sharing automatically taking place.

Everything public should be imported by this top level `__init__.py` so that the
library can be used as follows:

```
import sonnet as snt

linear = snt.Linear(...)
```

## Other Functions and Classes
### [`class ACTCore`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/pondering_rnn.py?q=class:ACTCore)<a id="ACTCore" />

Adaptive computation time core.

Implementation of the model described in "Adaptive Computation Time for
Recurrent Neural Networks" paper, https://arxiv.org/abs/1603.08983.

The `ACTCore` incorporates the pondering RNN of ACT, with different
computation times for each element in the mini batch. Each pondering step is
performed by the `core` passed to the constructor of `ACTCore`.

The output of the `ACTCore` is made of `(act_out, (iteration, remainder)`,
where

  * `iteration` counts the number of pondering step in each batch element;
  * `remainder` is the remainder as defined in the ACT paper;
  * `act_out` is the weighted average output of all pondering steps (see ACT
  paper for more info).

#### [`ACTCore.__init__(core, output_size, threshold, get_state_for_halting, max_steps=0, name='act_core')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/pondering_rnn.py?l=73)<a id="ACTCore.__init__" />

Constructor.

##### Args:


* `core`: A `sonnet.RNNCore` object. This should only take a single `Tensor`
      in input, and output only a single flat `Tensor`.
* `output_size`: An integer. The size of each output in the sequence.
* `threshold`: A float between 0 and 1. Probability to reach for ACT to stop
      pondering.
* `get_state_for_halting`: A callable that can take the `core` state and
      return the input to the halting function.
* `max_steps`: Integer >= 0, that controls the maximum number of ponder steps.
      If equal to 0, then this disables control.
* `name`: A string. The name of this module.

##### Raises:


* `ValueError`: if `threshold` is not between 0 and 1.
* `ValueError`: if `core` has either nested outputs or outputs that are not
      one dimensional.


#### [`ACTCore.__call__(x, prev_state)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/pondering_rnn.py?l=166)<a id="ACTCore.__call__" />

Connects the core to the graph.

##### Args:


* `x`: Input `Tensor` of shape `(batch_size, input_size)`.
* `prev_state`: Previous state. This could be a `Tensor`, or a tuple of
      `Tensor`s.

##### Returns:

  The tuple `(output, state)` for this core.

##### Raises:


* `ValueError`: if the `Tensor` `x` does not have rank 2.


#### [`ACTCore.batch_size`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/pondering_rnn.py?l=122)<a id="ACTCore.batch_size" />




#### [`ACTCore.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="ACTCore.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`ACTCore.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="ACTCore.defun" />

Wraps this modules call method in a callable graph function.


#### [`ACTCore.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="ACTCore.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`ACTCore.dtype`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/pondering_rnn.py?l=127)<a id="ACTCore.dtype" />




#### [`ACTCore.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="ACTCore.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`ACTCore.get_possible_initializer_keys()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=505)<a id="ACTCore.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`ACTCore.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="ACTCore.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`ACTCore.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="ACTCore.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`ACTCore.initial_state(*args, **kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/pondering_rnn.py?l=110)<a id="ACTCore.initial_state" />

Builds the default start state for an RNNCore.

##### Args:


* `batch_size`: An int, or scalar int32 Tensor representing the batch size.
* `dtype`: The data type to use for the state.
* `trainable`: Boolean that indicates whether to learn the initial state.
    Note that intializers and regularizers will be ignored if
    `trainable=False`.
* `trainable_initializers`: An initializer function or nested structure of
      functions with same structure as the `state_size` property of the
      core, to be used as initializers of the initial state variable.
* `trainable_regularizers`: Optional regularizer function or nested structure
    of functions with the same structure as the `state_size` property of the
    core, to be used as regularizers of the initial state variable. As a
    default, no regularizers are used. A regularizer should be a function
    that takes a single `Tensor` as an input and returns a scalar `Tensor`
    output, e.g. the L1 and L2 regularizers in `tf.contrib.layers`.
* `name`: Optional string used to prefix the initial state variable names, in
      the case of a trainable initial state. If not provided, defaults to
      the name of the module.

##### Returns:

  A tensor or nested tuple of tensors with same structure and shape as the
  `state_size` property of the core.

##### Raises:


* `ValueError`: if the user passes initializers that are not functions.
* `ValueError`: if the user passes regularizers that are not functions.


#### [`ACTCore.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="ACTCore.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`ACTCore.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="ACTCore.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`ACTCore.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="ACTCore.module_name" />

Returns the name of the Module.


#### [`ACTCore.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="ACTCore.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`ACTCore.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="ACTCore.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`ACTCore.output_size`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/pondering_rnn.py?l=113)<a id="ACTCore.output_size" />

Integer or TensorShape: size of outputs produced by this cell.


#### [`ACTCore.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="ACTCore.scope_name" />

Returns the full name of the Module's variable scope.


#### [`ACTCore.state_size`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/pondering_rnn.py?l=118)<a id="ACTCore.state_size" />

size(s) of state(s) used by this cell.

It can be represented by an Integer, a TensorShape or a tuple of Integers
or TensorShapes.


#### [`ACTCore.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="ACTCore.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`ACTCore.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="ACTCore.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`ACTCore.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="ACTCore.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`ACTCore.zero_state(batch_size, dtype)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/rnn_core.py?l=260)<a id="ACTCore.zero_state" />

Return zero-filled state tensor(s).

##### Args:


* `batch_size`: int, float, or unit Tensor representing the batch size.
* `dtype`: the data type to use for the state.

##### Returns:

  If `state_size` is an int or TensorShape, then the return value is a
  `N-D` tensor of shape `[batch_size x state_size]` filled with zeros.

  If `state_size` is a nested list or tuple, then the return value is
  a nested list or tuple (of the same structure) of `2-D` tensors with
  the shapes `[batch_size x s]` for each s in `state_size`.



### [`class AbstractModule`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?q=class:AbstractModule)<a id="AbstractModule" />

Superclass for Sonnet Modules.

This class defines the functionality that every module should implement,
principally the `build` method which is wrapped using `tf.make_template`
and called from `__call__`. Every time the module is called it will
be connected into the graph but using the same shared set of variables, thanks
to the template.

For this to work correctly, the `build` implementation in the derived class
must access all variables using `tf.get_variable`, not `tf.Variable`. The same
set of variables must be created each time, if this is not the case an Error
will be raised.

Every subclass must call this class' `__init__` at the start of their
`__init__`, passing the relevant name. If this step is omitted variable
sharing will not work.

#### [`AbstractModule.__init__(_sentinel=None, custom_getter=None, name=None)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=127)<a id="AbstractModule.__init__" />

Performs the initialisation necessary for all AbstractModule instances.

Every subclass of AbstractModule must begin their constructor with a call to
this constructor, i.e.

`super(MySubModule, self).__init__(custom_getter=custom_getter, name=name)`.

If you instantiate sub-modules in __init__ you must create them within the
`_enter_variable_scope` context manager to ensure they are in the module's
variable scope. Alternatively, instantiate sub-modules in `_build`.

##### Args:

  _sentinel: Variable that only carries a non-None value if `__init__` was
      called without named parameters. If this is the case, a deprecation
      warning is issued in form of a `ValueError`.

* `custom_getter`: Callable or dictionary of callables to use as
    custom getters inside the module. If a dictionary, the keys
    correspond to regexes to match variable names. See the `tf.get_variable`
    documentation for information about the custom_getter API.
* `name`: Name of this module. Used to construct the Templated build function.
      If `None` the module's class name is used (converted to snake case).

##### Raises:


* `TypeError`: If `name` is not a string.
* `TypeError`: If a given `custom_getter` is not callable.
* `ValueError`: If `__init__` was called without named arguments.


#### [`AbstractModule.__call__(*args, **kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=296)<a id="AbstractModule.__call__" />

Add elements to the Graph, computing output Tensors from input Tensors.

Subclasses must implement this method, which will be wrapped in a Template.

##### Args:


* `*args`: Input Tensors.
* `**kwargs`: Additional Python flags controlling connection.

##### Returns:

  output Tensor(s).


#### [`AbstractModule.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="AbstractModule.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`AbstractModule.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="AbstractModule.defun" />

Wraps this modules call method in a callable graph function.


#### [`AbstractModule.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="AbstractModule.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`AbstractModule.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="AbstractModule.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`AbstractModule.get_possible_initializer_keys()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=505)<a id="AbstractModule.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`AbstractModule.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="AbstractModule.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`AbstractModule.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="AbstractModule.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`AbstractModule.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="AbstractModule.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`AbstractModule.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="AbstractModule.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`AbstractModule.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="AbstractModule.module_name" />

Returns the name of the Module.


#### [`AbstractModule.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="AbstractModule.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`AbstractModule.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="AbstractModule.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`AbstractModule.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="AbstractModule.scope_name" />

Returns the full name of the Module's variable scope.


#### [`AbstractModule.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="AbstractModule.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`AbstractModule.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="AbstractModule.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`AbstractModule.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="AbstractModule.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.



### [`class AddBias`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?q=class:AddBias)<a id="AddBias" />

AddBias module.

#### [`AddBias.__init__(output_shape=None, bias_dims=None, initializers=None, partitioners=None, regularizers=None, name='add')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?l=541)<a id="AddBias.__init__" />

Constructs an AddBias module that supports broadcasting.

##### Args:


* `output_shape`: Output dimensionality. `output_shape` can be either `None`,
      a `tuple`, or a `callable`. In the latter case, since the function
      invocation is deferred to graph construction time, the user must only
      ensure that `output_shape` can be called, returning a tuple, when
      build is called. If `output_shape` is left as `None`, the size will be
      directly inferred by the input.
* `bias_dims`: List of which dimensions to retain from the input shape when
      constructing the bias. The remaining dimensions will get broadcasted
      over (given size of 1), and leading dimensions will be removed
      completely. For example, for an input of [batch_size, dim1_size,
      dim2_size, dim3_size] and `bias_dims=[1, 3]`, the resulting
      bias will have shape [dim1_size, 1, dim3_size]. The default is to
      retain all dimensions apart from the minibatch dimension. Trying to
      retain the bias shape over the minibatch dimension, e.g.
      `bias_dims=[0]`, will result in an error at build time. See the
      'Example Usage' section below for more information.
* `initializers`: Optional dict containing ops to initialize the biases
      (with key 'b'). The default initializer for the bias is a zero
      initializer.
* `partitioners`: Optional dict containing a partitioner to partition
      the bias (with key 'b'). As a default, no partitioner is used.
* `regularizers`: Optional dict containing regularizers of the biases
    (with key 'b'). As a default, no regularizers are used. A regularizer
    should be a function that takes a single `Tensor` as an input and
    returns a scalar `Tensor` output, e.g. the L1 and L2 regularizers in
    `tf.contrib.layers`.
* `name`: Name of the module.

Example Usage:

```python
# Create a 4D input Tensor.
input = tf.random_normal(
    shape=(batch_size, dim1_size, dim2_size, dim3_size)))

# Create a scalar bias:
scalar_bias = snt.AddBias(bias_dims=[])
scalar_bias_output = scalar_bias(input)
scalar_bias.b.get_shape()  # ()

# Create a bias over all non-minibatch dimensions:
all_bias = snt.AddBias()  # or snt.AddBias(bias_dims=None)
all_bias_output = all_bias(input)
all_bias.b.get_shape()  # (dim1_size, dim2_size, dim3_size)

# Create a bias over the last non-minibatch dimension:
last_bias = snt.AddBias(bias_dims=[-1])
last_bias_output = last_bias(input)
last_bias.b.get_shape()  # (dim3_size)

# Create a bias over the first non-minibatch dimension:
first_bias = snt.AddBias(bias_dims=[1])
first_bias_output = first_bias(input)
first_bias.b.get_shape()  # (dim1_size, 1, 1)

# Subtract and later add the same learned bias:
bias = snt.AddBias()
hidden1 = bias(input, multiplier=-1)
# ...
reconstructed_input = bias(hidden4)

```

##### Raises:


* `KeyError`: If `initializers` contains any keys other than 'b'.
* `KeyError`: If `partitioners` contains any keys other than 'b'.
* `KeyError`: If `regularizers` contains any keys other than 'b'.
* `TypeError`: If any of the given initializers are not callable.
* `TypeError`: If any of the given partitioners are not callable.
* `TypeError`: If any of the given regularizers are not callable.


#### [`AddBias.__call__(inputs, multiplier=1)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?l=634)<a id="AddBias.__call__" />

Connects the Add module into the graph, with input Tensor `inputs`.

##### Args:


* `inputs`: A Tensor of size `[batch_size, input_size1, ...]`.
* `multiplier`: A scalar or Tensor which the bias term is multiplied by
    before adding it to `inputs`. Anything which works in the expression
    `bias * multiplier` is acceptable here. This may be useful if you want
    to add a bias in one place and subtract the same bias in another place
    via `multiplier=-1`.

##### Returns:

  A Tensor of size `[batch_size, input_size1, ...]`.

##### Raises:

  base.IncompatibleShapeError: If the input is not a >= 2D `Tensor`.
  base.IncompatibleShapeError: If connecting the module into the graph
      any time after the first time, and the inferred size of the input does
      not match previous invocations.
  base.IncompatibleShapeError: If the `output_shape` has been specified
      but it does not match the input_shape`.
  base.ParentNotBuiltError: If the module is a transposed and the original
      untransposed module has not been built.


#### [`AddBias.b`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?l=705)<a id="AddBias.b" />

Returns the Variable containing the bias.

##### Returns:

  Variable object containing the bias, from the most recent __call__.

##### Raises:

  base.NotConnectedError: If the module has not been connected to the
      graph yet, meaning the variables do not exist.


#### [`AddBias.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="AddBias.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`AddBias.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="AddBias.defun" />

Wraps this modules call method in a callable graph function.


#### [`AddBias.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="AddBias.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`AddBias.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="AddBias.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`AddBias.get_possible_initializer_keys()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=505)<a id="AddBias.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`AddBias.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="AddBias.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`AddBias.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="AddBias.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`AddBias.input_shape`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?l=720)<a id="AddBias.input_shape" />

Returns shape of input `Tensor` passed at last call to `build`.


#### [`AddBias.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="AddBias.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`AddBias.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="AddBias.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`AddBias.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="AddBias.module_name" />

Returns the name of the Module.


#### [`AddBias.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="AddBias.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`AddBias.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="AddBias.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`AddBias.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="AddBias.scope_name" />

Returns the full name of the Module's variable scope.


#### [`AddBias.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="AddBias.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`AddBias.transpose(name=None)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?l=727)<a id="AddBias.transpose" />

Returns transposed `AddBias` module.

##### Args:


* `name`: Optional string assigning name of transpose module. The default name
      is constructed by appending "_transpose" to `self.module_name`.

##### Returns:

  Transposed `AddBias` module.


#### [`AddBias.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="AddBias.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`AddBias.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="AddBias.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.



### [`class AffineGridWarper`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/spatial_transformer.py?q=class:AffineGridWarper)<a id="AffineGridWarper" />

Affine Grid Warper class.

The affine grid warper generates a reference grid of n-dimensional points
and warps it via an affine transormation model determined by an input
parameter Tensor. Some of the transformation parameters can be fixed at
construction time via an `AffineWarpConstraints` object.

#### [`AffineGridWarper.__init__(source_shape, output_shape, constraints=None, name='affine_grid_warper')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/spatial_transformer.py?l=159)<a id="AffineGridWarper.__init__" />

Constructs an AffineGridWarper.

`source_shape` and `output_shape` are used to define the size of the source
and output signal domains, as opposed to the shape of the respective
Tensors. For example, for an image of size `width=W` and `height=H`,
`{source,output}_shape=[H, W]`; for a volume of size `width=W`, `height=H`
and `depth=D`, `{source,output}_shape=[H, W, D]`.

##### Args:


* `source_shape`: Iterable of integers determining the size of the source
    signal domain.
* `output_shape`: Iterable of integers determining the size of the destination
    resampled signal domain.
* `constraints`: Either a double list of shape `[N, N+1]` defining constraints
    on the entries of a matrix defining an affine transformation in N
    dimensions, or an `AffineWarpConstraints` object. If the double list is
    passed, a numeric value bakes in a constraint on the corresponding
    entry in the transformation matrix, whereas `None` implies that the
    corresponding entry will be specified at run time.
* `name`: Name of module.

##### Raises:


* `Error`: If constraints fully define the affine transformation; or if
    input grid shape and contraints have different dimensionality.
* `TypeError`: If output_shape and source_shape are not both iterable.


#### [`AffineGridWarper.__call__(inputs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/spatial_transformer.py?l=274)<a id="AffineGridWarper.__call__" />

Assembles the module network and adds it to the graph.

The internal computation graph is assembled according to the set of
constraints provided at construction time.

##### Args:


* `inputs`: Tensor containing a batch of transformation parameters.

##### Returns:

  A batch of warped grids.

##### Raises:


* `Error`: If the input tensor size is not consistent with the constraints
    passed at construction time.


#### [`AffineGridWarper.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="AffineGridWarper.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`AffineGridWarper.constraints`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/spatial_transformer.py?l=357)<a id="AffineGridWarper.constraints" />




#### [`AffineGridWarper.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="AffineGridWarper.defun" />

Wraps this modules call method in a callable graph function.


#### [`AffineGridWarper.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="AffineGridWarper.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`AffineGridWarper.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="AffineGridWarper.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`AffineGridWarper.get_possible_initializer_keys()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=505)<a id="AffineGridWarper.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`AffineGridWarper.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="AffineGridWarper.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`AffineGridWarper.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="AffineGridWarper.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`AffineGridWarper.inverse(name=None)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/spatial_transformer.py?l=361)<a id="AffineGridWarper.inverse" />

Returns a `sonnet` module to compute inverse affine transforms.

  The function first assembles a network that given the constraints of the
  current AffineGridWarper and a set of input parameters, retrieves the
  coefficients of the corresponding inverse affine transform, then feeds its
  output into a new AffineGridWarper setup to correctly warp the `output`
  space into the `source` space.

##### Args:


* `name`: Name of module implementing the inverse grid transformation.

##### Returns:

  A `sonnet` module performing the inverse affine transform of a reference
  grid of points via an AffineGridWarper module.

##### Raises:

  tf.errors.UnimplementedError: If the function is called on a non 2D
    instance of AffineGridWarper.


#### [`AffineGridWarper.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="AffineGridWarper.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`AffineGridWarper.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="AffineGridWarper.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`AffineGridWarper.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="AffineGridWarper.module_name" />

Returns the name of the Module.


#### [`AffineGridWarper.n_coeff`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/spatial_transformer.py?l=86)<a id="AffineGridWarper.n_coeff" />

Returns number of coefficients of warping function.


#### [`AffineGridWarper.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="AffineGridWarper.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`AffineGridWarper.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="AffineGridWarper.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`AffineGridWarper.output_shape`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/spatial_transformer.py?l=101)<a id="AffineGridWarper.output_shape" />

Returns a tuple containing the shape of the output grid.


#### [`AffineGridWarper.psi`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/spatial_transformer.py?l=91)<a id="AffineGridWarper.psi" />

Returns a list of features used to compute the grid warp.


#### [`AffineGridWarper.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="AffineGridWarper.scope_name" />

Returns the full name of the Module's variable scope.


#### [`AffineGridWarper.source_shape`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/spatial_transformer.py?l=96)<a id="AffineGridWarper.source_shape" />

Returns a tuple containing the shape of the source signal.


#### [`AffineGridWarper.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="AffineGridWarper.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`AffineGridWarper.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="AffineGridWarper.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`AffineGridWarper.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="AffineGridWarper.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.



### [`class AffineWarpConstraints`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/spatial_transformer.py?q=class:AffineWarpConstraints)<a id="AffineWarpConstraints" />

Affine warp contraints class.

`AffineWarpConstraints` allow for very succinct definitions of constraints on
the values of entries in affine transform matrices.

#### [`AffineWarpConstraints.__init__(constraints=((None, None, None), (None, None, None)))`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/spatial_transformer.py?l=468)<a id="AffineWarpConstraints.__init__" />

Creates a constraint definition for an affine transformation.

##### Args:


* `constraints`: A doubly-nested iterable of shape `[N, N+1]` defining
    constraints on the entries of a matrix that represents an affine
    transformation in `N` dimensions. A numeric value bakes in a constraint
    on the corresponding entry in the transformation matrix, whereas `None`
    implies that the corresponding entry will be specified at run time.

##### Raises:


* `TypeError`: If `constraints` is not a nested iterable.
* `ValueError`: If the double iterable `constraints` has inconsistent
    dimensions.


#### [`AffineWarpConstraints.combine_with(additional_constraints)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/spatial_transformer.py?l=538)<a id="AffineWarpConstraints.combine_with" />

Combines two sets of constraints into a coherent single set.


#### [`AffineWarpConstraints.constraints`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/spatial_transformer.py?l=514)<a id="AffineWarpConstraints.constraints" />




#### [`AffineWarpConstraints.mask`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/spatial_transformer.py?l=510)<a id="AffineWarpConstraints.mask" />




#### [`AffineWarpConstraints.no_constraints(num_dim=2)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/spatial_transformer.py?l=549)<a id="AffineWarpConstraints.no_constraints" />

Empty set of constraints for a num_dim-ensional affine transform.


#### [`AffineWarpConstraints.no_shear_2d()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/spatial_transformer.py?l=586)<a id="AffineWarpConstraints.no_shear_2d" />




#### [`AffineWarpConstraints.no_shear_3d()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/spatial_transformer.py?l=590)<a id="AffineWarpConstraints.no_shear_3d" />

Assigns contraints on shear components of affine transform in 3d.


#### [`AffineWarpConstraints.num_dim`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/spatial_transformer.py?l=518)<a id="AffineWarpConstraints.num_dim" />




#### [`AffineWarpConstraints.num_free_params`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/spatial_transformer.py?l=506)<a id="AffineWarpConstraints.num_free_params" />




#### [`AffineWarpConstraints.scale_2d(x=None, y=None)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/spatial_transformer.py?l=567)<a id="AffineWarpConstraints.scale_2d" />

Assigns contraints on scaling components of affine transform in 2d.


#### [`AffineWarpConstraints.scale_3d(x=None, y=None, z=None)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/spatial_transformer.py?l=573)<a id="AffineWarpConstraints.scale_3d" />

Assigns contraints on scaling components of affine transform in 3d.


#### [`AffineWarpConstraints.shear_2d(x=None, y=None)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/spatial_transformer.py?l=580)<a id="AffineWarpConstraints.shear_2d" />

Assigns contraints on shear components of affine transform in 2d.


#### [`AffineWarpConstraints.translation_2d(x=None, y=None)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/spatial_transformer.py?l=554)<a id="AffineWarpConstraints.translation_2d" />

Assign contraints on translation components of affine transform in 2d.


#### [`AffineWarpConstraints.translation_3d(x=None, y=None, z=None)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/spatial_transformer.py?l=560)<a id="AffineWarpConstraints.translation_3d" />

Assign contraints on translation components of affine transform in 3d.



### [`class AttentiveRead`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/attention.py?q=class:AttentiveRead)<a id="AttentiveRead" />

A module for reading with attention.

This module reads a weighted sum of embeddings from memory, where each
memory slot's weight is based on the logit returned by an attention embedding
module. A mask may be given to ignore some memory slots (e.g. when attending
over variable-length sequences).

#### [`AttentiveRead.__init__(attention_logit_mod, name='attention')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/attention.py?l=46)<a id="AttentiveRead.__init__" />

Initialize AttentiveRead module.

##### Args:


* `attention_logit_mod`: Module that produces logit corresponding to a memory
    slot's compatibility. Must map a [batch_size * memory_size,
    memory_word_size + query_word_size]-shaped Tensor to a
    [batch_size * memory_size, 1] shape Tensor.
* `name`: string. Name for module.


#### [`AttentiveRead.__call__(memory, query, memory_mask=None)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/attention.py?l=66)<a id="AttentiveRead.__call__" />

Perform a differentiable read.

##### Args:


* `memory`: [batch_size, memory_size, memory_word_size]-shaped Tensor of
    dtype float32. This represents, for each example and memory slot, a
    single embedding to attend over.
* `query`: [batch_size, query_word_size]-shaped Tensor of dtype float32.
    Represents, for each example, a single embedding representing a query.
* `memory_mask`: None or [batch_size, memory_size]-shaped Tensor of dtype
    bool. An entry of False indicates that a memory slot should not enter
    the resulting weighted sum. If None, all memory is used.

##### Returns:

  An AttentionOutput instance containing:

* `read`: [batch_size, memory_word_size]-shaped Tensor of dtype float32.
      This represents, for each example, a weighted sum of the contents of
      the memory.
* `weights`: [batch_size, memory_size]-shaped Tensor of dtype float32. This
      represents, for each example and memory slot, the attention weights
      used to compute the read.
* `weight_logits`: [batch_size, memory_size]-shaped Tensor of dtype float32.
      This represents, for each example and memory slot, the logits of the
      attention weights, that is, `weights` is calculated by taking the
      softmax of the weight logits.

##### Raises:


* `UnderspecifiedError`: if memory_word_size or query_word_size can not be
    inferred.
* `IncompatibleShapeError`: if memory, query, memory_mask, or output of
    attention_logit_mod do not match expected shapes.


#### [`AttentiveRead.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="AttentiveRead.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`AttentiveRead.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="AttentiveRead.defun" />

Wraps this modules call method in a callable graph function.


#### [`AttentiveRead.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="AttentiveRead.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`AttentiveRead.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="AttentiveRead.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`AttentiveRead.get_possible_initializer_keys()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=505)<a id="AttentiveRead.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`AttentiveRead.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="AttentiveRead.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`AttentiveRead.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="AttentiveRead.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`AttentiveRead.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="AttentiveRead.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`AttentiveRead.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="AttentiveRead.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`AttentiveRead.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="AttentiveRead.module_name" />

Returns the name of the Module.


#### [`AttentiveRead.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="AttentiveRead.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`AttentiveRead.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="AttentiveRead.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`AttentiveRead.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="AttentiveRead.scope_name" />

Returns the full name of the Module's variable scope.


#### [`AttentiveRead.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="AttentiveRead.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`AttentiveRead.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="AttentiveRead.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`AttentiveRead.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="AttentiveRead.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.



### [`class BatchApply`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?q=class:BatchApply)<a id="BatchApply" />

Merges a number of leading dimensions of an input tensor to manipulate it.

Merges a number of leading dimensions of a tensor into a single dimension,
connects the provided module, then splits the leading dimension of the
result to match the input.

Input tensors whose rank is smaller than the number of dimensions to collapse
(e.g. all scalar values, which are tensors of rank 0), are passed unaltered to
the provided module.

This is useful for applying some module to each timestep of a Time x Batch x N
tensor. If a module is hard coded to only support 2D (Batch x N) then the
full 3D Tensor cannot be provided. BatchApply will 'merge' the first two
dimensions of the sequence tensor by reshaping to a (Time * Batch) x N Tensor,
and then the internal module can be applied. The result of that operation is
reshaped such that its first dimensions are split to match the leading
dimensions of the input.

#### [`BatchApply.__init__(module_or_op, n_dims=2, input_example_index=0, name='batch_apply')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?l=1067)<a id="BatchApply.__init__" />

Constructor of the module.

##### Args:


* `module_or_op`: Module or tensorflow op to apply to an input tensor.
* `n_dims`: Number of dimensions to merge before using module on the input
      of BatchApply.
* `input_example_index`: Index of input that has same shape for the first
      `n_dims` dimensions as `module_or_op` output(s). This is used for
      unflattening the output(s) if static shape inference is not possible.
* `name`: Name of the module.

##### Raises:


* `TypeError`: If n_dims is not an integer.
* `ValueError`: If n_dims is not greater than zero.


#### [`BatchApply.__call__(*args, **kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?l=1094)<a id="BatchApply.__call__" />

Connects the BatchApply module into the graph.

##### Args:


* `*args`: a Tensor or a nested list or dictionary of Tensors. The input
      tensors will have their first dimensions merged, then an op or a
      module will be called on the input. The first dimension of the output
      tensor(s) will be split again based on the leading dimensions of the
      first input tensor.
* `**kwargs`: Dictionary of named arguments; used in the same way as `*args`.

##### Returns:

  A Tensor or nested list or dictionary of Tensors as a result of applying
  the process above. ("None" return values are also supported.)


#### [`BatchApply.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="BatchApply.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`BatchApply.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="BatchApply.defun" />

Wraps this modules call method in a callable graph function.


#### [`BatchApply.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="BatchApply.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`BatchApply.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="BatchApply.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`BatchApply.get_possible_initializer_keys()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=505)<a id="BatchApply.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`BatchApply.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="BatchApply.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`BatchApply.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="BatchApply.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`BatchApply.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="BatchApply.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`BatchApply.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="BatchApply.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`BatchApply.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="BatchApply.module_name" />

Returns the name of the Module.


#### [`BatchApply.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="BatchApply.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`BatchApply.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="BatchApply.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`BatchApply.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="BatchApply.scope_name" />

Returns the full name of the Module's variable scope.


#### [`BatchApply.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="BatchApply.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`BatchApply.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="BatchApply.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`BatchApply.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="BatchApply.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.



### [`class BatchFlatten`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?q=class:BatchFlatten)<a id="BatchFlatten" />

Flattens the input Tensor, preserving the batch dimension(s).

#### [`BatchFlatten.__init__(preserve_dims=1, name='batch_flatten')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?l=911)<a id="BatchFlatten.__init__" />

Constructs a BatchFlatten module.

##### Args:


* `preserve_dims`: Number of leading dimensions that will not be reshaped.
      For example, given an input Tensor with shape `[B, H, W, C]`:
        * `preserve_dims=1` will return a Tensor with shape `[B, H*W*C]`.
        * `preserve_dims=2` will return a Tensor with
            shape `[B, H, W*C]`.
        * `preserve_dims=3` will return the input itself,
            shape `[B, H, W, C]`.
        * `preserve_dims=4` will  return a Tensor with
            shape `[B, H, W, C, 1]`.
        * `preserve_dims>=5` will throw an error on build.
      The preserved dimensions can be unknown at building time.
* `name`: Name of the module.


#### [`BatchFlatten.__call__(inputs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?l=810)<a id="BatchFlatten.__call__" />

Connects the module into the graph, with input Tensor `inputs`.

##### Args:


* `inputs`: A Tensor of shape [b_1, b_2, ..., b_preserve_dims,
                             b_preserve_dims+1, ...].

##### Returns:

  A Tensor of shape [b_1, b_2, ..., b_preserve_dims,
                     b_reshape_1, b_reshape_2, ...],
    with reshaping defined by the constructor `shape` parameter.

##### Raises:


* `ValueError`: If output shape is incompatible with input shape; or if
      shape array contains non numeric entries; or if shape array contains
      more than 1 wildcard -1; or if the input array contains unknown,
      non-preserved dimensions (except when the unknown dimension is the
      only non-preserved dimension and doesn't actually need reshaping).


#### [`BatchFlatten.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="BatchFlatten.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`BatchFlatten.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="BatchFlatten.defun" />

Wraps this modules call method in a callable graph function.


#### [`BatchFlatten.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="BatchFlatten.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`BatchFlatten.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="BatchFlatten.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`BatchFlatten.get_possible_initializer_keys()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=505)<a id="BatchFlatten.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`BatchFlatten.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="BatchFlatten.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`BatchFlatten.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="BatchFlatten.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`BatchFlatten.input_shape`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?l=893)<a id="BatchFlatten.input_shape" />

Returns shape of input `Tensor` passed at last call to `build`.


#### [`BatchFlatten.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="BatchFlatten.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`BatchFlatten.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="BatchFlatten.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`BatchFlatten.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="BatchFlatten.module_name" />

Returns the name of the Module.


#### [`BatchFlatten.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="BatchFlatten.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`BatchFlatten.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="BatchFlatten.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`BatchFlatten.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="BatchFlatten.scope_name" />

Returns the full name of the Module's variable scope.


#### [`BatchFlatten.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="BatchFlatten.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`BatchFlatten.transpose(name=None)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?l=899)<a id="BatchFlatten.transpose" />

Returns transpose batch reshape.


#### [`BatchFlatten.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="BatchFlatten.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`BatchFlatten.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="BatchFlatten.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.



### [`class BatchNorm`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/batch_norm.py?q=class:BatchNorm)<a id="BatchNorm" />

Batch normalization module, including optional affine transformation.

This module maintains exponential moving averages of the mean and
variance, which can be optionally used to normalize at test time.

At training time, batch statistics (mean, variance) are not shared between
separate connections. The moving averages are shared between separate
connections. At both training and test time, the optional affine
transformation (`* gamma + beta`) is shared between separate connections.

This is also the case for distributed replica training, where the batch
statistics are not aggregated across replicas, but the moving averages are
shared globally.

When connecting the module to the graph, `is_training=True` means that

  - Update ops are created to update the moving averages with the current
    batch's statistics.
  - Features are normalized using the *current batch's statistics*. The
    `test_local_stats` setting is ignored. The moving averages are
    **not** used.

whereas `is_training=False` means that

  - Update ops are not created.
  - Features are normalized using either:
    - The test batch statistics if `test_local_stats=True` (default).
    - The moving averages if `test_local_stats=False`.

Local batch statistics are used by default at test time, but the moving
averages can be used by specifying a flag when connecting. One often wants
to use local batch statistics at test time to track the progress while the
model is trained as it would ensure that moving average updates do not affect
the training curves. Once the training is finished, it's often advantageous
to use moving average statistics, since it would make evaluation agnostic to
the batch size, and might even lead to small improvements over the local
batch statistics.

You can either update the moving averages automatically by setting
`update_ops_collection=None` or by running the ops in the given collection,
by default tf.GraphKeys.UPDATE_OPS.

For example, to run the updates automatically:

    bn = BatchNorm(update_ops_collection=None)
    train_net = bn(train_inputs, is_training=True)

this does, however, have the effect of blocking the forwards pass of the
network until the update ops have been run and may have a small performance
penalty.

For example, to run the updates manually:

    bn = BatchNorm()
    train_net = bn(train_inputs, is_training=True)

    ...

    update_ops = tf.group(*tf.get_collection(
        tf.GraphKeys.UPDATE_OPS))
    train_op = tf.group(train_op, update_ops)

Then, whenever `train_op` is run so also are the moving average update ops.

Some batch normalization caveats:

  - Batch normalization will remove the effect of adding a bias, so e.g.
    `use_bias=False` should be used for an immediately preceding snt.Linear
    module.
  - If your data batches aren't i.i.d. then batch normalization can allow your
    network to 'cheat' by using the batch statistics to peek at the rest of
    the batch. This can exhibit itself as a higher test score with
    `test_local_stats=True` than `test_local_stats=False`.

#### [`BatchNorm.__init__(axis=None, offset=True, scale=False, decay_rate=0.999, eps=0.001, initializers=None, partitioners=None, regularizers=None, update_ops_collection='update_ops', fused=False, name='batch_norm')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/batch_norm.py?l=141)<a id="BatchNorm.__init__" />

Constructs a BatchNorm module.

By default reduces over all input tensor dimensions apart from the final
dimension. This has the effect of treating pixels in 1D/2D/3D images as
additional elements of the minibatch.

If this is not the desired behaviour, the user can specify the tensor
indices to reduce over with `axis`.

##### Args:


* `axis`: Optional iterable of indices of dimensions to reduce over. By
    default `None` and all dimensions except the last are reduced over.
* `offset`: Optional boolean to specify whether or not to apply a trained
    component-wise bias after the batch normalization and scaling.
* `scale`: Optional boolean to specify whether or not to apply a trained
    component-wise scale after the batch normalization.
* `decay_rate`: Decay rate of the exponential moving averages of the mean
    and variance.
* `eps`: Small number to avoid dividing by zero when diving by the standard
    deviation.
* `initializers`: Optional dict containing ops to initialize the weights of
    the affine transform (`gamma` and `beta`).
* `partitioners`: Optional dict containing partitioners to partition the
    weights of the affine transform (`gamma` and `beta`).
* `regularizers`: Optional dict containing regularizers for the weights of the
    affine transform ('gamma' and 'beta'). As a default, no regularizers are
    used. A regularizer should be a function that takes a single `Tensor` as
    an input and returns a scalar `Tensor` output, e.g. the L1 and L2
    regularizers in `tf.contrib.layers`.
* `update_ops_collection`: Name of TensorFlow variable collection to add the
    moving average update ops to. If `None`, we instead add the update ops
    as control dependencies of the output of the module. This may result in
    some slowdown, as the feed-forward of the network is now blocked. By
    default, `tf.GraphKeys.UPDATE_OPS`.
* `fused`: Use nn.fused_batch_norm if True, nn.batch_normalization otherwise.
* `name`: Name of the module.

##### Raises:


* `KeyError`: If `initializers` contains any keys other than `gamma`, `beta`,
    `moving_mean` or `moving_variance`.
* `KeyError`: If `partitioners` or `regularizers` contains any keys other
    than `gamma` or `beta`.
* `TypeError`: If any of the given initializers, partitioners or regularizers
    are not callable.


#### [`BatchNorm.__call__(input_batch, is_training, test_local_stats=True)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/batch_norm.py?l=483)<a id="BatchNorm.__call__" />

Connects the BatchNorm module into the graph.

##### Args:


* `input_batch`: A Tensor of arbitrary dimension. By default, the final
    dimension is not reduced over when computing the minibatch statistics.
* `is_training`: A boolean to indicate if the module should be connected in
    training mode, meaning the moving averages are updated. Can be a Tensor.
* `test_local_stats`: A boolean to indicate if local batch statistics should
    be used when `is_training=False`. If not, moving averages are used.
    By default `True`. Can be a Tensor.

##### Returns:

  A tensor with the same shape as `input_batch`.

##### Raises:

  base.IncompatibleShapeError: If `axis` is not valid for the
    input shape or has negative entries.
  base.NotSupportedError: If `input_batch` has data type of `tf.bfloat16`.


#### [`BatchNorm.beta`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/batch_norm.py?l=584)<a id="BatchNorm.beta" />




#### [`BatchNorm.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="BatchNorm.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`BatchNorm.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="BatchNorm.defun" />

Wraps this modules call method in a callable graph function.


#### [`BatchNorm.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="BatchNorm.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`BatchNorm.gamma`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/batch_norm.py?l=594)<a id="BatchNorm.gamma" />




#### [`BatchNorm.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="BatchNorm.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`BatchNorm.get_possible_initializer_keys()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=505)<a id="BatchNorm.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`BatchNorm.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="BatchNorm.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`BatchNorm.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="BatchNorm.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`BatchNorm.initializers`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/batch_norm.py?l=562)<a id="BatchNorm.initializers" />




#### [`BatchNorm.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="BatchNorm.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`BatchNorm.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="BatchNorm.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`BatchNorm.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="BatchNorm.module_name" />

Returns the name of the Module.


#### [`BatchNorm.moving_mean`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/batch_norm.py?l=574)<a id="BatchNorm.moving_mean" />




#### [`BatchNorm.moving_variance`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/batch_norm.py?l=579)<a id="BatchNorm.moving_variance" />




#### [`BatchNorm.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="BatchNorm.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`BatchNorm.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="BatchNorm.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`BatchNorm.partitioners`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/batch_norm.py?l=566)<a id="BatchNorm.partitioners" />




#### [`BatchNorm.regularizers`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/batch_norm.py?l=570)<a id="BatchNorm.regularizers" />




#### [`BatchNorm.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="BatchNorm.scope_name" />

Returns the full name of the Module's variable scope.


#### [`BatchNorm.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="BatchNorm.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`BatchNorm.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="BatchNorm.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`BatchNorm.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="BatchNorm.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.



### [`class BatchNormLSTM`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?q=class:BatchNormLSTM)<a id="BatchNormLSTM" />

LSTM recurrent network cell with optional peepholes, batch normalization.

The base implementation is based on: http://arxiv.org/abs/1409.2329. We add
forget_bias (default: 1) to the biases of the forget gate in order to
reduce the scale of forgetting in the beginning of the training.

#### Peep-hole connections

Peep-hole connections may optionally be used by specifying a flag in the
constructor. These connections can aid increasing the precision of output
timing, for more details see:

  https://research.google.com/pubs/archive/43905.pdf

#### Batch normalization

The batch norm transformation (in training mode) is
  batchnorm(x) = gamma * (x - mean(x)) / stddev(x) + beta,
where gamma is a learnt scaling factor and beta is a learnt offset.

Batch normalization may optionally be used at different places in the LSTM by
specifying flag(s) in the constructor. These are applied when calculating
the gate activations and cell-to-hidden transformation. The set-up is based on

  https://arxiv.org/pdf/1603.09025.pdf

##### Batch normalization: where to apply?

Batch norm can be applied in three different places in the LSTM:

  (h) To the W_h h_{t-1} contribution to the gates from the previous hiddens.
  (x) To the W_x x_t contribution to the gates from the current input.
  (c) To the cell value c_t when calculating the output h_t from the cell.

(The notation here is consistent with the Recurrent Batch Normalization
paper). Each of these can be controlled individually, because batch norm is
expensive, and not all are necessary. The paper doesn't mention the relative
effects of these different batch norms; however, experimentation with a
shallow LSTM for the `permuted_mnist` sequence task suggests that (h) is the
most important and the other two can be left off. For other tasks or deeper
(stacked) LSTMs, other batch norm combinations may be more effective.

##### Batch normalization: collecting stats (training vs test)

When switching to testing (see `LSTM.with_batch_norm_control`), we can use a
mean and stddev learnt from the training data instead of using the statistics
from the test data. (This both increases test accuracy because the statistics
have less variance, and if the test data does not have the same distribution
as the training data then we must use the training statistics to ensure the
effective network does not change when switching to testing anyhow.)

This does however introduces a slight subtlety. The first few time steps of
the RNN tend to have varying statistics (mean and variance) before settling
down to a steady value. Therefore in general, better performance is obtained
by using separate statistics for the first few time steps, and then using the
final set of statistics for all subsequent time steps. This is controlled by
the parameter `max_unique_stats`. (We can't have an unbounded number of
distinct statistics for both technical reasons and also for the case where
test sequences are longer than anything seen in training.)

You may be fine leaving it at its default value of 1. Small values (like 10)
may achieve better performance on some tasks when testing with cached
statistics.

Attributes:
  state_size: Tuple of `tf.TensorShape`s indicating the size of state tensors.
  output_size: `tf.TensorShape` indicating the size of the core output.
  use_peepholes: Boolean indicating whether peephole connections are used.
  use_batch_norm_h: Boolean indicating whether batch norm (h) is enabled.
  use_batch_norm_x: Boolean indicating whether batch norm (x) is enabled.
  use_batch_norm_c: Boolean indicating whether batch norm (c) is enabled.

#### [`BatchNormLSTM.__init__(hidden_size, forget_bias=1.0, initializers=None, partitioners=None, regularizers=None, use_peepholes=False, use_batch_norm_h=True, use_batch_norm_x=False, use_batch_norm_c=False, max_unique_stats=1, hidden_clip_value=None, cell_clip_value=None, custom_getter=None, name='batch_norm_lstm')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=634)<a id="BatchNormLSTM.__init__" />

Construct `BatchNormLSTM`.

##### Args:


* `hidden_size`: (int) Hidden size dimensionality.
* `forget_bias`: (float) Bias for the forget activation.
* `initializers`: Dict containing ops to initialize the weights.
    This dictionary may contain any of the keys returned by
    `BatchNormLSTM.get_possible_initializer_keys`.
    The gamma and beta variables control batch normalization values for
    different batch norm transformations inside the cell; see the paper for
    details.
* `partitioners`: Optional dict containing partitioners to partition
    the weights and biases. As a default, no partitioners are used. This
    dict may contain any of the keys returned by
    `BatchNormLSTM.get_possible_initializer_keys`.
* `regularizers`: Optional dict containing regularizers for the weights and
    biases. As a default, no regularizers are used. This dict may contain
    any of the keys returned by
    `BatchNormLSTM.get_possible_initializer_keys`.
* `use_peepholes`: Boolean that indicates whether peephole connections are
    used.
* `use_batch_norm_h`: Boolean that indicates whether to apply batch
    normalization at the previous_hidden -> gates contribution. If you are
    experimenting with batch norm then this may be the most effective to
    use, and is enabled by default.
* `use_batch_norm_x`: Boolean that indicates whether to apply batch
    normalization at the input -> gates contribution.
* `use_batch_norm_c`: Boolean that indicates whether to apply batch
    normalization at the cell -> output contribution.
* `max_unique_stats`: The maximum number of steps to use unique batch norm
    statistics for. (See module description above for more details.)
* `hidden_clip_value`: Optional number; if set, then the LSTM hidden state
    vector is clipped by this value.
* `cell_clip_value`: Optional number; if set, then the LSTM cell vector is
    clipped by this value.
* `custom_getter`: Callable that takes as a first argument the true getter,
    and allows overwriting the internal get_variable method. See the
    `tf.get_variable` documentation for more details.
* `name`: Name of the module.

##### Raises:


* `KeyError`: if `initializers` contains any keys not returned by
    `BatchNormLSTM.get_possible_initializer_keys`.
* `KeyError`: if `partitioners` contains any keys not returned by
    `BatchNormLSTM.get_possible_initializer_keys`.
* `KeyError`: if `regularizers` contains any keys not returned by
    `BatchNormLSTM.get_possible_initializer_keys`.
* `ValueError`: if a peephole initializer is passed in the initializer list,
    but `use_peepholes` is False.
* `ValueError`: if a batch norm initializer is passed in the initializer list,
    but batch norm is disabled.
* `ValueError`: if none of the `use_batch_norm_*` options are True.
* `ValueError`: if `max_unique_stats` is < 1.


#### [`BatchNormLSTM.__call__(inputs, prev_state, is_training=None, test_local_stats=True)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=820)<a id="BatchNormLSTM.__call__" />

Connects the LSTM module into the graph.

If this is not the first time the module has been connected to the graph,
the Tensors provided as inputs and state must have the same final
dimension, in order for the existing variables to be the correct size for
their corresponding multiplications. The batch size may differ for each
connection.

##### Args:


* `inputs`: Tensor of size `[batch_size, input_size]`.
* `prev_state`: Tuple (prev_hidden, prev_cell), or if batch norm is enabled
    and `max_unique_stats > 1`, then (prev_hidden, prev_cell, time_step).
    Here, prev_hidden and prev_cell are tensors of size
    `[batch_size, hidden_size]`, and time_step is used to indicate the
    current RNN step.
* `is_training`: Boolean indicating whether we are in training mode (as
    opposed to testing mode), passed to the batch norm
    modules. Note to use this you must wrap the cell via the
    `with_batch_norm_control` function.
* `test_local_stats`: Boolean indicating whether to use local batch statistics
    in test mode. See the `BatchNorm` documentation for more on this.

##### Returns:

  A tuple (output, next_state) where 'output' is a Tensor of size
  `[batch_size, hidden_size]` and 'next_state' is a tuple
  (next_hidden, next_cell) or (next_hidden, next_cell, time_step + 1),
  where next_hidden and next_cell have size `[batch_size, hidden_size]`.

##### Raises:


* `ValueError`: If connecting the module into the graph any time after the
    first time, and the inferred size of the inputs does not match previous
    invocations.


#### [`BatchNormLSTM.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="BatchNormLSTM.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`BatchNormLSTM.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="BatchNormLSTM.defun" />

Wraps this modules call method in a callable graph function.


#### [`BatchNormLSTM.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="BatchNormLSTM.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`BatchNormLSTM.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="BatchNormLSTM.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`BatchNormLSTM.get_possible_initializer_keys(use_peepholes=False, use_batch_norm_h=True, use_batch_norm_x=False, use_batch_norm_c=False)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=773)<a id="BatchNormLSTM.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

##### The set of all possible initializer keys are:


* `w_gates`: weight for gates
* `b_gates`: bias of gates
* `w_f_diag`: weight for prev_cell -> forget gate peephole
* `w_i_diag`: weight for prev_cell -> input gate peephole
* `w_o_diag`: weight for prev_cell -> output gate peephole
* `gamma_h`: batch norm scaling for previous_hidden -> gates
* `gamma_x`: batch norm scaling for input -> gates
* `gamma_c`: batch norm scaling for cell -> output
* `beta_c`: batch norm bias for cell -> output

##### Args:

  cls:The class.

* `use_peepholes`: Boolean that indicates whether peephole connections are
    used.
* `use_batch_norm_h`: Boolean that indicates whether to apply batch
    normalization at the previous_hidden -> gates contribution. If you are
    experimenting with batch norm then this may be the most effective to
    turn on.
* `use_batch_norm_x`: Boolean that indicates whether to apply batch
    normalization at the input -> gates contribution.
* `use_batch_norm_c`: Boolean that indicates whether to apply batch
    normalization at the cell -> output contribution.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
    constructor.


#### [`BatchNormLSTM.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="BatchNormLSTM.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`BatchNormLSTM.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="BatchNormLSTM.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`BatchNormLSTM.initial_state(batch_size, dtype=tf.float32, trainable=False, trainable_initializers=None, trainable_regularizers=None, name=None)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=1032)<a id="BatchNormLSTM.initial_state" />

Builds the default start state tensor of zeros.

##### Args:


* `batch_size`: An int, float or scalar Tensor representing the batch size.
* `dtype`: The data type to use for the state.
* `trainable`: Boolean that indicates whether to learn the initial state.
* `trainable_initializers`: An optional pair of initializers for the
      initial hidden state and cell state.
* `trainable_regularizers`: Optional regularizer function or nested structure
    of functions with the same structure as the `state_size` property of the
    core, to be used as regularizers of the initial state variable. A
    regularizer should be a function that takes a single `Tensor` as an
    input and returns a scalar `Tensor` output, e.g. the L1 and L2
    regularizers in `tf.contrib.layers`.
* `name`: Optional string used to prefix the initial state variable names, in
      the case of a trainable initial state. If not provided, defaults to
      the name of the module.

##### Returns:

  A tensor tuple `([batch_size, state_size], [batch_size, state_size], ?)`
  filled with zeros, with the third entry present when batch norm is enabled
  with `max_unique_stats > 1', with value `0` (representing the time step).


#### [`BatchNormLSTM.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="BatchNormLSTM.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`BatchNormLSTM.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="BatchNormLSTM.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`BatchNormLSTM.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="BatchNormLSTM.module_name" />

Returns the name of the Module.


#### [`BatchNormLSTM.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="BatchNormLSTM.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`BatchNormLSTM.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="BatchNormLSTM.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`BatchNormLSTM.output_size`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=1091)<a id="BatchNormLSTM.output_size" />

`tf.TensorShape` indicating the size of the core output.


#### [`BatchNormLSTM.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="BatchNormLSTM.scope_name" />

Returns the full name of the Module's variable scope.


#### [`BatchNormLSTM.state_size`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=1080)<a id="BatchNormLSTM.state_size" />

Tuple of `tf.TensorShape`s indicating the size of state tensors.


#### [`BatchNormLSTM.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="BatchNormLSTM.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`BatchNormLSTM.use_batch_norm_c`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=1111)<a id="BatchNormLSTM.use_batch_norm_c" />

Boolean indicating whether batch norm for cell -> output is enabled.


#### [`BatchNormLSTM.use_batch_norm_h`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=1101)<a id="BatchNormLSTM.use_batch_norm_h" />

Boolean indicating whether batch norm for hidden -> gates is enabled.


#### [`BatchNormLSTM.use_batch_norm_x`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=1106)<a id="BatchNormLSTM.use_batch_norm_x" />

Boolean indicating whether batch norm for input -> gates is enabled.


#### [`BatchNormLSTM.use_peepholes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=1096)<a id="BatchNormLSTM.use_peepholes" />

Boolean indicating whether peephole connections are used.


#### [`BatchNormLSTM.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="BatchNormLSTM.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`BatchNormLSTM.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="BatchNormLSTM.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`BatchNormLSTM.with_batch_norm_control(is_training, test_local_stats=True)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=746)<a id="BatchNormLSTM.with_batch_norm_control" />

Wraps this RNNCore with the additional control input to the `BatchNorm`s.

Example usage:

  lstm = snt.BatchNormLSTM(4)
  is_training = tf.placeholder(tf.bool)
  rnn_input = ...
  my_rnn = rnn.rnn(lstm.with_batch_norm_control(is_training), rnn_input)

##### Args:


* `is_training`: Boolean that indicates whether we are in
    training mode or testing mode. When in training mode, the batch norm
    statistics are taken from the given batch, and moving statistics are
    updated. When in testing mode, the moving statistics are not updated,
    and in addition if `test_local_stats` is False then the moving
    statistics are used for the batch statistics. See the `BatchNorm` module
    for more details.
* `test_local_stats`: Boolean scalar indicated whether to use local
    batch statistics in test mode.

##### Returns:

  snt.RNNCore wrapping this class with the extra input(s) added.


#### [`BatchNormLSTM.zero_state(batch_size, dtype)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/rnn_core.py?l=260)<a id="BatchNormLSTM.zero_state" />

Return zero-filled state tensor(s).

##### Args:


* `batch_size`: int, float, or unit Tensor representing the batch size.
* `dtype`: the data type to use for the state.

##### Returns:

  If `state_size` is an int or TensorShape, then the return value is a
  `N-D` tensor of shape `[batch_size x state_size]` filled with zeros.

  If `state_size` is a nested list or tuple, then the return value is
  a nested list or tuple (of the same structure) of `2-D` tensors with
  the shapes `[batch_size x s]` for each s in `state_size`.



### [`class BatchNormV2`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/batch_norm_v2.py?q=class:BatchNormV2)<a id="BatchNormV2" />

Batch normalization module, including optional affine transformation.

This module maintains exponential moving averages of the mean and
variance, which can be optionally used to normalize at test time.

At training time, batch statistics (mean, variance) are not shared between
separate connections. The moving averages are shared between separate
connections. At both training and test time, the optional affine
transformation (`* gamma + beta`) is shared between separate connections.

This is also the case for distributed replica training, where the batch
statistics are not aggregated across replicas, but the moving averages are
shared globally.

When connecting the module to the graph, `is_training=True` means that

  - Update ops are created to update the moving averages with the current
    batch's statistics.
  - Features are normalized using the *current batch's statistics*. The
    `test_local_stats` setting is ignored. The moving averages are
    **not** used.

whereas `is_training=False` means that

  - Update ops are not created.
  - Features are normalized using either:
    - The moving averages if `test_local_stats=False` (default).
    - The test batch statistics if `test_local_stats=True`.

The moving averages are used by default at test time, but local batch
statistics can be used by specifying a flag when connecting. One often wants
to use local batch statistics at test time to track the progress while the
model is trained as it would ensure that moving average updates do not affect
the training curves. Once the training is finished, it's often advantageous
to use moving average statistics, since it would make evaluation agnostic to
the batch size, and might even lead to small improvements over the local
batch statistics.

The moving averages will be updated automatically by default, but not if
`update_ops_collection` is provided: in that case they will only be updated
when the ops in that collection are run.

For example, to run the updates automatically:

    bn = BatchNormV2()
    train_net = bn(train_inputs, is_training=True)

this does, however, have the effect of blocking the forwards pass of the
network until the update ops have been run and may have a small performance
penalty.

For example, to run the updates manually:

    bn = BatchNormV2(update_ops_collection=tf.GraphKeys.UPDATE_OPS)
    train_net = bn(train_inputs, is_training=True)

    ...

    update_ops = tf.group(*tf.get_collection(
        tf.GraphKeys.UPDATE_OPS))
    train_op = tf.group(train_op, update_ops)

Then, whenever `train_op` is run so also are the moving average update ops.

Some batch normalization caveats:

  - Batch normalization will remove the effect of adding a bias, so e.g.
    `use_bias=False` should be used for an immediately preceding snt.Linear
    module.
  - If your data batches aren't i.i.d. then batch normalization can allow your
    network to 'cheat' by using the batch statistics to peek at the rest of
    the batch. This can exhibit itself as a higher test score with
    `test_local_stats=True` than `test_local_stats=False`.

#### [`BatchNormV2.__init__(data_format=None, offset=True, scale=False, decay_rate=0.999, eps=0.001, initializers=None, partitioners=None, regularizers=None, update_ops_collection=None, fused=True, name='batch_norm')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/batch_norm_v2.py?l=158)<a id="BatchNormV2.__init__" />

Constructs a BatchNormV2 module.

Reduces over all input tensor dimensions apart from the channel
dimension. This has the effect of treating pixels in 1D/2D/3D images as
additional elements of the minibatch.

##### Args:


* `data_format`: The data format. Can be "NC", "NWC", "NCW", "NHWC", "NCHW",
    "NDHWC", or "NCDHW". If not provided we assume the channel dimension is
    last.
* `offset`: Optional boolean to specify whether or not to apply a trained
    component-wise bias after the batch normalization and scaling.
* `scale`: Optional boolean to specify whether or not to apply a trained
    component-wise scale after the batch normalization.
* `decay_rate`: Decay rate of the exponential moving averages of the mean
    and variance.
* `eps`: Small number to avoid dividing by zero when diving by the standard
    deviation.
* `initializers`: Optional dict containing ops to initialize the weights of
    the affine transform (`gamma` and `beta`).
* `partitioners`: Optional dict containing partitioners to partition the
    weights of the affine transform (`gamma` and `beta`).
* `regularizers`: Optional dict containing regularizers for the weights of the
    affine transform ("gamma" and "beta"). As a default, no regularizers are
    used. A regularizer should be a function that takes a single `Tensor` as
    an input and returns a scalar `Tensor` output, e.g. the L1 and L2
    regularizers in `tf.contrib.layers`.
* `update_ops_collection`: Optional name of TensorFlow variable collection to
    add the moving average update ops to. If not provided, we instead add
    the update ops as control dependencies of the output of the module. This
    may result in some slowdown, as the feed-forward of the network is now
    blocked.
* `fused`: Use nn.fused_batch_norm if True, nn.batch_normalization otherwise.
* `name`: Name of the module.

##### Raises:


* `KeyError`: If `initializers` contains any keys other than `gamma`, `beta`,
    `moving_mean` or `moving_variance`.
* `KeyError`: If `partitioners` or `regularizers` contains any keys other
    than `gamma` or `beta`.
* `TypeError`: If any of the given initializers, partitioners or regularizers
    are not callable.
* `ValueError`: If `data_format` is invalid.


#### [`BatchNormV2.__call__(input_batch, is_training, test_local_stats=False)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/batch_norm_v2.py?l=507)<a id="BatchNormV2.__call__" />

Connects the BatchNormV2 module into the graph.

##### Args:


* `input_batch`: A Tensor of the same dimension as `len(data_format)`.
* `is_training`: A boolean to indicate if the module should be connected in
    training mode, meaning the moving averages are updated. Can be a Tensor.
* `test_local_stats`: A boolean to indicate if local batch statistics should
    be used when `is_training=False`. If not, moving averages are used.
    By default `False`. Can be a Tensor.

##### Returns:

  A tensor with the same shape as `input_batch`.

##### Raises:

  base.IncompatibleShapeError: If `data_format` is not valid for the
    input shape.
  base.NotSupportedError: If `input_batch` has data type of `tf.bfloat16`.


#### [`BatchNormV2.beta`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/batch_norm_v2.py?l=627)<a id="BatchNormV2.beta" />




#### [`BatchNormV2.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="BatchNormV2.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`BatchNormV2.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="BatchNormV2.defun" />

Wraps this modules call method in a callable graph function.


#### [`BatchNormV2.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="BatchNormV2.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`BatchNormV2.gamma`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/batch_norm_v2.py?l=637)<a id="BatchNormV2.gamma" />




#### [`BatchNormV2.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="BatchNormV2.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`BatchNormV2.get_possible_initializer_keys()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=505)<a id="BatchNormV2.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`BatchNormV2.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="BatchNormV2.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`BatchNormV2.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="BatchNormV2.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`BatchNormV2.initializers`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/batch_norm_v2.py?l=605)<a id="BatchNormV2.initializers" />




#### [`BatchNormV2.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="BatchNormV2.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`BatchNormV2.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="BatchNormV2.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`BatchNormV2.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="BatchNormV2.module_name" />

Returns the name of the Module.


#### [`BatchNormV2.moving_mean`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/batch_norm_v2.py?l=617)<a id="BatchNormV2.moving_mean" />




#### [`BatchNormV2.moving_variance`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/batch_norm_v2.py?l=622)<a id="BatchNormV2.moving_variance" />




#### [`BatchNormV2.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="BatchNormV2.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`BatchNormV2.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="BatchNormV2.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`BatchNormV2.partitioners`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/batch_norm_v2.py?l=609)<a id="BatchNormV2.partitioners" />




#### [`BatchNormV2.regularizers`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/batch_norm_v2.py?l=613)<a id="BatchNormV2.regularizers" />




#### [`BatchNormV2.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="BatchNormV2.scope_name" />

Returns the full name of the Module's variable scope.


#### [`BatchNormV2.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="BatchNormV2.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`BatchNormV2.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="BatchNormV2.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`BatchNormV2.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="BatchNormV2.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.



### [`class BatchReshape`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?q=class:BatchReshape)<a id="BatchReshape" />

Reshapes input Tensor, preserving the batch dimension.

#### [`BatchReshape.__init__(shape, preserve_dims=1, name='batch_reshape')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?l=750)<a id="BatchReshape.__init__" />

Constructs a BatchReshape module.

##### Args:


* `shape`: Shape to reshape the input Tensor to while preserving its
      first `preserve_dims` dimensions; `shape` can be either a tuple/list,
      or a callable that returns the actual shape. The callable does not
      need to be ready to return something meaningful at construction time,
      but it will be required to be able to do so when the module is
      connected to the graph. When the special value -1 appears in `shape`
      the corresponding size is automatically inferred. Note that -1 can
      only appear once in `shape`. To flatten all non-batch dimensions,
      the snt.BatchFlatten module can also be used.
* `preserve_dims`: Number of leading dimensions that will not be reshaped.
      For example, given an input Tensor with shape `[B, H, W, C, D]`,
      and argument `shape` equal to `(-1, D)`:
        * `preserve_dims=1` will return a Tensor with shape `[B, H*W*C, D]`.
        * `preserve_dims=2` will return a Tensor with
            shape `[B, H, W*C, D]`.
        * `preserve_dims=3` will return a Tensor with
            shape `[B, H, W, C, D]`.
        * `preserve_dims=4` will return a Tensor with
            shape `[B, H, W, C, 1, D]`.
        * `preserve_dims>=5` will throw an error on build unless D=1.
      The preserved dimensions can be unknown at building time.
* `name`: Name of the module.

##### Raises:


* `ValueError`: If `preserve_dims <= 0`.


#### [`BatchReshape.__call__(inputs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?l=810)<a id="BatchReshape.__call__" />

Connects the module into the graph, with input Tensor `inputs`.

##### Args:


* `inputs`: A Tensor of shape [b_1, b_2, ..., b_preserve_dims,
                             b_preserve_dims+1, ...].

##### Returns:

  A Tensor of shape [b_1, b_2, ..., b_preserve_dims,
                     b_reshape_1, b_reshape_2, ...],
    with reshaping defined by the constructor `shape` parameter.

##### Raises:


* `ValueError`: If output shape is incompatible with input shape; or if
      shape array contains non numeric entries; or if shape array contains
      more than 1 wildcard -1; or if the input array contains unknown,
      non-preserved dimensions (except when the unknown dimension is the
      only non-preserved dimension and doesn't actually need reshaping).


#### [`BatchReshape.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="BatchReshape.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`BatchReshape.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="BatchReshape.defun" />

Wraps this modules call method in a callable graph function.


#### [`BatchReshape.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="BatchReshape.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`BatchReshape.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="BatchReshape.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`BatchReshape.get_possible_initializer_keys()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=505)<a id="BatchReshape.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`BatchReshape.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="BatchReshape.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`BatchReshape.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="BatchReshape.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`BatchReshape.input_shape`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?l=893)<a id="BatchReshape.input_shape" />

Returns shape of input `Tensor` passed at last call to `build`.


#### [`BatchReshape.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="BatchReshape.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`BatchReshape.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="BatchReshape.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`BatchReshape.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="BatchReshape.module_name" />

Returns the name of the Module.


#### [`BatchReshape.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="BatchReshape.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`BatchReshape.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="BatchReshape.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`BatchReshape.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="BatchReshape.scope_name" />

Returns the full name of the Module's variable scope.


#### [`BatchReshape.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="BatchReshape.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`BatchReshape.transpose(name=None)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?l=899)<a id="BatchReshape.transpose" />

Returns transpose batch reshape.


#### [`BatchReshape.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="BatchReshape.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`BatchReshape.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="BatchReshape.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.



### [`class BidirectionalRNN`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic_rnn.py?q=class:BidirectionalRNN)<a id="BidirectionalRNN" />

Bidirectional RNNCore that processes the sequence forwards and backwards.

  Based upon the encoder implementation in: https://arxiv.org/abs/1409.0473

This interface of this module is different than the typical ones found in
the RNNCore family.  The primary difference is that it is pre-conditioned on
the full input sequence in order to produce a full sequence of outputs and
states concatenated along the feature dimension among the forward and
backward cores.

#### [`BidirectionalRNN.__init__(forward_core, backward_core, name='bidir_rnn')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic_rnn.py?l=561)<a id="BidirectionalRNN.__init__" />

Construct a Bidirectional RNN core.

##### Args:


* `forward_core`: callable RNNCore module that computes forward states.
* `backward_core`: callable RNNCore module that computes backward states.
* `name`: name of the module.

##### Raises:


* `ValueError`: if not all the modules are recurrent.


#### [`BidirectionalRNN.__call__(input_sequence, state)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic_rnn.py?l=584)<a id="BidirectionalRNN.__call__" />

Connects the BidirectionalRNN module into the graph.

##### Args:


* `input_sequence`: tensor (time, batch, [feature_1, ..]). It must be
      time_major.
* `state`: tuple of states for the forward and backward cores.

##### Returns:

  A dict with forward/backard states and output sequences:

    "outputs":{
        "forward": ...,
        "backward": ...},
    "state": {
        "forward": ...,
        "backward": ...}

##### Raises:


* `ValueError`: in case time dimension is not statically known.


#### [`BidirectionalRNN.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="BidirectionalRNN.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`BidirectionalRNN.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="BidirectionalRNN.defun" />

Wraps this modules call method in a callable graph function.


#### [`BidirectionalRNN.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="BidirectionalRNN.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`BidirectionalRNN.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="BidirectionalRNN.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`BidirectionalRNN.get_possible_initializer_keys()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=505)<a id="BidirectionalRNN.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`BidirectionalRNN.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="BidirectionalRNN.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`BidirectionalRNN.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="BidirectionalRNN.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`BidirectionalRNN.initial_state(batch_size, dtype=tf.float32, trainable=False, trainable_initializers=None, trainable_regularizers=None, name=None)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic_rnn.py?l=652)<a id="BidirectionalRNN.initial_state" />

Builds the default start state for a BidirectionalRNN.

The Bidirectional RNN flattens the states of its forward and backward cores
and concatentates them.

##### Args:


* `batch_size`: An int, float or scalar Tensor representing the batch size.
* `dtype`: The data type to use for the state.
* `trainable`: Boolean that indicates whether to learn the initial state.
* `trainable_initializers`: An initializer function or nested structure of
      functions with same structure as the `state_size` property of the
      core, to be used as initializers of the initial state variable.
* `trainable_regularizers`: Optional regularizer function or nested structure
    of functions with the same structure as the `state_size` property of the
    core, to be used as regularizers of the initial state variable. A
    regularizer should be a function that takes a single `Tensor` as an
    input and returns a scalar `Tensor` output, e.g. the L1 and L2
    regularizers in `tf.contrib.layers`.
* `name`: Optional string used to prefix the initial state variable names, in
      the case of a trainable initial state. If not provided, defaults to
      the name of the module.

##### Returns:

  Tuple of initial states from forward and backward RNNs.


#### [`BidirectionalRNN.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="BidirectionalRNN.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`BidirectionalRNN.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="BidirectionalRNN.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`BidirectionalRNN.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="BidirectionalRNN.module_name" />

Returns the name of the Module.


#### [`BidirectionalRNN.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="BidirectionalRNN.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`BidirectionalRNN.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="BidirectionalRNN.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`BidirectionalRNN.output_size`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic_rnn.py?l=694)<a id="BidirectionalRNN.output_size" />

Flattened output size of cores.


#### [`BidirectionalRNN.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="BidirectionalRNN.scope_name" />

Returns the full name of the Module's variable scope.


#### [`BidirectionalRNN.state_size`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic_rnn.py?l=689)<a id="BidirectionalRNN.state_size" />

Flattened state size of cores.


#### [`BidirectionalRNN.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="BidirectionalRNN.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`BidirectionalRNN.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="BidirectionalRNN.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`BidirectionalRNN.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="BidirectionalRNN.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.



### [`class CausalConv1D`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?q=class:CausalConv1D)<a id="CausalConv1D" />

1D convolution module, including optional bias.

This is deprecated, please use the padding=CAUSAL argument to Conv1D.

This acts as a light wrapper around _ConvND ensuring that the outputs at index
`i` only depend on indices smaller than `i` (also known as a causal
convolution). For further details on the theoretical background, refer to:

https://arxiv.org/abs/1610.10099

#### [`CausalConv1D.__init__(output_channels, kernel_shape, stride=1, rate=1, use_bias=True, initializers=None, partitioners=None, regularizers=None, mask=None, padding='CAUSAL', data_format='NWC', padding_value='CONSTANT', custom_getter=None, name='causal_conv_1d')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1606)<a id="CausalConv1D.__init__" />

Constructs a CausalConv1D module.

This is deprecated, please use the padding=CAUSAL argument to Conv1D.

##### Args:


* `output_channels`: Number of output channels. `output_channels` can be
      either a number or a callable. In the latter case, since the function
      invocation is deferred to graph construction time, the user must only
      ensure that output_channels can be called, returning an integer,
      when `build` is called.
* `kernel_shape`: Sequence of kernel sizes (of size 1), or integer that is
      used to define kernel size in all dimensions.
* `stride`: Sequence of kernel strides (of size 1), or integer that is used to
      define stride in all dimensions.
* `rate`: Sequence of dilation rates (of size 1), or integer that is used to
      define dilation rate in all dimensions. 1 corresponds to standard
      convolution, `rate > 1` corresponds to dilated convolution. Cannot be
      > 1 if any of `stride` is also > 1.
* `use_bias`: Whether to include bias parameters. Default `True`.
* `initializers`: Optional dict containing ops to initialize the filters (with
      key 'w') or biases (with key 'b'). The default initializer for the
      weights is a truncated normal initializer, which is commonly used
      when the inputs are zero centered (see
      https://arxiv.org/pdf/1502.03167v3.pdf). The default initializer for
      the bias is a zero initializer.
* `partitioners`: Optional dict containing partitioners to partition
      weights (with key 'w') or biases (with key 'b'). As a default, no
      partitioners are used.
* `regularizers`: Optional dict containing regularizers for the filters
      (with key 'w') and the biases (with key 'b'). As a default, no
      regularizers are used. A regularizer should be a function that takes
      a single `Tensor` as an input and returns a scalar `Tensor` output,
      e.g. the L1 and L2 regularizers in `tf.contrib.layers`.
* `mask`: A convertible to a 3D tensor which is multiplied
      component-wise with the weights (Optional).
* `padding`: Padding algorithm. Should be `snt.CAUSAL`.
* `data_format`: A string. Specifies whether the channel dimension
      of the input and output is the last dimension (default, NWC), or the
      second dimension (NCW).
* `padding_value`: The type of padding to use, either "CONSTANT", "SYMMETRIC"
      or "REFLECT", as supported by the underlying tf.pad
      (https://www.tensorflow.org/api_docs/python/tf/pad). Defaults to
      "CONSTANT" which will pad with zeros.
* `custom_getter`: Callable or dictionary of callables to use as
      custom getters inside the module. If a dictionary, the keys
      correspond to regexes to match variable names. See the
      `tf.get_variable` documentation for information about the
      custom_getter API.
* `name`: Name of the module.

##### Raises:

  base.IncompatibleShapeError: If the given kernel shape is not an integer;
      or if the given kernel shape is not a sequence of two integers.
  base.IncompatibleShapeError: If the given stride is not an integer; or if
      the given stride is not a sequence of two integers.
  base.IncompatibleShapeError: If the given rate is not an integer; or if
      the given rate is not a sequence of two integers.
  base.IncompatibleShapeError: If a mask is a TensorFlow Tensor with
      a not fully defined shape.
  base.NotSupportedError: If rate in any dimension and the stride in any
      dimension are simultaneously > 1.

* `KeyError`: If `initializers`, `partitioners` or `regularizers` contain any
      keys other than 'w' or 'b'.
* `TypeError`: If any of the given initializers, partitioners or regularizers
      are not callable.
* `TypeError`: If mask is given and it is not convertible to a Tensor.
* `ValueError`: If the passed-in data_format doesn't have a channel dimension.
* `ValueError`: If the given data_format is not a supported format (see
      `SUPPORTED_1D_DATA_FORMATS`).


#### [`CausalConv1D.__call__(inputs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=556)<a id="CausalConv1D.__call__" />

Connects the _ConvND module into the graph, with input Tensor `inputs`.

If this is not the first time the module has been connected to the graph,
the input Tensor provided here must have the same number of channels, in
order for the existing variables to be the correct size for the
multiplication; the batch size and input spatial dimensions may differ for
each connection.

##### Args:


* `inputs`: A ND Tensor of the same rank as `data_format`, and either of types
  `tf.float16`, `tf.bfloat16`, `tf.float32` or `tf.float64`.

##### Returns:

  A ND Tensor of shape [batch_size, output_dim_1, output_dim_2, ...,
      output_channels].

##### Raises:


* `ValueError`: If connecting the module into the graph any time after the
      first time and the inferred size of the input does not match previous
      invocations.
  base.IncompatibleShapeError: If the input tensor has the wrong number
      of dimensions.
  base.UnderspecifiedError: If the channel dimension of `inputs` isn't
      defined.
  base.IncompatibleShapeError: If a mask is present and its shape is
      incompatible with the shape of the weights.

* `TypeError`: If input Tensor dtype is not compatible with either
      `tf.float16`, `tf.bfloat16`, `tf.float32` or `tf.float64`.


#### [`CausalConv1D.b`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=814)<a id="CausalConv1D.b" />

Returns the Variable containing the bias.

##### Returns:

  Variable object containing the bias, from the most recent __call__.

##### Raises:

  base.NotConnectedError: If the module has not been connected to the graph
      yet, meaning the variables do not exist.

* `AttributeError`: If the module does not use bias.


#### [`CausalConv1D.clone(name=None)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=876)<a id="CausalConv1D.clone" />

Returns a cloned `_ConvND` module.

##### Args:


* `name`: Optional string assigning name of cloned module. The default name
    is constructed by appending "_clone" to `self.module_name`.

##### Returns:

  A copy of the current class.


#### [`CausalConv1D.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="CausalConv1D.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`CausalConv1D.conv_op_padding`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=803)<a id="CausalConv1D.conv_op_padding" />

Returns the padding algorithm used for the underlying convolution op.


#### [`CausalConv1D.data_format`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=857)<a id="CausalConv1D.data_format" />

Returns the data format.


#### [`CausalConv1D.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="CausalConv1D.defun" />

Wraps this modules call method in a callable graph function.


#### [`CausalConv1D.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="CausalConv1D.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`CausalConv1D.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="CausalConv1D.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`CausalConv1D.get_possible_initializer_keys(use_bias=True)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=552)<a id="CausalConv1D.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`CausalConv1D.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="CausalConv1D.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`CausalConv1D.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="CausalConv1D.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`CausalConv1D.has_bias`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=832)<a id="CausalConv1D.has_bias" />

Returns `True` if bias Variable is present in the module.


#### [`CausalConv1D.initializers`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=837)<a id="CausalConv1D.initializers" />

Returns the initializers dictionary.


#### [`CausalConv1D.input_channels`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=869)<a id="CausalConv1D.input_channels" />

Returns the number of input channels.


#### [`CausalConv1D.input_shape`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=863)<a id="CausalConv1D.input_shape" />

Returns the input shape.


#### [`CausalConv1D.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="CausalConv1D.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`CausalConv1D.kernel_shape`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=758)<a id="CausalConv1D.kernel_shape" />

Returns the kernel shape.


#### [`CausalConv1D.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="CausalConv1D.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`CausalConv1D.mask`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=852)<a id="CausalConv1D.mask" />

Returns the mask.


#### [`CausalConv1D.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="CausalConv1D.module_name" />

Returns the name of the Module.


#### [`CausalConv1D.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="CausalConv1D.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`CausalConv1D.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="CausalConv1D.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`CausalConv1D.output_channels`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=749)<a id="CausalConv1D.output_channels" />

Returns the number of output channels.


#### [`CausalConv1D.padding`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=775)<a id="CausalConv1D.padding" />

Returns the padding algorithm used, if this is the same for all dims.

Use `.paddings` if you want a tuple with the padding algorithm used for each
dimension.

##### Returns:

  The padding algorithm used, if this is the same for all dimensions.

##### Raises:


* `ValueError`: If different padding algorithms are used for different
    dimensions.


#### [`CausalConv1D.paddings`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=798)<a id="CausalConv1D.paddings" />

Returns a tuple with the padding algorithm used for each dimension.


#### [`CausalConv1D.partitioners`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=842)<a id="CausalConv1D.partitioners" />

Returns the partitioners dictionary.


#### [`CausalConv1D.rate`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=770)<a id="CausalConv1D.rate" />

Returns the dilation rate.


#### [`CausalConv1D.regularizers`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=847)<a id="CausalConv1D.regularizers" />

Returns the regularizers dictionary.


#### [`CausalConv1D.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="CausalConv1D.scope_name" />

Returns the full name of the Module's variable scope.


#### [`CausalConv1D.stride`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=763)<a id="CausalConv1D.stride" />

Returns the stride.


#### [`CausalConv1D.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="CausalConv1D.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`CausalConv1D.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="CausalConv1D.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`CausalConv1D.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="CausalConv1D.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`CausalConv1D.w`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=808)<a id="CausalConv1D.w" />

Returns the Variable containing the weight matrix.



### [`class ConcatLinear`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?q=class:ConcatLinear)<a id="ConcatLinear" />

Linear transformation of a number of concatenated inputs.

This class ensures that at initialisation, the relative importance of all
inputs are similar even if they have very different sizes. This assumes
that all inputs have roughly the same range of values.

For example, the following code also concatenates a list of inputs and applies
a linear transform:
```
inp = tf.concat(input_list, axis=-1)
return snt.Linear(output_size)(inp)
```
The issue with the above code is that if `input_list` is made of two Tensors
of very different shapes such as `[batch_size, 1]` and `[batch_size, 128]`,
then almost no signal will be received from the first Tensor. This class works
around this problem by using a weight matrix with relatively larger
coefficients for the first Tensor than for the second one.

#### [`ConcatLinear.__init__(output_size, use_bias=True, initializers=None, partitioners=None, regularizers=None, custom_getter=None, name='concat_linear')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?l=424)<a id="ConcatLinear.__init__" />

Constructs a ConcatLinear module.

##### Args:


* `output_size`: Output dimensionality. `output_size` can be either an integer
      or a callable. In the latter case, since the function invocation is
      deferred to graph construction time, the user must only ensure that
      output_size can be called, returning an integer, when build is called.
* `use_bias`: Whether to include bias parameters. Default `True`.
* `initializers`: Optional dict containing initializers to initialize the
      weights (with key 'w') or biases (with key 'b'). The default
      initializer for the weights is a truncated normal initializer, which
      is commonly used when the inputs are zero centered (see
      https://arxiv.org/pdf/1502.03167v3.pdf). The default initializer for
      the bias is a zero initializer.
* `partitioners`: Optional dict containing partitioners to partition
      weights (with key 'w') or biases (with key 'b'). As a default, no
      partitioners are used.
* `regularizers`: Optional dict containing regularizers for the weights
    (with key 'w') and the biases (with key 'b'). As a default, no
    regularizers are used. A regularizer should be a function that takes
    a single `Tensor` as an input and returns a scalar `Tensor` output, e.g.
    the L1 and L2 regularizers in `tf.contrib.layers`.
* `custom_getter`: Callable or dictionary of callables to use as
    custom getters inside the module. If a dictionary, the keys
    correspond to regexes to match variable names. See the `tf.get_variable`
    documentation for information about the custom_getter API.
* `name`: Name of the module.


#### [`ConcatLinear.__call__(inputs_list)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?l=467)<a id="ConcatLinear.__call__" />

Connects the module into the graph.

If this is not the first time the module has been connected to the graph,
the Tensors provided here must have the same final dimensions as when called
the first time, in order for the existing variables to be the correct size
for the multiplication. The batch size may differ for each connection.

##### Args:


* `inputs_list`: A list of 2D Tensors of rank 2, with leading batch dimension.

##### Returns:

  A 2D Tensor of size [batch_size, output_size].


#### [`ConcatLinear.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="ConcatLinear.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`ConcatLinear.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="ConcatLinear.defun" />

Wraps this modules call method in a callable graph function.


#### [`ConcatLinear.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="ConcatLinear.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`ConcatLinear.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="ConcatLinear.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`ConcatLinear.get_possible_initializer_keys()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=505)<a id="ConcatLinear.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`ConcatLinear.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="ConcatLinear.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`ConcatLinear.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="ConcatLinear.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`ConcatLinear.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="ConcatLinear.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`ConcatLinear.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="ConcatLinear.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`ConcatLinear.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="ConcatLinear.module_name" />

Returns the name of the Module.


#### [`ConcatLinear.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="ConcatLinear.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`ConcatLinear.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="ConcatLinear.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`ConcatLinear.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="ConcatLinear.scope_name" />

Returns the full name of the Module's variable scope.


#### [`ConcatLinear.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="ConcatLinear.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`ConcatLinear.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="ConcatLinear.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`ConcatLinear.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="ConcatLinear.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.



### [`class Conv1D`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?q=class:Conv1D)<a id="Conv1D" />

1D convolution module, including optional bias.

This acts as a light wrapper around the class `_ConvND`.

#### [`Conv1D.__init__(output_channels, kernel_shape, stride=1, rate=1, padding='SAME', use_bias=True, initializers=None, partitioners=None, regularizers=None, mask=None, data_format='NWC', padding_value='CONSTANT', custom_getter=None, name='conv_1d')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1327)<a id="Conv1D.__init__" />

Constructs a Conv1D module.

See the following documentation for an explanation of VALID versus SAME
padding modes:
https://www.tensorflow.org/api_docs/python/tf/nn/convolution

##### Args:


* `output_channels`: Number of output channels. `output_channels` can be
      either a number or a callable. In the latter case, since the function
      invocation is deferred to graph construction time, the user must only
      ensure that output_channels can be called, returning an integer,
      when `build` is called.
* `kernel_shape`: Sequence of kernel sizes (of size 1), or integer that is
      used to define kernel size in all dimensions.
* `stride`: Sequence of kernel strides (of size 1), or integer that is used to
      define stride in all dimensions.
* `rate`: Sequence of dilation rates (of size 1), or integer that is used to
      define dilation rate in all dimensions. 1 corresponds to standard
      convolution, `rate > 1` corresponds to dilated convolution. Cannot be
      > 1 if any of `stride` is also > 1.
* `padding`: Padding algorithm. Either `snt.SAME`, `snt.VALID`, `snt.FULL`,
      `snt.CAUSAL`, `snt.REVERSE_CAUSAL`, or a sequence of these paddings
      of length 1.
      * snt.SAME and snt.VALID are explained in the Tensorflow docs at
        https://www.tensorflow.org/api_docs/python/tf/nn/convolution.
      * snt.FULL pre- and post-pads with the maximum padding which does not
        result in a convolution over just padded elements.
      * snt.CAUSAL pre-pads to ensure that each output value only depends on
        input values at the same or preceding indices ("no dependence on the
        future").
      * snt.REVERSE_CAUSAL post-pads to ensure that each output value only
        depends on input values at the same or *greater* indices ("no
        dependence on the past").
      If you use the same padding for all dimensions, and it is one of SAME
      or VALID, then this is supported directly by the underlying
      convolution op. In all other cases, the input data will be padded
      using tf.pad before calling the convolution op.
* `use_bias`: Whether to include bias parameters. Default `True`.
* `initializers`: Optional dict containing ops to initialize the filters (with
      key 'w') or biases (with key 'b'). The default initializer for the
      weights is a truncated normal initializer, which is commonly used
      when the inputs are zero centered (see
      https://arxiv.org/pdf/1502.03167v3.pdf). The default initializer for
      the bias is a zero initializer.
* `partitioners`: Optional dict containing partitioners to partition
      weights (with key 'w') or biases (with key 'b'). As a default, no
      partitioners are used.
* `regularizers`: Optional dict containing regularizers for the filters
      (with key 'w') and the biases (with key 'b'). As a default, no
      regularizers are used. A regularizer should be a function that takes
      a single `Tensor` as an input and returns a scalar `Tensor` output,
      e.g. the L1 and L2 regularizers in `tf.contrib.layers`.
* `mask`: A convertible to a 3D tensor which is multiplied
      component-wise with the weights (Optional).
* `data_format`: A string. Specifies whether the channel dimension
      of the input and output is the last dimension (default, NWC), or the
      second dimension (NCW).
* `padding_value`: The type of padding to use, either "CONSTANT", "SYMMETRIC"
      or "REFLECT", as supported by the underlying tf.pad
      (https://www.tensorflow.org/api_docs/python/tf/pad). Defaults to
      "CONSTANT" which will pad with zeros, potentially directly via the
      underlying convolution op if the padding is SAME.
* `custom_getter`: Callable or dictionary of callables to use as
      custom getters inside the module. If a dictionary, the keys
      correspond to regexes to match variable names. See the
      `tf.get_variable` documentation for information about the
      custom_getter API.
* `name`: Name of the module.

##### Raises:

  base.IncompatibleShapeError: If the given kernel shape is not an integer;
      or if the given kernel shape is not a sequence of two integers.
  base.IncompatibleShapeError: If the given stride is not an integer; or if
      the given stride is not a sequence of two integers.
  base.IncompatibleShapeError: If the given rate is not an integer; or if
      the given rate is not a sequence of two integers.
  base.IncompatibleShapeError: If a mask is a TensorFlow Tensor with
      a not fully defined shape.
  base.NotSupportedError: If rate in any dimension and the stride in any
      dimension are simultaneously > 1.

* `ValueError`: If the given padding is not `snt.VALID` or `snt.SAME`.
* `KeyError`: If `initializers`, `partitioners` or `regularizers` contain any
      keys other than 'w' or 'b'.
* `TypeError`: If any of the given initializers, partitioners or regularizers
      are not callable.
* `TypeError`: If mask is given and it is not convertible to a Tensor.
* `ValueError`: If the passed-in data_format doesn't have a channel dimension.
* `ValueError`: If the given data_format is not a supported format (see
      `SUPPORTED_1D_DATA_FORMATS`).


#### [`Conv1D.__call__(inputs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=556)<a id="Conv1D.__call__" />

Connects the _ConvND module into the graph, with input Tensor `inputs`.

If this is not the first time the module has been connected to the graph,
the input Tensor provided here must have the same number of channels, in
order for the existing variables to be the correct size for the
multiplication; the batch size and input spatial dimensions may differ for
each connection.

##### Args:


* `inputs`: A ND Tensor of the same rank as `data_format`, and either of types
  `tf.float16`, `tf.bfloat16`, `tf.float32` or `tf.float64`.

##### Returns:

  A ND Tensor of shape [batch_size, output_dim_1, output_dim_2, ...,
      output_channels].

##### Raises:


* `ValueError`: If connecting the module into the graph any time after the
      first time and the inferred size of the input does not match previous
      invocations.
  base.IncompatibleShapeError: If the input tensor has the wrong number
      of dimensions.
  base.UnderspecifiedError: If the channel dimension of `inputs` isn't
      defined.
  base.IncompatibleShapeError: If a mask is present and its shape is
      incompatible with the shape of the weights.

* `TypeError`: If input Tensor dtype is not compatible with either
      `tf.float16`, `tf.bfloat16`, `tf.float32` or `tf.float64`.


#### [`Conv1D.b`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=814)<a id="Conv1D.b" />

Returns the Variable containing the bias.

##### Returns:

  Variable object containing the bias, from the most recent __call__.

##### Raises:

  base.NotConnectedError: If the module has not been connected to the graph
      yet, meaning the variables do not exist.

* `AttributeError`: If the module does not use bias.


#### [`Conv1D.clone(name=None)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=876)<a id="Conv1D.clone" />

Returns a cloned `_ConvND` module.

##### Args:


* `name`: Optional string assigning name of cloned module. The default name
    is constructed by appending "_clone" to `self.module_name`.

##### Returns:

  A copy of the current class.


#### [`Conv1D.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="Conv1D.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`Conv1D.conv_op_padding`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=803)<a id="Conv1D.conv_op_padding" />

Returns the padding algorithm used for the underlying convolution op.


#### [`Conv1D.data_format`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=857)<a id="Conv1D.data_format" />

Returns the data format.


#### [`Conv1D.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="Conv1D.defun" />

Wraps this modules call method in a callable graph function.


#### [`Conv1D.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="Conv1D.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`Conv1D.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="Conv1D.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv1D.get_possible_initializer_keys(use_bias=True)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=552)<a id="Conv1D.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`Conv1D.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="Conv1D.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv1D.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="Conv1D.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`Conv1D.has_bias`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=832)<a id="Conv1D.has_bias" />

Returns `True` if bias Variable is present in the module.


#### [`Conv1D.initializers`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=837)<a id="Conv1D.initializers" />

Returns the initializers dictionary.


#### [`Conv1D.input_channels`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=869)<a id="Conv1D.input_channels" />

Returns the number of input channels.


#### [`Conv1D.input_shape`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=863)<a id="Conv1D.input_shape" />

Returns the input shape.


#### [`Conv1D.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="Conv1D.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`Conv1D.kernel_shape`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=758)<a id="Conv1D.kernel_shape" />

Returns the kernel shape.


#### [`Conv1D.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="Conv1D.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv1D.mask`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=852)<a id="Conv1D.mask" />

Returns the mask.


#### [`Conv1D.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="Conv1D.module_name" />

Returns the name of the Module.


#### [`Conv1D.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="Conv1D.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`Conv1D.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="Conv1D.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv1D.output_channels`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=749)<a id="Conv1D.output_channels" />

Returns the number of output channels.


#### [`Conv1D.padding`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=775)<a id="Conv1D.padding" />

Returns the padding algorithm used, if this is the same for all dims.

Use `.paddings` if you want a tuple with the padding algorithm used for each
dimension.

##### Returns:

  The padding algorithm used, if this is the same for all dimensions.

##### Raises:


* `ValueError`: If different padding algorithms are used for different
    dimensions.


#### [`Conv1D.paddings`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=798)<a id="Conv1D.paddings" />

Returns a tuple with the padding algorithm used for each dimension.


#### [`Conv1D.partitioners`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=842)<a id="Conv1D.partitioners" />

Returns the partitioners dictionary.


#### [`Conv1D.rate`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=770)<a id="Conv1D.rate" />

Returns the dilation rate.


#### [`Conv1D.regularizers`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=847)<a id="Conv1D.regularizers" />

Returns the regularizers dictionary.


#### [`Conv1D.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="Conv1D.scope_name" />

Returns the full name of the Module's variable scope.


#### [`Conv1D.stride`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=763)<a id="Conv1D.stride" />

Returns the stride.


#### [`Conv1D.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="Conv1D.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv1D.transpose(name=None)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1433)<a id="Conv1D.transpose" />

Returns matching `Conv1DTranspose` module.

##### Args:


* `name`: Optional string assigning name of transpose module. The default name
      is constructed by appending "_transpose" to `self.name`.

##### Returns:

  `Conv1DTranspose` module.

##### Raises:

 base.NotSupportedError: If `rate` in any dimension > 1.


#### [`Conv1D.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="Conv1D.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv1D.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="Conv1D.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv1D.w`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=808)<a id="Conv1D.w" />

Returns the Variable containing the weight matrix.



### [`class Conv1DLSTM`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?q=class:Conv1DLSTM)<a id="Conv1DLSTM" />

1D convolutional LSTM.

#### [`Conv1DLSTM.__init__(name='conv_1d_lstm', **kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=1416)<a id="Conv1DLSTM.__init__" />

Construct Conv1DLSTM. See `snt.ConvLSTM` for more details.


#### [`Conv1DLSTM.__call__(inputs, state)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=1371)<a id="Conv1DLSTM.__call__" />

Add elements to the Graph, computing output Tensors from input Tensors.

Subclasses must implement this method, which will be wrapped in a Template.

##### Args:


* `*args`: Input Tensors.
* `**kwargs`: Additional Python flags controlling connection.

##### Returns:

  output Tensor(s).


#### [`Conv1DLSTM.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="Conv1DLSTM.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`Conv1DLSTM.convolutions`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=1354)<a id="Conv1DLSTM.convolutions" />




#### [`Conv1DLSTM.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="Conv1DLSTM.defun" />

Wraps this modules call method in a callable graph function.


#### [`Conv1DLSTM.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="Conv1DLSTM.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`Conv1DLSTM.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="Conv1DLSTM.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv1DLSTM.get_possible_initializer_keys(use_bias=True)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=1412)<a id="Conv1DLSTM.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`Conv1DLSTM.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="Conv1DLSTM.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv1DLSTM.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="Conv1DLSTM.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`Conv1DLSTM.initial_state(batch_size, dtype=tf.float32, trainable=False, trainable_initializers=None, trainable_regularizers=None, name=None, **unused_kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/rnn_core.py?l=204)<a id="Conv1DLSTM.initial_state" />

Builds the default start state for an RNNCore.

##### Args:


* `batch_size`: An int, or scalar int32 Tensor representing the batch size.
* `dtype`: The data type to use for the state.
* `trainable`: Boolean that indicates whether to learn the initial state.
    Note that intializers and regularizers will be ignored if
    `trainable=False`.
* `trainable_initializers`: An initializer function or nested structure of
      functions with same structure as the `state_size` property of the
      core, to be used as initializers of the initial state variable.
* `trainable_regularizers`: Optional regularizer function or nested structure
    of functions with the same structure as the `state_size` property of the
    core, to be used as regularizers of the initial state variable. As a
    default, no regularizers are used. A regularizer should be a function
    that takes a single `Tensor` as an input and returns a scalar `Tensor`
    output, e.g. the L1 and L2 regularizers in `tf.contrib.layers`.
* `name`: Optional string used to prefix the initial state variable names, in
      the case of a trainable initial state. If not provided, defaults to
      the name of the module.

##### Returns:

  A tensor or nested tuple of tensors with same structure and shape as the
  `state_size` property of the core.

##### Raises:


* `ValueError`: if the user passes initializers that are not functions.
* `ValueError`: if the user passes regularizers that are not functions.


#### [`Conv1DLSTM.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="Conv1DLSTM.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`Conv1DLSTM.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="Conv1DLSTM.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv1DLSTM.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="Conv1DLSTM.module_name" />

Returns the name of the Module.


#### [`Conv1DLSTM.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="Conv1DLSTM.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`Conv1DLSTM.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="Conv1DLSTM.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv1DLSTM.output_size`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=1365)<a id="Conv1DLSTM.output_size" />

`tf.TensorShape` indicating the size of the core output.


#### [`Conv1DLSTM.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="Conv1DLSTM.scope_name" />

Returns the full name of the Module's variable scope.


#### [`Conv1DLSTM.state_size`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=1358)<a id="Conv1DLSTM.state_size" />

Tuple of `tf.TensorShape`s indicating the size of state tensors.


#### [`Conv1DLSTM.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="Conv1DLSTM.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv1DLSTM.use_layer_norm`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=1403)<a id="Conv1DLSTM.use_layer_norm" />

Boolean indicating whether layer norm is enabled.


#### [`Conv1DLSTM.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="Conv1DLSTM.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv1DLSTM.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="Conv1DLSTM.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv1DLSTM.zero_state(batch_size, dtype)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/rnn_core.py?l=260)<a id="Conv1DLSTM.zero_state" />

Return zero-filled state tensor(s).

##### Args:


* `batch_size`: int, float, or unit Tensor representing the batch size.
* `dtype`: the data type to use for the state.

##### Returns:

  If `state_size` is an int or TensorShape, then the return value is a
  `N-D` tensor of shape `[batch_size x state_size]` filled with zeros.

  If `state_size` is a nested list or tuple, then the return value is
  a nested list or tuple (of the same structure) of `2-D` tensors with
  the shapes `[batch_size x s]` for each s in `state_size`.



### [`class Conv1DTranspose`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?q=class:Conv1DTranspose)<a id="Conv1DTranspose" />

1D transposed / reverse / up 1D convolution module, including bias.

This performs a 1D transpose convolution by lightly wrapping the TensorFlow op
`tf.nn.conv2d_transpose`, setting the size of the height dimension of the
image to 1.

#### [`Conv1DTranspose.__init__(output_channels, output_shape=None, kernel_shape=None, stride=1, padding='SAME', use_bias=True, initializers=None, partitioners=None, regularizers=None, data_format='NWC', custom_getter=None, name='conv_1d_transpose')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1485)<a id="Conv1DTranspose.__init__" />

Constructs a Conv1DTranspose module.

See the following documentation for an explanation of VALID versus SAME
padding modes:
https://www.tensorflow.org/api_docs/python/tf/nn/convolution

##### Args:


* `output_channels`: Number of output channels. Can be either a number or a
      callable. In the latter case, since the function invocation is
      deferred to graph construction time, the user must only ensure
      `output_channels` can be called, returning an integer, when build is
      called.
* `output_shape`: Output shape of transpose convolution. Can be either a
      number or a callable. In the latter case, since the function
      invocation is deferred to graph construction time, the user must only
      ensure that `output_shape` can be called, returning an iterable of
      format `(out_length)` when build is called. If a None
      value is given, a default shape is automatically calculated (see
      docstring of _default_transpose_size function for more details).
* `kernel_shape`: Sequence of kernel sizes (of size 1), or integer that is
      used to define kernel size in all dimensions.
* `stride`: Sequence of kernel strides (of size 1), or integer that is used to
      define stride in all dimensions.
* `padding`: Padding algorithm, either `snt.SAME` or `snt.VALID`.
* `use_bias`: Whether to include bias parameters. Default `True`.
* `initializers`: Optional dict containing ops to initialize the filters (with
      key 'w') or biases (with key 'b').
* `partitioners`: Optional dict containing partitioners to partition
      weights (with key 'w') or biases (with key 'b'). As a default, no
      partitioners are used.
* `regularizers`: Optional dict containing regularizers for the filters
      (with key 'w') and the biases (with key 'b'). As a default, no
      regularizers are used. A regularizer should be a function that takes
      a single `Tensor` as an input and returns a scalar `Tensor` output,
      e.g. the L1 and L2 regularizers in `tf.contrib.layers`.
* `data_format`: A string. Specifies whether the channel dimension
      of the input and output is the last dimension (default, NWC), or the
      second dimension (NCW).
* `custom_getter`: Callable or dictionary of callables to use as
      custom getters inside the module. If a dictionary, the keys
      correspond to regexes to match variable names. See the
      `tf.get_variable` documentation for information about the
      custom_getter API.
* `name`: Name of the module.

##### Raises:

  base.IncompatibleShapeError: If the given kernel shape is not an integer;
      or if the given kernel shape is not a sequence of two integers.
  base.IncompatibleShapeError: If the given stride is not an integer; or if
      the given stride is not a sequence of two or four integers.

* `ValueError`: If the given padding is not `snt.VALID` or `snt.SAME`.
* `ValueError`: If the given kernel_shape is `None`.
* `KeyError`: If `initializers`, `partitioners` or `regularizers` contain any
      keys other than 'w' or 'b'.
* `TypeError`: If any of the given initializers, partitioners or regularizers
      are not callable.
* `ValueError`: If the passed-in data_format doesn't have a channel dimension.
* `ValueError`: If the given data_format is not a supported format (see
      `SUPPORTED_1D_DATA_FORMATS`).


#### [`Conv1DTranspose.__call__(inputs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1031)<a id="Conv1DTranspose.__call__" />

Connects the _ConvNDTranspose module into the graph.

If this is not the first time the module has been connected to the graph,
the input Tensor provided here must have the same final N dimensions, in
order for the existing variables to be the correct size for the
multiplication. The batch size may differ for each connection.

##### Args:


* `inputs`: A Tensor of shape `data_format` and of type
      `tf.float16`, `tf.bfloat16`, `tf.float32` or `tf.float64`.

##### Returns:

  A Tensor of shape `data_format` and of type `tf.float16`, `tf.bfloat16`,
     `tf.float32` or `tf.float64`.

##### Raises:


* `ValueError`: If connecting the module into the graph any time after the
      first time and the inferred size of the input does not match previous
      invocations.
  base.IncompatibleShapeError: If the input tensor has the wrong number
      of dimensions.
  base.UnderspecifiedError: If the channel dimension of `inputs` isn't
      defined.
  base.IncompatibleShapeError: If `output_shape` is an iterable and is not
      in the format `(out_height, out_width)`.

* `TypeError`: If input Tensor dtype is not compatible with either
      `tf.float16`, `tf.bfloat16`, `tf.float32` or `tf.float64`.


#### [`Conv1DTranspose.b`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1270)<a id="Conv1DTranspose.b" />

Returns the Variable containing the bias.

##### Returns:

  Variable object containing the bias, from the most recent __call__.

##### Raises:

  base.NotConnectedError: If the module has not been connected to the graph
      yet, meaning the variables do not exist.

* `AttributeError`: If the module does not use bias.


#### [`Conv1DTranspose.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="Conv1DTranspose.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`Conv1DTranspose.conv_op_padding`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1259)<a id="Conv1DTranspose.conv_op_padding" />

Returns the padding algorithm used for the underlying convolution op.


#### [`Conv1DTranspose.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="Conv1DTranspose.defun" />

Wraps this modules call method in a callable graph function.


#### [`Conv1DTranspose.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="Conv1DTranspose.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`Conv1DTranspose.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="Conv1DTranspose.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv1DTranspose.get_possible_initializer_keys(use_bias=True)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1027)<a id="Conv1DTranspose.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`Conv1DTranspose.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="Conv1DTranspose.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv1DTranspose.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="Conv1DTranspose.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`Conv1DTranspose.has_bias`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1288)<a id="Conv1DTranspose.has_bias" />

Returns `True` if bias Variable is present in the module.


#### [`Conv1DTranspose.initializers`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1293)<a id="Conv1DTranspose.initializers" />

Returns the initializers dictionary.


#### [`Conv1DTranspose.input_channels`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1314)<a id="Conv1DTranspose.input_channels" />

Returns the number of input channels.


#### [`Conv1DTranspose.input_shape`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1308)<a id="Conv1DTranspose.input_shape" />

Returns the input shape.


#### [`Conv1DTranspose.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="Conv1DTranspose.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`Conv1DTranspose.kernel_shape`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1235)<a id="Conv1DTranspose.kernel_shape" />

Returns the kernel shape.


#### [`Conv1DTranspose.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="Conv1DTranspose.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv1DTranspose.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="Conv1DTranspose.module_name" />

Returns the name of the Module.


#### [`Conv1DTranspose.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="Conv1DTranspose.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`Conv1DTranspose.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="Conv1DTranspose.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv1DTranspose.output_channels`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1226)<a id="Conv1DTranspose.output_channels" />

Returns the number of output channels.


#### [`Conv1DTranspose.output_shape`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1245)<a id="Conv1DTranspose.output_shape" />

Returns the output shape.


#### [`Conv1DTranspose.padding`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1254)<a id="Conv1DTranspose.padding" />

Returns the padding algorithm.


#### [`Conv1DTranspose.partitioners`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1298)<a id="Conv1DTranspose.partitioners" />

Returns the partitioners dictionary.


#### [`Conv1DTranspose.regularizers`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1303)<a id="Conv1DTranspose.regularizers" />

Returns the regularizers dictionary.


#### [`Conv1DTranspose.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="Conv1DTranspose.scope_name" />

Returns the full name of the Module's variable scope.


#### [`Conv1DTranspose.stride`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1240)<a id="Conv1DTranspose.stride" />

Returns the stride.


#### [`Conv1DTranspose.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="Conv1DTranspose.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv1DTranspose.transpose(name=None)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1563)<a id="Conv1DTranspose.transpose" />

Returns matching `Conv1D` module.

##### Args:


* `name`: Optional string assigning name of transpose module. The default name
    is constructed by appending "_transpose" to `self.name`.

##### Returns:

  `Conv1D` module.


#### [`Conv1DTranspose.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="Conv1DTranspose.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv1DTranspose.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="Conv1DTranspose.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv1DTranspose.w`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1264)<a id="Conv1DTranspose.w" />

Returns the Variable containing the weight matrix.



### [`class Conv2D`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?q=class:Conv2D)<a id="Conv2D" />

Spatial convolution and dilated convolution module, including bias.

This acts as a light wrapper around the class `_ConvND`.

#### [`Conv2D.__init__(output_channels, kernel_shape, stride=1, rate=1, padding='SAME', use_bias=True, initializers=None, partitioners=None, regularizers=None, mask=None, data_format='NHWC', padding_value='CONSTANT', custom_getter=None, name='conv_2d')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1708)<a id="Conv2D.__init__" />

Constructs a Conv2D module.

See the following documentation for an explanation of VALID versus SAME
padding modes:
https://www.tensorflow.org/api_docs/python/tf/nn/convolution

##### Args:


* `output_channels`: Number of output channels. `output_channels` can be
      either a number or a callable. In the latter case, since the function
      invocation is deferred to graph construction time, the user must only
      ensure that output_channels can be called, returning an integer,
      when `build` is called.
* `kernel_shape`: Sequence of kernel sizes (of size 2), or integer that is
      used to define kernel size in all dimensions.
* `stride`: Sequence of kernel strides (of size 2), or integer that is used to
      define stride in all dimensions.
* `rate`: Sequence of dilation rates (of size 2), or integer that is used to
      define dilation rate in all dimensions. 1 corresponds to standard 2D
      convolution, `rate > 1` corresponds to dilated convolution. Cannot be
      > 1 if any of `stride` is also > 1.
* `padding`: Padding algorithm. Either `snt.SAME`, `snt.VALID`, `snt.FULL`,
      `snt.CAUSAL`, `snt.REVERSE_CAUSAL`, or a sequence of these paddings
      of length 2.
      * snt.SAME and snt.VALID are explained in the Tensorflow docs at
        https://www.tensorflow.org/api_docs/python/tf/nn/convolution.
      * snt.FULL pre- and post-pads with the maximum padding which does not
        result in a convolution over just padded elements.
      * snt.CAUSAL pre-pads to ensure that each output value only depends on
        input values at the same or preceding indices ("no dependence on the
        future").
      * snt.REVERSE_CAUSAL post-pads to ensure that each output value only
        depends on input values at the same or *greater* indices ("no
        dependence on the past").
      If you use the same padding for all dimensions, and it is one of SAME
      or VALID, then this is supported directly by the underlying
      convolution op. In all other cases, the input data will be padded
      using tf.pad before calling the convolution op.
* `use_bias`: Whether to include bias parameters. Default `True`.
* `initializers`: Optional dict containing ops to initialize the filters (with
      key 'w') or biases (with key 'b'). The default initializer for the
      weights is a truncated normal initializer, which is commonly used
      when the inputs are zero centered (see
      https://arxiv.org/pdf/1502.03167v3.pdf). The default initializer for
      the bias is a zero initializer.
* `partitioners`: Optional dict containing partitioners to partition
      weights (with key 'w') or biases (with key 'b'). As a default, no
      partitioners are used.
* `regularizers`: Optional dict containing regularizers for the filters
      (with key 'w') and the biases (with key 'b'). As a default, no
      regularizers are used. A regularizer should be a function that takes
      a single `Tensor` as an input and returns a scalar `Tensor` output,
      e.g. the L1 and L2 regularizers in `tf.contrib.layers`.
* `mask`: A convertible to a 4D tensor which is multiplied
      component-wise with the weights (Optional).
* `data_format`: A string. Specifies whether the channel dimension
      of the input and output is the last dimension (default, NHWC), or the
      second dimension (NCHW).
* `padding_value`: The type of padding to use, either "CONSTANT", "SYMMETRIC"
      or "REFLECT", as supported by the underlying tf.pad
      (https://www.tensorflow.org/api_docs/python/tf/pad). Can only be set
      globally for all dimensions. Defaults to "CONSTANT" which will pad
      with zeros, potentially directly via the underlying convolution op if
      the padding is SAME for all dimensions.
* `custom_getter`: Callable or dictionary of callables to use as
      custom getters inside the module. If a dictionary, the keys
      correspond to regexes to match variable names. See the
      `tf.get_variable` documentation for information about the
      custom_getter API.
* `name`: Name of the module.

##### Raises:

  base.IncompatibleShapeError: If the given kernel shape is not an integer;
      or if the given kernel shape is not a sequence of two integers.
  base.IncompatibleShapeError: If the given stride is not an integer; or if
      the given stride is not a sequence of two integers.
  base.IncompatibleShapeError: If the given rate is not an integer; or if
      the given rate is not a sequence of two integers.
  base.IncompatibleShapeError: If a mask is given and its rank is neither 2
      nor 4, or if it is a TensorFlow Tensor with a not fully defined shape.
  base.NotSupportedError: If rate in any dimension and the stride in any
      dimension are simultaneously > 1.

* `ValueError`: If the given padding is not `snt.VALID`, `snt.SAME`,
      `snt.FULL`, `snt.CAUSAL`, `snt.REVERSE_CAUSAL` or a sequence of these.
* `KeyError`: If `initializers`, `partitioners` or `regularizers` contain any
      keys other than 'w' or 'b'.
* `TypeError`: If any of the given initializers, partitioners or regularizers
      are not callable.
* `TypeError`: If mask is given and it is not convertible to a Tensor.
* `ValueError`: If the passed-in data_format doesn't have a channel dimension.
* `ValueError`: If the given data_format is not a supported format (see
    `SUPPORTED_2D_DATA_FORMATS`).


#### [`Conv2D.__call__(inputs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=556)<a id="Conv2D.__call__" />

Connects the _ConvND module into the graph, with input Tensor `inputs`.

If this is not the first time the module has been connected to the graph,
the input Tensor provided here must have the same number of channels, in
order for the existing variables to be the correct size for the
multiplication; the batch size and input spatial dimensions may differ for
each connection.

##### Args:


* `inputs`: A ND Tensor of the same rank as `data_format`, and either of types
  `tf.float16`, `tf.bfloat16`, `tf.float32` or `tf.float64`.

##### Returns:

  A ND Tensor of shape [batch_size, output_dim_1, output_dim_2, ...,
      output_channels].

##### Raises:


* `ValueError`: If connecting the module into the graph any time after the
      first time and the inferred size of the input does not match previous
      invocations.
  base.IncompatibleShapeError: If the input tensor has the wrong number
      of dimensions.
  base.UnderspecifiedError: If the channel dimension of `inputs` isn't
      defined.
  base.IncompatibleShapeError: If a mask is present and its shape is
      incompatible with the shape of the weights.

* `TypeError`: If input Tensor dtype is not compatible with either
      `tf.float16`, `tf.bfloat16`, `tf.float32` or `tf.float64`.


#### [`Conv2D.b`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=814)<a id="Conv2D.b" />

Returns the Variable containing the bias.

##### Returns:

  Variable object containing the bias, from the most recent __call__.

##### Raises:

  base.NotConnectedError: If the module has not been connected to the graph
      yet, meaning the variables do not exist.

* `AttributeError`: If the module does not use bias.


#### [`Conv2D.clone(name=None)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=876)<a id="Conv2D.clone" />

Returns a cloned `_ConvND` module.

##### Args:


* `name`: Optional string assigning name of cloned module. The default name
    is constructed by appending "_clone" to `self.module_name`.

##### Returns:

  A copy of the current class.


#### [`Conv2D.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="Conv2D.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`Conv2D.conv_op_padding`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=803)<a id="Conv2D.conv_op_padding" />

Returns the padding algorithm used for the underlying convolution op.


#### [`Conv2D.data_format`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=857)<a id="Conv2D.data_format" />

Returns the data format.


#### [`Conv2D.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="Conv2D.defun" />

Wraps this modules call method in a callable graph function.


#### [`Conv2D.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="Conv2D.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`Conv2D.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="Conv2D.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv2D.get_possible_initializer_keys(use_bias=True)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=552)<a id="Conv2D.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`Conv2D.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="Conv2D.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv2D.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="Conv2D.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`Conv2D.has_bias`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=832)<a id="Conv2D.has_bias" />

Returns `True` if bias Variable is present in the module.


#### [`Conv2D.initializers`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=837)<a id="Conv2D.initializers" />

Returns the initializers dictionary.


#### [`Conv2D.input_channels`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=869)<a id="Conv2D.input_channels" />

Returns the number of input channels.


#### [`Conv2D.input_shape`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=863)<a id="Conv2D.input_shape" />

Returns the input shape.


#### [`Conv2D.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="Conv2D.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`Conv2D.kernel_shape`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=758)<a id="Conv2D.kernel_shape" />

Returns the kernel shape.


#### [`Conv2D.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="Conv2D.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv2D.mask`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=852)<a id="Conv2D.mask" />

Returns the mask.


#### [`Conv2D.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="Conv2D.module_name" />

Returns the name of the Module.


#### [`Conv2D.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="Conv2D.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`Conv2D.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="Conv2D.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv2D.output_channels`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=749)<a id="Conv2D.output_channels" />

Returns the number of output channels.


#### [`Conv2D.padding`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=775)<a id="Conv2D.padding" />

Returns the padding algorithm used, if this is the same for all dims.

Use `.paddings` if you want a tuple with the padding algorithm used for each
dimension.

##### Returns:

  The padding algorithm used, if this is the same for all dimensions.

##### Raises:


* `ValueError`: If different padding algorithms are used for different
    dimensions.


#### [`Conv2D.paddings`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=798)<a id="Conv2D.paddings" />

Returns a tuple with the padding algorithm used for each dimension.


#### [`Conv2D.partitioners`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=842)<a id="Conv2D.partitioners" />

Returns the partitioners dictionary.


#### [`Conv2D.rate`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=770)<a id="Conv2D.rate" />

Returns the dilation rate.


#### [`Conv2D.regularizers`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=847)<a id="Conv2D.regularizers" />

Returns the regularizers dictionary.


#### [`Conv2D.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="Conv2D.scope_name" />

Returns the full name of the Module's variable scope.


#### [`Conv2D.stride`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=763)<a id="Conv2D.stride" />

Returns the stride.


#### [`Conv2D.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="Conv2D.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv2D.transpose(name=None)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1816)<a id="Conv2D.transpose" />

Returns matching `Conv2DTranspose` module.

##### Args:


* `name`: Optional string assigning name of transpose module. The default name
    is constructed by appending "_transpose" to `self.name`.

##### Returns:

  `Conv2DTranspose` module.

##### Raises:

 base.NotSupportedError: If `rate` in any dimension > 1.


#### [`Conv2D.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="Conv2D.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv2D.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="Conv2D.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv2D.w`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=808)<a id="Conv2D.w" />

Returns the Variable containing the weight matrix.



### [`class Conv2DLSTM`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?q=class:Conv2DLSTM)<a id="Conv2DLSTM" />

2D convolutional LSTM.

#### [`Conv2DLSTM.__init__(name='conv_2d_lstm', **kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=1430)<a id="Conv2DLSTM.__init__" />

Construct Conv2DLSTM. See `snt.ConvLSTM` for more details.


#### [`Conv2DLSTM.__call__(inputs, state)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=1371)<a id="Conv2DLSTM.__call__" />

Add elements to the Graph, computing output Tensors from input Tensors.

Subclasses must implement this method, which will be wrapped in a Template.

##### Args:


* `*args`: Input Tensors.
* `**kwargs`: Additional Python flags controlling connection.

##### Returns:

  output Tensor(s).


#### [`Conv2DLSTM.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="Conv2DLSTM.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`Conv2DLSTM.convolutions`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=1354)<a id="Conv2DLSTM.convolutions" />




#### [`Conv2DLSTM.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="Conv2DLSTM.defun" />

Wraps this modules call method in a callable graph function.


#### [`Conv2DLSTM.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="Conv2DLSTM.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`Conv2DLSTM.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="Conv2DLSTM.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv2DLSTM.get_possible_initializer_keys(use_bias=True)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=1426)<a id="Conv2DLSTM.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`Conv2DLSTM.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="Conv2DLSTM.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv2DLSTM.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="Conv2DLSTM.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`Conv2DLSTM.initial_state(batch_size, dtype=tf.float32, trainable=False, trainable_initializers=None, trainable_regularizers=None, name=None, **unused_kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/rnn_core.py?l=204)<a id="Conv2DLSTM.initial_state" />

Builds the default start state for an RNNCore.

##### Args:


* `batch_size`: An int, or scalar int32 Tensor representing the batch size.
* `dtype`: The data type to use for the state.
* `trainable`: Boolean that indicates whether to learn the initial state.
    Note that intializers and regularizers will be ignored if
    `trainable=False`.
* `trainable_initializers`: An initializer function or nested structure of
      functions with same structure as the `state_size` property of the
      core, to be used as initializers of the initial state variable.
* `trainable_regularizers`: Optional regularizer function or nested structure
    of functions with the same structure as the `state_size` property of the
    core, to be used as regularizers of the initial state variable. As a
    default, no regularizers are used. A regularizer should be a function
    that takes a single `Tensor` as an input and returns a scalar `Tensor`
    output, e.g. the L1 and L2 regularizers in `tf.contrib.layers`.
* `name`: Optional string used to prefix the initial state variable names, in
      the case of a trainable initial state. If not provided, defaults to
      the name of the module.

##### Returns:

  A tensor or nested tuple of tensors with same structure and shape as the
  `state_size` property of the core.

##### Raises:


* `ValueError`: if the user passes initializers that are not functions.
* `ValueError`: if the user passes regularizers that are not functions.


#### [`Conv2DLSTM.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="Conv2DLSTM.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`Conv2DLSTM.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="Conv2DLSTM.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv2DLSTM.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="Conv2DLSTM.module_name" />

Returns the name of the Module.


#### [`Conv2DLSTM.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="Conv2DLSTM.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`Conv2DLSTM.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="Conv2DLSTM.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv2DLSTM.output_size`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=1365)<a id="Conv2DLSTM.output_size" />

`tf.TensorShape` indicating the size of the core output.


#### [`Conv2DLSTM.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="Conv2DLSTM.scope_name" />

Returns the full name of the Module's variable scope.


#### [`Conv2DLSTM.state_size`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=1358)<a id="Conv2DLSTM.state_size" />

Tuple of `tf.TensorShape`s indicating the size of state tensors.


#### [`Conv2DLSTM.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="Conv2DLSTM.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv2DLSTM.use_layer_norm`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=1403)<a id="Conv2DLSTM.use_layer_norm" />

Boolean indicating whether layer norm is enabled.


#### [`Conv2DLSTM.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="Conv2DLSTM.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv2DLSTM.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="Conv2DLSTM.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv2DLSTM.zero_state(batch_size, dtype)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/rnn_core.py?l=260)<a id="Conv2DLSTM.zero_state" />

Return zero-filled state tensor(s).

##### Args:


* `batch_size`: int, float, or unit Tensor representing the batch size.
* `dtype`: the data type to use for the state.

##### Returns:

  If `state_size` is an int or TensorShape, then the return value is a
  `N-D` tensor of shape `[batch_size x state_size]` filled with zeros.

  If `state_size` is a nested list or tuple, then the return value is
  a nested list or tuple (of the same structure) of `2-D` tensors with
  the shapes `[batch_size x s]` for each s in `state_size`.



### [`class Conv2DTranspose`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?q=class:Conv2DTranspose)<a id="Conv2DTranspose" />

Spatial transposed / reverse / up 2D convolution module, including bias.

This acts as a light wrapper around the TensorFlow op `tf.nn.conv2d_transpose`
abstracting away variable creation and sharing.

#### [`Conv2DTranspose.__init__(output_channels, output_shape=None, kernel_shape=None, stride=1, padding='SAME', use_bias=True, initializers=None, partitioners=None, regularizers=None, data_format='NHWC', custom_getter=None, name='conv_2d_transpose')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1868)<a id="Conv2DTranspose.__init__" />

Constructs a `Conv2DTranspose module`.

See the following documentation for an explanation of VALID versus SAME
padding modes:
https://www.tensorflow.org/api_docs/python/tf/nn/convolution

##### Args:


* `output_channels`: Number of output channels.
      Can be either a number or a callable. In the latter case, since the
      function invocation is deferred to graph construction time, the user
      must only ensure `output_channels` can be called, returning an
      integer, when build is called.
* `output_shape`: Output shape of transpose convolution.
      Can be either an iterable of integers or a callable. In the latter
      case, since the function invocation is deferred to graph construction
      time, the user must only ensure that `output_shape` can be called,
      returning an iterable of format `(out_height, out_width)` when `build`
      is called. Note that `output_shape` defines the size of output signal
      domain, as opposed to the shape of the output `Tensor`. If a None
      value is given, a default shape is automatically calculated (see
      docstring of _default_transpose_size function for more details).
* `kernel_shape`: Sequence of kernel sizes (of size 2), or integer that is
      used to define kernel size in all dimensions.
* `stride`: Sequence of kernel strides (of size 2), or integer that is used to
      define stride in all dimensions.
* `padding`: Padding algorithm, either `snt.SAME` or `snt.VALID`.
* `use_bias`: Whether to include bias parameters. Default `True`.
* `initializers`: Optional dict containing ops to initialize the filters (with
      key 'w') or biases (with key 'b').
* `partitioners`: Optional dict containing partitioners to partition
      weights (with key 'w') or biases (with key 'b'). As a default, no
      partitioners are used.
* `regularizers`: Optional dict containing regularizers for the filters
      (with key 'w') and the biases (with key 'b'). As a default, no
      regularizers are used. A regularizer should be a function that takes
      a single `Tensor` as an input and returns a scalar `Tensor` output,
      e.g. the L1 and L2 regularizers in `tf.contrib.layers`.
* `data_format`: A string. Specifies whether the channel dimension
      of the input and output is the last dimension (default, NHWC), or the
      second dimension ("NCHW").
* `custom_getter`: Callable or dictionary of callables to use as
      custom getters inside the module. If a dictionary, the keys
      correspond to regexes to match variable names. See the`
      tf.get_variable` documentation for information about the
      custom_getter API.
* `name`: Name of the module.

##### Raises:

  base.IncompatibleShapeError: If the given kernel shape is neither an
      integer nor a sequence of two integers.
  base.IncompatibleShapeError: If the given stride is neither an integer nor
      a sequence of two or four integers.

* `ValueError`: If the given padding is not `snt.VALID` or `snt.SAME`.
* `ValueError`: If the given kernel_shape is `None`.
* `KeyError`: If `initializers`, `partitioners` or `regularizers` contain any
      keys other than 'w' or 'b'.
* `TypeError`: If any of the given initializers, partitioners or regularizers
      are not callable.
* `ValueError`: If the passed-in data_format doesn't have a channel dimension.
* `ValueError`: If the given data_format is not a supported format (see
      `SUPPORTED_2D_DATA_FORMATS`).


#### [`Conv2DTranspose.__call__(inputs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1031)<a id="Conv2DTranspose.__call__" />

Connects the _ConvNDTranspose module into the graph.

If this is not the first time the module has been connected to the graph,
the input Tensor provided here must have the same final N dimensions, in
order for the existing variables to be the correct size for the
multiplication. The batch size may differ for each connection.

##### Args:


* `inputs`: A Tensor of shape `data_format` and of type
      `tf.float16`, `tf.bfloat16`, `tf.float32` or `tf.float64`.

##### Returns:

  A Tensor of shape `data_format` and of type `tf.float16`, `tf.bfloat16`,
     `tf.float32` or `tf.float64`.

##### Raises:


* `ValueError`: If connecting the module into the graph any time after the
      first time and the inferred size of the input does not match previous
      invocations.
  base.IncompatibleShapeError: If the input tensor has the wrong number
      of dimensions.
  base.UnderspecifiedError: If the channel dimension of `inputs` isn't
      defined.
  base.IncompatibleShapeError: If `output_shape` is an iterable and is not
      in the format `(out_height, out_width)`.

* `TypeError`: If input Tensor dtype is not compatible with either
      `tf.float16`, `tf.bfloat16`, `tf.float32` or `tf.float64`.


#### [`Conv2DTranspose.b`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1270)<a id="Conv2DTranspose.b" />

Returns the Variable containing the bias.

##### Returns:

  Variable object containing the bias, from the most recent __call__.

##### Raises:

  base.NotConnectedError: If the module has not been connected to the graph
      yet, meaning the variables do not exist.

* `AttributeError`: If the module does not use bias.


#### [`Conv2DTranspose.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="Conv2DTranspose.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`Conv2DTranspose.conv_op_padding`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1259)<a id="Conv2DTranspose.conv_op_padding" />

Returns the padding algorithm used for the underlying convolution op.


#### [`Conv2DTranspose.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="Conv2DTranspose.defun" />

Wraps this modules call method in a callable graph function.


#### [`Conv2DTranspose.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="Conv2DTranspose.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`Conv2DTranspose.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="Conv2DTranspose.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv2DTranspose.get_possible_initializer_keys(use_bias=True)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1027)<a id="Conv2DTranspose.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`Conv2DTranspose.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="Conv2DTranspose.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv2DTranspose.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="Conv2DTranspose.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`Conv2DTranspose.has_bias`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1288)<a id="Conv2DTranspose.has_bias" />

Returns `True` if bias Variable is present in the module.


#### [`Conv2DTranspose.initializers`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1293)<a id="Conv2DTranspose.initializers" />

Returns the initializers dictionary.


#### [`Conv2DTranspose.input_channels`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1314)<a id="Conv2DTranspose.input_channels" />

Returns the number of input channels.


#### [`Conv2DTranspose.input_shape`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1308)<a id="Conv2DTranspose.input_shape" />

Returns the input shape.


#### [`Conv2DTranspose.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="Conv2DTranspose.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`Conv2DTranspose.kernel_shape`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1235)<a id="Conv2DTranspose.kernel_shape" />

Returns the kernel shape.


#### [`Conv2DTranspose.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="Conv2DTranspose.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv2DTranspose.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="Conv2DTranspose.module_name" />

Returns the name of the Module.


#### [`Conv2DTranspose.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="Conv2DTranspose.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`Conv2DTranspose.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="Conv2DTranspose.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv2DTranspose.output_channels`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1226)<a id="Conv2DTranspose.output_channels" />

Returns the number of output channels.


#### [`Conv2DTranspose.output_shape`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1245)<a id="Conv2DTranspose.output_shape" />

Returns the output shape.


#### [`Conv2DTranspose.padding`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1254)<a id="Conv2DTranspose.padding" />

Returns the padding algorithm.


#### [`Conv2DTranspose.partitioners`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1298)<a id="Conv2DTranspose.partitioners" />

Returns the partitioners dictionary.


#### [`Conv2DTranspose.regularizers`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1303)<a id="Conv2DTranspose.regularizers" />

Returns the regularizers dictionary.


#### [`Conv2DTranspose.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="Conv2DTranspose.scope_name" />

Returns the full name of the Module's variable scope.


#### [`Conv2DTranspose.stride`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1240)<a id="Conv2DTranspose.stride" />

Returns the stride.


#### [`Conv2DTranspose.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="Conv2DTranspose.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv2DTranspose.transpose(name=None)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1948)<a id="Conv2DTranspose.transpose" />

Returns matching `Conv2D` module.

##### Args:


* `name`: Optional string assigning name of transpose module. The default name
      is constructed by appending "_transpose" to `self.name`.

##### Returns:

  `Conv2D` module.


#### [`Conv2DTranspose.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="Conv2DTranspose.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv2DTranspose.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="Conv2DTranspose.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv2DTranspose.w`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1264)<a id="Conv2DTranspose.w" />

Returns the Variable containing the weight matrix.



### [`class Conv3D`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?q=class:Conv3D)<a id="Conv3D" />

Volumetric convolution module, including optional bias.

This acts as a light wrapper around the class `_ConvND`.

#### [`Conv3D.__init__(output_channels, kernel_shape, stride=1, rate=1, padding='SAME', use_bias=True, initializers=None, partitioners=None, regularizers=None, mask=None, data_format='NDHWC', padding_value='CONSTANT', custom_getter=None, name='conv_3d')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1985)<a id="Conv3D.__init__" />

Constructs a Conv3D module.

See the following documentation for an explanation of VALID versus SAME
padding modes:
https://www.tensorflow.org/api_docs/python/tf/nn/convolution

##### Args:


* `output_channels`: Number of output channels. `output_channels` can be
      either a number or a callable. In the latter case, since the function
      invocation is deferred to graph construction time, the user must only
      ensure that output_channels can be called, returning an integer,
      when `build` is called.
* `kernel_shape`: Sequence of kernel sizes (of size 3), or integer that is
      used to define kernel size in all dimensions.
* `stride`: Sequence of kernel strides (of size 3), or integer that is used to
      define stride in all dimensions.
* `rate`: Sequence of dilation rates (of size 3), or integer that is used to
      define dilation rate in all dimensions. 1 corresponds to standard 3D
      convolution, `rate > 1` corresponds to dilated convolution. Cannot be
      > 1 if any of `stride` is also > 1.
* `padding`: Padding algorithm. Either `snt.SAME`, `snt.VALID`, `snt.FULL`,
      `snt.CAUSAL`, `snt.REVERSE_CAUSAL`, or a sequence of these paddings
      of length 3.
      * snt.SAME and snt.VALID are explained in the Tensorflow docs at
        https://www.tensorflow.org/api_docs/python/tf/nn/convolution.
      * snt.FULL pre- and post-pads with the maximum padding which does not
        result in a convolution over just padded elements.
      * snt.CAUSAL pre-pads to ensure that each output value only depends on
        input values at the same or preceding indices ("no dependence on the
        future").
      * snt.REVERSE_CAUSAL post-pads to ensure that each output value only
        depends on input values at the same or *greater* indices ("no
        dependence on the past").
      If you use the same padding for all dimensions, and it is one of SAME
      or VALID, then this is supported directly by the underlying
      convolution op. In all other cases, the input data will be padded
      using tf.pad before calling the convolution op.
* `use_bias`: Whether to include bias parameters. Default `True`.
* `initializers`: Optional dict containing ops to initialize the filters (with
      key 'w') or biases (with key 'b'). The default initializer for the
      weights is a truncated normal initializer, which is commonly used
      when the inputs are zero centered (see
      https://arxiv.org/pdf/1502.03167v3.pdf). The default initializer for
      the bias is a zero initializer.
* `partitioners`: Optional dict containing partitioners to partition
      weights (with key 'w') or biases (with key 'b'). As a default, no
      partitioners are used.
* `regularizers`: Optional dict containing regularizers for the filters
      (with key 'w') and the biases (with key 'b'). As a default, no
      regularizers are used. A regularizer should be a function that takes
      a single `Tensor` as an input and returns a scalar `Tensor` output,
      e.g. the L1 and L2 regularizers in `tf.contrib.layers`.
* `mask`: An object convertible to a 5D tensor which is multiplied
      component-wise with the weights (Optional).
* `data_format`: A string. Specifies whether the channel dimension
      of the input and output is the last dimension (default, NDHWC), or
      the second dimension (NCDHW).
* `padding_value`: The type of padding to use, either "CONSTANT", "SYMMETRIC"
      or "REFLECT", as supported by the underlying tf.pad
      (https://www.tensorflow.org/api_docs/python/tf/pad). Can only be set
      globally for all dimensions. Defaults to "CONSTANT" which will pad
      with zeros, potentially directly via the underlying convolution op if
      the padding is SAME for all dimensions.
* `custom_getter`: Callable or dictionary of callables to use as
      custom getters inside the module. If a dictionary, the keys
      correspond to regexes to match variable names. See the
      `tf.get_variable` documentation for information about the
      custom_getter API.
* `name`: Name of the module.

##### Raises:

  base.IncompatibleShapeError: If the given kernel shape is not an integer;
      or if the given kernel shape is not a sequence of two integers.
  base.IncompatibleShapeError: If the given stride is not an integer; or if
      the given stride is not a sequence of two or four integers.
  base.IncompatibleShapeError: If the given rate is not an integer; or if
      the given rate is not a sequence of two integers.
  base.NotSupportedError: If rate in any dimension and the stride in any
      dimension are simultaneously > 1.

* `ValueError`: If the given padding is not `snt.VALID`, `snt.SAME`,
      `snt.FULL`, `snt.CAUSAL`, `snt.REVERSE_CAUSAL` or a sequence of these.
* `KeyError`: If `initializers`, `partitioners` or `regularizers` contain any
      keys other than 'w' or 'b'.
* `TypeError`: If any of the given initializers, partitioners or regularizers
      are not callable.
* `ValueError`: If the passed-in data_format doesn't have a channel dimension.
* `ValueError`: If the given data_format is not a supported format (see
      `SUPPORTED_3D_DATA_FORMATS`).


#### [`Conv3D.__call__(inputs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=556)<a id="Conv3D.__call__" />

Connects the _ConvND module into the graph, with input Tensor `inputs`.

If this is not the first time the module has been connected to the graph,
the input Tensor provided here must have the same number of channels, in
order for the existing variables to be the correct size for the
multiplication; the batch size and input spatial dimensions may differ for
each connection.

##### Args:


* `inputs`: A ND Tensor of the same rank as `data_format`, and either of types
  `tf.float16`, `tf.bfloat16`, `tf.float32` or `tf.float64`.

##### Returns:

  A ND Tensor of shape [batch_size, output_dim_1, output_dim_2, ...,
      output_channels].

##### Raises:


* `ValueError`: If connecting the module into the graph any time after the
      first time and the inferred size of the input does not match previous
      invocations.
  base.IncompatibleShapeError: If the input tensor has the wrong number
      of dimensions.
  base.UnderspecifiedError: If the channel dimension of `inputs` isn't
      defined.
  base.IncompatibleShapeError: If a mask is present and its shape is
      incompatible with the shape of the weights.

* `TypeError`: If input Tensor dtype is not compatible with either
      `tf.float16`, `tf.bfloat16`, `tf.float32` or `tf.float64`.


#### [`Conv3D.b`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=814)<a id="Conv3D.b" />

Returns the Variable containing the bias.

##### Returns:

  Variable object containing the bias, from the most recent __call__.

##### Raises:

  base.NotConnectedError: If the module has not been connected to the graph
      yet, meaning the variables do not exist.

* `AttributeError`: If the module does not use bias.


#### [`Conv3D.clone(name=None)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=876)<a id="Conv3D.clone" />

Returns a cloned `_ConvND` module.

##### Args:


* `name`: Optional string assigning name of cloned module. The default name
    is constructed by appending "_clone" to `self.module_name`.

##### Returns:

  A copy of the current class.


#### [`Conv3D.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="Conv3D.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`Conv3D.conv_op_padding`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=803)<a id="Conv3D.conv_op_padding" />

Returns the padding algorithm used for the underlying convolution op.


#### [`Conv3D.data_format`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=857)<a id="Conv3D.data_format" />

Returns the data format.


#### [`Conv3D.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="Conv3D.defun" />

Wraps this modules call method in a callable graph function.


#### [`Conv3D.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="Conv3D.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`Conv3D.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="Conv3D.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv3D.get_possible_initializer_keys(use_bias=True)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=552)<a id="Conv3D.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`Conv3D.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="Conv3D.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv3D.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="Conv3D.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`Conv3D.has_bias`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=832)<a id="Conv3D.has_bias" />

Returns `True` if bias Variable is present in the module.


#### [`Conv3D.initializers`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=837)<a id="Conv3D.initializers" />

Returns the initializers dictionary.


#### [`Conv3D.input_channels`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=869)<a id="Conv3D.input_channels" />

Returns the number of input channels.


#### [`Conv3D.input_shape`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=863)<a id="Conv3D.input_shape" />

Returns the input shape.


#### [`Conv3D.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="Conv3D.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`Conv3D.kernel_shape`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=758)<a id="Conv3D.kernel_shape" />

Returns the kernel shape.


#### [`Conv3D.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="Conv3D.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv3D.mask`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=852)<a id="Conv3D.mask" />

Returns the mask.


#### [`Conv3D.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="Conv3D.module_name" />

Returns the name of the Module.


#### [`Conv3D.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="Conv3D.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`Conv3D.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="Conv3D.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv3D.output_channels`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=749)<a id="Conv3D.output_channels" />

Returns the number of output channels.


#### [`Conv3D.padding`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=775)<a id="Conv3D.padding" />

Returns the padding algorithm used, if this is the same for all dims.

Use `.paddings` if you want a tuple with the padding algorithm used for each
dimension.

##### Returns:

  The padding algorithm used, if this is the same for all dimensions.

##### Raises:


* `ValueError`: If different padding algorithms are used for different
    dimensions.


#### [`Conv3D.paddings`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=798)<a id="Conv3D.paddings" />

Returns a tuple with the padding algorithm used for each dimension.


#### [`Conv3D.partitioners`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=842)<a id="Conv3D.partitioners" />

Returns the partitioners dictionary.


#### [`Conv3D.rate`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=770)<a id="Conv3D.rate" />

Returns the dilation rate.


#### [`Conv3D.regularizers`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=847)<a id="Conv3D.regularizers" />

Returns the regularizers dictionary.


#### [`Conv3D.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="Conv3D.scope_name" />

Returns the full name of the Module's variable scope.


#### [`Conv3D.stride`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=763)<a id="Conv3D.stride" />

Returns the stride.


#### [`Conv3D.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="Conv3D.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv3D.transpose(name=None)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=2090)<a id="Conv3D.transpose" />

Returns matching `Conv3DTranspose` module.

##### Args:


* `name`: Optional string assigning name of transpose module. The default name
    is constructed by appending "_transpose" to `self.name`.

##### Returns:

  `Conv3DTranspose` module.

##### Raises:

 base.NotSupportedError: If `rate` in any dimension > 1.


#### [`Conv3D.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="Conv3D.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv3D.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="Conv3D.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv3D.w`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=808)<a id="Conv3D.w" />

Returns the Variable containing the weight matrix.



### [`class Conv3DTranspose`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?q=class:Conv3DTranspose)<a id="Conv3DTranspose" />

Volumetric transposed / reverse / up 3D convolution module, including bias.

This acts as a light wrapper around the TensorFlow op `tf.nn.conv3d_transpose`
abstracting away variable creation and sharing.

#### [`Conv3DTranspose.__init__(output_channels, output_shape=None, kernel_shape=None, stride=1, padding='SAME', use_bias=True, initializers=None, partitioners=None, regularizers=None, data_format='NDHWC', custom_getter=None, name='conv_3d_transpose')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=2141)<a id="Conv3DTranspose.__init__" />

Constructs a `Conv3DTranspose` module.

See the following documentation for an explanation of VALID versus SAME
padding modes:
https://www.tensorflow.org/api_docs/python/tf/nn/convolution

##### Args:


* `output_channels`: Number of output channels. `output_channels` can be
      either a number or a callable. In the latter case, since the function
      invocation is deferred to graph construction time, the user must only
      ensure `output_channels` can be called, returning an integer, when
      `build` is called.
* `output_shape`: Output shape of transpose convolution.
      Can be either an iterable of integers or a callable. In the latter
      case, since the function invocation is deferred to graph construction
      time, the user must only ensure that `output_shape` can be called,
      returning an iterable of format `(out_depth, out_height, out_width)`
      when `build` is called. Note that `output_shape` defines the size of
      output signal domain, as opposed to the shape of the output `Tensor`.
      If a None value is given, a default shape is automatically calculated
      (see docstring of _default_transpose_size function for more details).
* `kernel_shape`: Sequence of kernel sizes (of size 3), or integer that is
      used to define kernel size in all dimensions.
* `stride`: Sequence of kernel strides (of size 3), or integer that is used to
      define stride in all dimensions.
* `padding`: Padding algorithm, either `snt.SAME` or `snt.VALID`.
* `use_bias`: Whether to include bias parameters. Default `True`.
* `initializers`: Optional dict containing ops to initialize the filters (with
      key 'w') or biases (with key 'b').
* `partitioners`: Optional dict containing partitioners to partition
      weights (with key 'w') or biases (with key 'b'). As a default, no
      partitioners are used.
* `regularizers`: Optional dict containing regularizers for the filters
      (with key 'w') and the biases (with key 'b'). As a default, no
      regularizers are used. A regularizer should be a function that takes
      a single `Tensor` as an input and returns a scalar `Tensor` output,
      e.g. the L1 and L2 regularizers in `tf.contrib.layers`.
* `data_format`: A string. Specifies whether the channel dimension
      of the input and output is the last dimension (default, NDHWC), or the
      second dimension (NCDHW).
* `custom_getter`: Callable or dictionary of callables to use as
      custom getters inside the module. If a dictionary, the keys
      correspond to regexes to match variable names. See the
      `tf.get_variable` documentation for information about the
      custom_getter API.
* `name`: Name of the module.

##### Raises:

  module.IncompatibleShapeError: If the given kernel shape is neither an
      integer nor a sequence of three integers.
  module.IncompatibleShapeError: If the given stride is neither an integer
      nor a sequence of three or five integers.

* `ValueError`: If the given padding is not `snt.VALID` or `snt.SAME`.
* `ValueError`: If the given kernel_shape is `None`.
* `KeyError`: If `initializers`, `partitioners` or `regularizers` contain any
      keys other than 'w' or 'b'.
* `TypeError`: If any of the given initializers, partitioners or regularizers
      are not callable.
* `ValueError`: If the passed-in data_format doesn't have a channel dimension.
* `ValueError`: If the given data_format is not a supported format (see
      `SUPPORTED_3D_DATA_FORMATS`).


#### [`Conv3DTranspose.__call__(inputs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1031)<a id="Conv3DTranspose.__call__" />

Connects the _ConvNDTranspose module into the graph.

If this is not the first time the module has been connected to the graph,
the input Tensor provided here must have the same final N dimensions, in
order for the existing variables to be the correct size for the
multiplication. The batch size may differ for each connection.

##### Args:


* `inputs`: A Tensor of shape `data_format` and of type
      `tf.float16`, `tf.bfloat16`, `tf.float32` or `tf.float64`.

##### Returns:

  A Tensor of shape `data_format` and of type `tf.float16`, `tf.bfloat16`,
     `tf.float32` or `tf.float64`.

##### Raises:


* `ValueError`: If connecting the module into the graph any time after the
      first time and the inferred size of the input does not match previous
      invocations.
  base.IncompatibleShapeError: If the input tensor has the wrong number
      of dimensions.
  base.UnderspecifiedError: If the channel dimension of `inputs` isn't
      defined.
  base.IncompatibleShapeError: If `output_shape` is an iterable and is not
      in the format `(out_height, out_width)`.

* `TypeError`: If input Tensor dtype is not compatible with either
      `tf.float16`, `tf.bfloat16`, `tf.float32` or `tf.float64`.


#### [`Conv3DTranspose.b`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1270)<a id="Conv3DTranspose.b" />

Returns the Variable containing the bias.

##### Returns:

  Variable object containing the bias, from the most recent __call__.

##### Raises:

  base.NotConnectedError: If the module has not been connected to the graph
      yet, meaning the variables do not exist.

* `AttributeError`: If the module does not use bias.


#### [`Conv3DTranspose.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="Conv3DTranspose.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`Conv3DTranspose.conv_op_padding`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1259)<a id="Conv3DTranspose.conv_op_padding" />

Returns the padding algorithm used for the underlying convolution op.


#### [`Conv3DTranspose.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="Conv3DTranspose.defun" />

Wraps this modules call method in a callable graph function.


#### [`Conv3DTranspose.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="Conv3DTranspose.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`Conv3DTranspose.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="Conv3DTranspose.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv3DTranspose.get_possible_initializer_keys(use_bias=True)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1027)<a id="Conv3DTranspose.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`Conv3DTranspose.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="Conv3DTranspose.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv3DTranspose.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="Conv3DTranspose.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`Conv3DTranspose.has_bias`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1288)<a id="Conv3DTranspose.has_bias" />

Returns `True` if bias Variable is present in the module.


#### [`Conv3DTranspose.initializers`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1293)<a id="Conv3DTranspose.initializers" />

Returns the initializers dictionary.


#### [`Conv3DTranspose.input_channels`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1314)<a id="Conv3DTranspose.input_channels" />

Returns the number of input channels.


#### [`Conv3DTranspose.input_shape`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1308)<a id="Conv3DTranspose.input_shape" />

Returns the input shape.


#### [`Conv3DTranspose.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="Conv3DTranspose.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`Conv3DTranspose.kernel_shape`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1235)<a id="Conv3DTranspose.kernel_shape" />

Returns the kernel shape.


#### [`Conv3DTranspose.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="Conv3DTranspose.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv3DTranspose.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="Conv3DTranspose.module_name" />

Returns the name of the Module.


#### [`Conv3DTranspose.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="Conv3DTranspose.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`Conv3DTranspose.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="Conv3DTranspose.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv3DTranspose.output_channels`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1226)<a id="Conv3DTranspose.output_channels" />

Returns the number of output channels.


#### [`Conv3DTranspose.output_shape`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1245)<a id="Conv3DTranspose.output_shape" />

Returns the output shape.


#### [`Conv3DTranspose.padding`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1254)<a id="Conv3DTranspose.padding" />

Returns the padding algorithm.


#### [`Conv3DTranspose.partitioners`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1298)<a id="Conv3DTranspose.partitioners" />

Returns the partitioners dictionary.


#### [`Conv3DTranspose.regularizers`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1303)<a id="Conv3DTranspose.regularizers" />

Returns the regularizers dictionary.


#### [`Conv3DTranspose.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="Conv3DTranspose.scope_name" />

Returns the full name of the Module's variable scope.


#### [`Conv3DTranspose.stride`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1240)<a id="Conv3DTranspose.stride" />

Returns the stride.


#### [`Conv3DTranspose.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="Conv3DTranspose.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv3DTranspose.transpose(name=None)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=2221)<a id="Conv3DTranspose.transpose" />

Returns transposed Conv3DTranspose module, i.e. a Conv3D module.


#### [`Conv3DTranspose.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="Conv3DTranspose.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv3DTranspose.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="Conv3DTranspose.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Conv3DTranspose.w`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=1264)<a id="Conv3DTranspose.w" />

Returns the Variable containing the weight matrix.



### [`class DeepRNN`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic_rnn.py?q=class:DeepRNN)<a id="DeepRNN" />

RNN core that passes data through a number of internal modules or ops.

This module is constructed by passing an iterable of externally constructed
modules or ops. The DeepRNN takes `(input, prev_state)` as input and passes
the input through each internal module in the order they were presented,
using elements from `prev_state` as necessary for internal recurrent cores.
The output is `(output, next_state)` in common with other RNN cores.
By default, skip connections from the input to all internal modules and from
each intermediate output to the final output are used.

E.g.:

```python
lstm1 = snt.LSTM(hidden_size=256)
lstm2 = snt.LSTM(hidden_size=256)
deep_rnn = snt.DeepRNN([lstm1, lstm2])
output, next_state = deep_rnn(input, prev_state)
```

The computation set up inside the DeepRNN has the same effect as:

```python
prev_state1, prev_state2 = prev_state
lstm1_output, next_state1 = lstm1(input, prev_state1)
lstm2_output, next_state2 = lstm2(
    tf.concat([input, lstm1_output], 1), prev_state2)

next_state = (next_state1, next_state2)
output = tf.concat([lstm1_output, lstm2_output], 1)
```

Every internal module receives the preceding module's output and the entire
core's input. The output is created by concatenating each internal module's
output. In the case of internal recurrent elements, corresponding elements
of the state are used such that `state[i]` is passed to the `i`'th internal
recurrent element. Note that the state of a `DeepRNN` is always a tuple, which
will contain the same number of elements as there are internal recurrent
cores. If no internal modules are recurrent, the state of the DeepRNN as a
whole is the empty tuple. Wrapping non-recurrent modules into a DeepRNN can
be useful to produce something API compatible with a "real" recurrent module,
simplifying code that handles the cores.

Without skip connections the previous example would become the following
(note the only difference is the addition of `skip_connections=False`):

```python
# ... declare other modules as above
deep_rnn = snt.DeepRNN([lin, tanh, lstm], skip_connections=False)
output, next_state = deep_rnn(input, prev_state)
```

which is equivalent to:

```python
lin_output = lin(input)
tanh_output = tanh(lin_output)
lstm_output, lstm_next_state = lstm(tanh_output, prev_state[0])

next_state = (lstm_next_state,)
output = lstm_output
```

Note: when using skip connections, all the cores should be recurrent.

#### [`DeepRNN.__init__(cores, skip_connections=True, concat_final_output_if_skip=True, name='deep_rnn')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic_rnn.py?l=247)<a id="DeepRNN.__init__" />

Construct a Deep RNN core.

##### Args:


* `cores`: iterable of modules or ops.
* `skip_connections`: a boolean that indicates whether to use skip
    connections. This means that the input is fed to all the layers, after
    being concatenated on the last dimension with the output of the previous
    layer. The output of the module will be the concatenation of all the
    outputs of the internal modules.
* `concat_final_output_if_skip`: A boolean that indicates whether the outputs
    of intermediate layers should be concatenated into the timestep-wise
    output of the core. By default this is True. If this is set to False,
    then the core output is that of the final layer, i.e. that of
    `cores[-1]`.
* `name`: name of the module.

##### Raises:


* `ValueError`: if `cores` is not an iterable, or if `skip_connections` is
      True and not all the modules are recurrent.


#### [`DeepRNN.__call__(inputs, prev_state, **kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic_rnn.py?l=312)<a id="DeepRNN.__call__" />

Connects the DeepRNN module into the graph.

If this is not the first time the module has been connected to the graph,
the Tensors provided as input_ and state must have the same final
dimension, in order for the existing variables to be the correct size for
their corresponding multiplications. The batch size may differ for each
connection.

##### Args:


* `inputs`: a nested tuple of Tensors of arbitrary dimensionality, with at
    least an initial batch dimension.
* `prev_state`: a tuple of `prev_state`s that corresponds to the state
    of each one of the cores of the `DeepCore`.
* `**kwargs`: optional kwargs to be passed to the `_build` of all sub-modules.
    E.g. is_training=True. Note all sub-modules must accept the given kwarg.

##### Returns:


* `output`: a nested tuple of Tensors of arbitrary dimensionality, with at
    least an initial batch dimension.
* `next_state`: a tuple of `next_state`s that corresponds to the updated state
    of each one of the cores of the `DeepCore`.

##### Raises:


* `ValueError`: if connecting the module into the graph any time after the
    first time, and the inferred size of the inputs does not match previous
    invocations. This may happen if one connects a module any time after the
    first time that does not have the configuration of skip connections as
    the first time.


#### [`DeepRNN.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="DeepRNN.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`DeepRNN.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="DeepRNN.defun" />

Wraps this modules call method in a callable graph function.


#### [`DeepRNN.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="DeepRNN.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`DeepRNN.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="DeepRNN.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`DeepRNN.get_possible_initializer_keys()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=505)<a id="DeepRNN.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`DeepRNN.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="DeepRNN.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`DeepRNN.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="DeepRNN.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`DeepRNN.initial_state(batch_size, dtype=tf.float32, trainable=False, trainable_initializers=None, trainable_regularizers=None, name=None)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic_rnn.py?l=373)<a id="DeepRNN.initial_state" />

Builds the default start state for a DeepRNN.

##### Args:


* `batch_size`: An int, float or scalar Tensor representing the batch size.
* `dtype`: The data type to use for the state.
* `trainable`: Boolean that indicates whether to learn the initial state.
* `trainable_initializers`: An initializer function or nested structure of
      functions with same structure as the `state_size` property of the
      core, to be used as initializers of the initial state variable.
* `trainable_regularizers`: Optional regularizer function or nested structure
    of functions with the same structure as the `state_size` property of the
    core, to be used as regularizers of the initial state variable. A
    regularizer should be a function that takes a single `Tensor` as an
    input and returns a scalar `Tensor` output, e.g. the L1 and L2
    regularizers in `tf.contrib.layers`.
* `name`: Optional string used to prefix the initial state variable names, in
      the case of a trainable initial state. If not provided, defaults to
      the name of the module.

##### Returns:

  A tensor or nested tuple of tensors with same structure and shape as the
  `state_size` property of the core.

##### Raises:


* `ValueError`: if the number of passed initializers is not the same as the
      number of recurrent cores.


#### [`DeepRNN.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="DeepRNN.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`DeepRNN.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="DeepRNN.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`DeepRNN.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="DeepRNN.module_name" />

Returns the name of the Module.


#### [`DeepRNN.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="DeepRNN.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`DeepRNN.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="DeepRNN.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`DeepRNN.output_size`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic_rnn.py?l=437)<a id="DeepRNN.output_size" />

Integer or TensorShape: size of outputs produced by this cell.


#### [`DeepRNN.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="DeepRNN.scope_name" />

Returns the full name of the Module's variable scope.


#### [`DeepRNN.state_size`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic_rnn.py?l=429)<a id="DeepRNN.state_size" />

size(s) of state(s) used by this cell.

It can be represented by an Integer, a TensorShape or a tuple of Integers
or TensorShapes.


#### [`DeepRNN.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="DeepRNN.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`DeepRNN.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="DeepRNN.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`DeepRNN.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="DeepRNN.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`DeepRNN.zero_state(batch_size, dtype)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/rnn_core.py?l=260)<a id="DeepRNN.zero_state" />

Return zero-filled state tensor(s).

##### Args:


* `batch_size`: int, float, or unit Tensor representing the batch size.
* `dtype`: the data type to use for the state.

##### Returns:

  If `state_size` is an int or TensorShape, then the return value is a
  `N-D` tensor of shape `[batch_size x state_size]` filled with zeros.

  If `state_size` is a nested list or tuple, then the return value is
  a nested list or tuple (of the same structure) of `2-D` tensors with
  the shapes `[batch_size x s]` for each s in `state_size`.



### [`class DepthwiseConv2D`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?q=class:DepthwiseConv2D)<a id="DepthwiseConv2D" />

Spatial depthwise 2D convolution module, including bias.

This acts as a light wrapper around the TensorFlow ops
`tf.nn.depthwise_conv2d`, abstracting away variable creation and sharing.

#### [`DepthwiseConv2D.__init__(channel_multiplier, kernel_shape, stride=1, padding='SAME', use_bias=True, initializers=None, partitioners=None, regularizers=None, data_format='NHWC', padding_value='CONSTANT', custom_getter=None, name='conv_2d_depthwise')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=2392)<a id="DepthwiseConv2D.__init__" />

Constructs a DepthwiseConv2D module.

See the following documentation for an explanation of VALID versus SAME
padding modes:
https://www.tensorflow.org/api_docs/python/tf/nn/convolution

##### Args:


* `channel_multiplier`: Number of channels to expand convolution to. Must be
      an integer. Must be > 0. When `channel_multiplier` is set to 1, apply
      a different filter to each input channel producing one output channel
      per input channel. Numbers larger than 1 cause multiple different
      filters to be applied to each input channel, with their outputs being
      concatenated together, producing `channel_multiplier` *
      `input_channels` output channels.
* `kernel_shape`: Iterable with 2 elements in the following layout:
      [filter_height, filter_width] or integer that is
      used to define the list in all dimensions.
* `stride`: Iterable with 2 or 4 elements of kernel strides, or integer that
      is used to define stride in all dimensions. Layout of list:
      In case of 4 elements: `[1, stride_height, stride_widith, 1]`
      In case of 2 elements: `[stride_height, stride_width]`.
* `padding`: Padding algorithm. Either `snt.SAME`, `snt.VALID`, `snt.FULL`,
      `snt.CAUSAL`, `snt.REVERSE_CAUSAL`, or a sequence of these paddings
      of length 2.
      * snt.SAME and snt.VALID are explained in the Tensorflow docs at
        https://www.tensorflow.org/api_docs/python/tf/nn/convolution.
      * snt.FULL pre- and post-pads with the maximum padding which does not
        result in a convolution over just padded elements.
      * snt.CAUSAL pre-pads to ensure that each output value only depends on
        input values at the same or preceding indices ("no dependence on the
        future").
      * snt.REVERSE_CAUSAL post-pads to ensure that each output value only
        depends on input values at the same or *greater* indices ("no
        dependence on the past").
      If you use the same padding for all dimensions, and it is one of SAME
      or VALID, then this is supported directly by the underlying
      convolution op. In all other cases, the input data will be padded
      using tf.pad before calling the convolution op.
* `use_bias`: Whether to include bias parameters. Default `True`.
* `initializers`: Optional dict containing ops to initialize the filters (with
      key 'w') or biases (with key 'b').
* `partitioners`: Optional dict containing partitioners for the filters
      (with key 'w') and the biases (with key 'b'). As a default, no
      partitioners are used.
* `regularizers`: Optional dict containing regularizers for the filters
      (with key 'w') and the biases (with key 'b'). As a default, no
      regularizers are used. A regularizer should be a function that takes
      a single `Tensor` as an input and returns a scalar `Tensor` output,
      e.g. the L1 and L2 regularizers in `tf.contrib.layers`.
* `data_format`: A string. Specifies whether the channel dimension
      of the input and output is the last dimension (default, NHWC), or the
      second dimension ("NCHW").
* `padding_value`: The type of padding to use, either "CONSTANT", "SYMMETRIC"
      or "REFLECT", as supported by the underlying tf.pad
      (https://www.tensorflow.org/api_docs/python/tf/pad). Can only be set
      globally for all dimensions. Defaults to "CONSTANT" which will pad
      with zeros, potentially directly via the underlying convolution op if
      the padding is SAME for all dimensions.
* `custom_getter`: Callable or dictionary of callables to use as
      custom getters inside the module. If a dictionary, the keys
      correspond to regexes to match variable names. See the
      `tf.get_variable` documentation for information about the
      custom_getter API.
* `name`: Name of the module.

##### Raises:


* `ValueError`: If `channel_multiplier` isn't of type (`numbers.Integral` or
      `tf.Dimension`).
* `ValueError`: If `channel_multiplier` is less than 1.
* `ValueError`: If the given data_format is not a supported format (see
      `SUPPORTED_2D_DATA_FORMATS`).
  base.IncompatibleShapeError: If the given kernel shape is not an integer;
      or if the given kernel shape is not a sequence of two integers.
  base.IncompatibleShapeError: If the given stride is not an integer; or if
      the given stride is not a sequence of two integers.

* `ValueError`: If the given padding is not `snt.VALID`, `snt.SAME`,
      `snt.FULL`, `snt.CAUSAL`, `snt.REVERSE_CAUSAL` or a sequence of these.
* `KeyError`: If `initializers`, `partitioners` or `regularizers` contain any
      keys other than 'w' or 'b'.
* `TypeError`: If any of the given initializers, partitioners or regularizers
      are not callable.
* `ValueError`: If the passed-in data_format doesn't have a channel dimension.


#### [`DepthwiseConv2D.__call__(inputs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=556)<a id="DepthwiseConv2D.__call__" />

Connects the _ConvND module into the graph, with input Tensor `inputs`.

If this is not the first time the module has been connected to the graph,
the input Tensor provided here must have the same number of channels, in
order for the existing variables to be the correct size for the
multiplication; the batch size and input spatial dimensions may differ for
each connection.

##### Args:


* `inputs`: A ND Tensor of the same rank as `data_format`, and either of types
  `tf.float16`, `tf.bfloat16`, `tf.float32` or `tf.float64`.

##### Returns:

  A ND Tensor of shape [batch_size, output_dim_1, output_dim_2, ...,
      output_channels].

##### Raises:


* `ValueError`: If connecting the module into the graph any time after the
      first time and the inferred size of the input does not match previous
      invocations.
  base.IncompatibleShapeError: If the input tensor has the wrong number
      of dimensions.
  base.UnderspecifiedError: If the channel dimension of `inputs` isn't
      defined.
  base.IncompatibleShapeError: If a mask is present and its shape is
      incompatible with the shape of the weights.

* `TypeError`: If input Tensor dtype is not compatible with either
      `tf.float16`, `tf.bfloat16`, `tf.float32` or `tf.float64`.


#### [`DepthwiseConv2D.b`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=814)<a id="DepthwiseConv2D.b" />

Returns the Variable containing the bias.

##### Returns:

  Variable object containing the bias, from the most recent __call__.

##### Raises:

  base.NotConnectedError: If the module has not been connected to the graph
      yet, meaning the variables do not exist.

* `AttributeError`: If the module does not use bias.


#### [`DepthwiseConv2D.channel_multiplier`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=2563)<a id="DepthwiseConv2D.channel_multiplier" />

Returns the channel multiplier argument.


#### [`DepthwiseConv2D.clone(name=None)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=876)<a id="DepthwiseConv2D.clone" />

Returns a cloned `_ConvND` module.

##### Args:


* `name`: Optional string assigning name of cloned module. The default name
    is constructed by appending "_clone" to `self.module_name`.

##### Returns:

  A copy of the current class.


#### [`DepthwiseConv2D.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="DepthwiseConv2D.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`DepthwiseConv2D.conv_op_padding`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=803)<a id="DepthwiseConv2D.conv_op_padding" />

Returns the padding algorithm used for the underlying convolution op.


#### [`DepthwiseConv2D.data_format`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=857)<a id="DepthwiseConv2D.data_format" />

Returns the data format.


#### [`DepthwiseConv2D.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="DepthwiseConv2D.defun" />

Wraps this modules call method in a callable graph function.


#### [`DepthwiseConv2D.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="DepthwiseConv2D.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`DepthwiseConv2D.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="DepthwiseConv2D.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`DepthwiseConv2D.get_possible_initializer_keys(use_bias=True)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=552)<a id="DepthwiseConv2D.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`DepthwiseConv2D.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="DepthwiseConv2D.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`DepthwiseConv2D.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="DepthwiseConv2D.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`DepthwiseConv2D.has_bias`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=832)<a id="DepthwiseConv2D.has_bias" />

Returns `True` if bias Variable is present in the module.


#### [`DepthwiseConv2D.initializers`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=837)<a id="DepthwiseConv2D.initializers" />

Returns the initializers dictionary.


#### [`DepthwiseConv2D.input_channels`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=869)<a id="DepthwiseConv2D.input_channels" />

Returns the number of input channels.


#### [`DepthwiseConv2D.input_shape`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=863)<a id="DepthwiseConv2D.input_shape" />

Returns the input shape.


#### [`DepthwiseConv2D.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="DepthwiseConv2D.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`DepthwiseConv2D.kernel_shape`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=758)<a id="DepthwiseConv2D.kernel_shape" />

Returns the kernel shape.


#### [`DepthwiseConv2D.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="DepthwiseConv2D.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`DepthwiseConv2D.mask`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=852)<a id="DepthwiseConv2D.mask" />

Returns the mask.


#### [`DepthwiseConv2D.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="DepthwiseConv2D.module_name" />

Returns the name of the Module.


#### [`DepthwiseConv2D.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="DepthwiseConv2D.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`DepthwiseConv2D.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="DepthwiseConv2D.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`DepthwiseConv2D.output_channels`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=749)<a id="DepthwiseConv2D.output_channels" />

Returns the number of output channels.


#### [`DepthwiseConv2D.padding`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=775)<a id="DepthwiseConv2D.padding" />

Returns the padding algorithm used, if this is the same for all dims.

Use `.paddings` if you want a tuple with the padding algorithm used for each
dimension.

##### Returns:

  The padding algorithm used, if this is the same for all dimensions.

##### Raises:


* `ValueError`: If different padding algorithms are used for different
    dimensions.


#### [`DepthwiseConv2D.paddings`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=798)<a id="DepthwiseConv2D.paddings" />

Returns a tuple with the padding algorithm used for each dimension.


#### [`DepthwiseConv2D.partitioners`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=842)<a id="DepthwiseConv2D.partitioners" />

Returns the partitioners dictionary.


#### [`DepthwiseConv2D.rate`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=770)<a id="DepthwiseConv2D.rate" />

Returns the dilation rate.


#### [`DepthwiseConv2D.regularizers`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=847)<a id="DepthwiseConv2D.regularizers" />

Returns the regularizers dictionary.


#### [`DepthwiseConv2D.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="DepthwiseConv2D.scope_name" />

Returns the full name of the Module's variable scope.


#### [`DepthwiseConv2D.stride`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=763)<a id="DepthwiseConv2D.stride" />

Returns the stride.


#### [`DepthwiseConv2D.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="DepthwiseConv2D.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`DepthwiseConv2D.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="DepthwiseConv2D.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`DepthwiseConv2D.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="DepthwiseConv2D.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`DepthwiseConv2D.w`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=808)<a id="DepthwiseConv2D.w" />

Returns the Variable containing the weight matrix.



### [`class DifferentGraphError`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base_errors.py?q=class:DifferentGraphError)<a id="DifferentGraphError" />

Error raised when trying to connect a Sonnet module to multiple Graphs.


### [`class Embed`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/embed.py?q=class:Embed)<a id="Embed" />

Module for embedding tokens in a low-dimensional space.

#### [`Embed.__init__(vocab_size=None, embed_dim=None, existing_vocab=None, densify_gradients=False, initializers=None, partitioners=None, regularizers=None, trainable=True, custom_getter=None, name='embed')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/embed.py?l=53)<a id="Embed.__init__" />

Constructs an Embed module.

##### Args:


* `vocab_size`: int. Number of unique tokens to embed. If not provided, an
    existing vocabulary matrix from which vocab_size can be inferred must
    be provided as existing_vocab.
* `embed_dim`: int or None. Number of dimensions to assign to each embedding.
    If not specified, a sensible default is chosen based on `vocab_size`. If
    an existing vocabulary matrix initializes the module, this should not be
    provided as it will be inferred.
* `existing_vocab`: a [vocab_size, embed_dim] vocabulary matrix. Will be
    converted to a tf.float32 tensor. If provided, neither or vocab_size or
    embed_dim should be provided as they are inferred.
* `densify_gradients`: if True, we convert the embedding gradient from an
    indexed-slices to a regular tensor before sending it back to the
    parameter server. This avoids excess computation on the parameter
    server. Use this option for moderately sized embeddings, e.g.,
    a vocabulary size on the order of up to thousands. For embeddings larger
    than these, e.g. a vocabulary size on the order of tens or hundreds of
    thousands, set this to False.
* `initializers`: Optional dict containing initializers for embeddings (with
    key 'embeddings'). As a default, embeddings are initialized via a
    truncated normal distribution.
* `partitioners`: Optional dict containing partitioners for embeddings (with
    key 'embeddings'). As a default, no partitioners are used.
* `regularizers`: Optional dict containing regularizers for embeddings (with
    key 'embeddings'). As a default, no regularizers are used. A regularizer
    should be a function that takes a single `Tensor` as an input and
    returns a scalar `Tensor` output, e.g. the L1 and L2 regularizers
    in `tf.contrib.layers`.
* `trainable`: if True, the embeddings will be updated during training. If
    False, they are fixed to their initial values. If `trainable=False` and
    a regularizer is given, the resulting loss stays constant.
* `custom_getter`: Callable or dictionary of callables to use as
    custom getters inside the module. If a dictionary, the keys
    correspond to regexes to match variable names. See the `tf.get_variable`
    documentation for information about the custom_getter API.
* `name`: string. Name for this module.

##### Raises:


* `ValueError`: if neither one of vocab_size or existing_vocab is provided, or
    if existing_vocab is provided along with vocab_size, embedding_dim,
    initializers, partitioners or regularizers (as these should
    be inferred).


#### [`Embed.__call__(ids)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/embed.py?l=139)<a id="Embed.__call__" />

Lookup embeddings.

Looks up an embedding vector for each value in `ids`. All ids must be within
[0, vocab_size), else an `InvalidArgumentError` is raised at runtime.

##### Args:


* `ids`: Tensor of dtype int64.

##### Returns:

  Tensor of tf.shape(ids) + [embedding_dim] and dtype float32.


#### [`Embed.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="Embed.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`Embed.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="Embed.defun" />

Wraps this modules call method in a callable graph function.


#### [`Embed.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="Embed.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`Embed.embed_dim`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/embed.py?l=189)<a id="Embed.embed_dim" />

Size of embedding vectors.


#### [`Embed.embeddings`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/embed.py?l=194)<a id="Embed.embeddings" />

Returns the Variable containing embeddings.

##### Returns:

  A 2D Variable containing one embedding vector per row, constructed in the
    most recent __call__.

##### Raises:

  base.NotConnectedError: If the module has not been connected to the
      graph yet, meaning the variables do not exist.


#### [`Embed.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="Embed.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Embed.get_possible_initializer_keys()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=505)<a id="Embed.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`Embed.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="Embed.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Embed.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="Embed.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`Embed.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="Embed.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`Embed.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="Embed.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Embed.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="Embed.module_name" />

Returns the name of the Module.


#### [`Embed.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="Embed.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`Embed.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="Embed.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Embed.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="Embed.scope_name" />

Returns the full name of the Module's variable scope.


#### [`Embed.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="Embed.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Embed.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="Embed.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Embed.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="Embed.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Embed.vocab_size`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/embed.py?l=184)<a id="Embed.vocab_size" />

Size of input vocabulary.



### [`class Error`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base_errors.py?q=class:Error)<a id="Error" />

Base class for all errors from snt.

This is thrown to indicate a Neural Network specific problem, e.g. wrong
module arity, module is not connected to the graph when it should be,
tried to wire together incompatible modules, etc.


### [`class FlattenTrailingDimensions`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?q=class:FlattenTrailingDimensions)<a id="FlattenTrailingDimensions" />

Flattens trailing dimensions of a Tensor.

#### [`FlattenTrailingDimensions.__init__(dim_from, name='batch_dim_from')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?l=935)<a id="FlattenTrailingDimensions.__init__" />

Constructs a FlattenTrailingDimensions module.

For example, given an input Tensor with shape `[B, H, W, C]`:

  * `dim_from=1` will return a Tensor with shape `[B, H*W*C]`.
  * `dim_from=2` will return a Tensor with shape `[B, H, W*C]`.
  * `dim_from=3` will return the input itself.
  * `dim_from=4` will return a Tensor with shape `[B, H, W, C, 1]`.
  * `dim_from>=5` will generate a ValueError when building the module.
  The preserved dimensions can be unknown at building time.

Equivalent to BatchFlatten(preserve_dims=dim_from, name=name).

##### Args:


* `dim_from`: All dimensions after and including `dim_from` will
      be flattened into a single dimension.
* `name`: Name of the module.

##### Raises:


* `ValueError`: If `dim_from <= 0`.


#### [`FlattenTrailingDimensions.__call__(inputs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?l=810)<a id="FlattenTrailingDimensions.__call__" />

Connects the module into the graph, with input Tensor `inputs`.

##### Args:


* `inputs`: A Tensor of shape [b_1, b_2, ..., b_preserve_dims,
                             b_preserve_dims+1, ...].

##### Returns:

  A Tensor of shape [b_1, b_2, ..., b_preserve_dims,
                     b_reshape_1, b_reshape_2, ...],
    with reshaping defined by the constructor `shape` parameter.

##### Raises:


* `ValueError`: If output shape is incompatible with input shape; or if
      shape array contains non numeric entries; or if shape array contains
      more than 1 wildcard -1; or if the input array contains unknown,
      non-preserved dimensions (except when the unknown dimension is the
      only non-preserved dimension and doesn't actually need reshaping).


#### [`FlattenTrailingDimensions.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="FlattenTrailingDimensions.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`FlattenTrailingDimensions.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="FlattenTrailingDimensions.defun" />

Wraps this modules call method in a callable graph function.


#### [`FlattenTrailingDimensions.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="FlattenTrailingDimensions.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`FlattenTrailingDimensions.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="FlattenTrailingDimensions.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`FlattenTrailingDimensions.get_possible_initializer_keys()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=505)<a id="FlattenTrailingDimensions.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`FlattenTrailingDimensions.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="FlattenTrailingDimensions.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`FlattenTrailingDimensions.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="FlattenTrailingDimensions.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`FlattenTrailingDimensions.input_shape`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?l=893)<a id="FlattenTrailingDimensions.input_shape" />

Returns shape of input `Tensor` passed at last call to `build`.


#### [`FlattenTrailingDimensions.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="FlattenTrailingDimensions.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`FlattenTrailingDimensions.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="FlattenTrailingDimensions.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`FlattenTrailingDimensions.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="FlattenTrailingDimensions.module_name" />

Returns the name of the Module.


#### [`FlattenTrailingDimensions.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="FlattenTrailingDimensions.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`FlattenTrailingDimensions.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="FlattenTrailingDimensions.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`FlattenTrailingDimensions.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="FlattenTrailingDimensions.scope_name" />

Returns the full name of the Module's variable scope.


#### [`FlattenTrailingDimensions.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="FlattenTrailingDimensions.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`FlattenTrailingDimensions.transpose(name=None)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?l=899)<a id="FlattenTrailingDimensions.transpose" />

Returns transpose batch reshape.


#### [`FlattenTrailingDimensions.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="FlattenTrailingDimensions.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`FlattenTrailingDimensions.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="FlattenTrailingDimensions.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.



### [`class GRU`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?q=class:GRU)<a id="GRU" />

GRU recurrent network cell.

The implementation is based on: https://arxiv.org/pdf/1412.3555v1.pdf.

Attributes:
  state_size: Integer indicating the size of state tensor.
  output_size: Integer indicating the size of the core output.

#### [`GRU.__init__(hidden_size, initializers=None, partitioners=None, regularizers=None, custom_getter=None, name='gru')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=1457)<a id="GRU.__init__" />

Construct GRU.

##### Args:


* `hidden_size`: (int) Hidden size dimensionality.
* `initializers`: Dict containing ops to initialize the weights. This
    dict may contain any of the keys returned by
    `GRU.get_possible_initializer_keys`.
* `partitioners`: Optional dict containing partitioners to partition
    the weights and biases. As a default, no partitioners are used. This
    dict may contain any of the keys returned by
    `GRU.get_possible_initializer_keys`
* `regularizers`: Optional dict containing regularizers for the weights and
    biases. As a default, no regularizers are used. This
    dict may contain any of the keys returned by
    `GRU.get_possible_initializer_keys`
* `custom_getter`: Callable that takes as a first argument the true getter,
    and allows overwriting the internal get_variable method. See the
    `tf.get_variable` documentation for more details.
* `name`: Name of the module.

##### Raises:


* `KeyError`: if `initializers` contains any keys not returned by
    `GRU.get_possible_initializer_keys`.
* `KeyError`: if `partitioners` contains any keys not returned by
    `GRU.get_possible_initializer_keys`.
* `KeyError`: if `regularizers` contains any keys not returned by
    `GRU.get_possible_initializer_keys`.


#### [`GRU.__call__(inputs, prev_state)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=1517)<a id="GRU.__call__" />

Connects the GRU module into the graph.

If this is not the first time the module has been connected to the graph,
the Tensors provided as inputs and state must have the same final
dimension, in order for the existing variables to be the correct size for
their corresponding multiplications. The batch size may differ for each
connection.

##### Args:


* `inputs`: Tensor of size `[batch_size, input_size]`.
* `prev_state`: Tensor of size `[batch_size, hidden_size]`.

##### Returns:

  A tuple (output, next_state) where `output` is a Tensor of size
  `[batch_size, hidden_size]` and `next_state` is a Tensor of size
  `[batch_size, hidden_size]`.

##### Raises:


* `ValueError`: If connecting the module into the graph any time after the
    first time, and the inferred size of the inputs does not match previous
    invocations.


#### [`GRU.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="GRU.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`GRU.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="GRU.defun" />

Wraps this modules call method in a callable graph function.


#### [`GRU.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="GRU.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`GRU.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="GRU.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`GRU.get_possible_initializer_keys()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=1496)<a id="GRU.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

##### The set of all possible initializer keys are:


* `wz`: weight for input -> update cell
* `uz`: weight for prev_state -> update cell
* `bz`: bias for update_cell
* `wr`: weight for input -> reset cell
* `ur`: weight for prev_state -> reset cell
* `br`: bias for reset cell
* `wh`: weight for input -> candidate activation
* `uh`: weight for prev_state -> candidate activation
* `bh`: bias for candidate activation

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
    constructor.


#### [`GRU.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="GRU.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`GRU.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="GRU.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`GRU.initial_state(batch_size, dtype=tf.float32, trainable=False, trainable_initializers=None, trainable_regularizers=None, name=None, **unused_kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/rnn_core.py?l=204)<a id="GRU.initial_state" />

Builds the default start state for an RNNCore.

##### Args:


* `batch_size`: An int, or scalar int32 Tensor representing the batch size.
* `dtype`: The data type to use for the state.
* `trainable`: Boolean that indicates whether to learn the initial state.
    Note that intializers and regularizers will be ignored if
    `trainable=False`.
* `trainable_initializers`: An initializer function or nested structure of
      functions with same structure as the `state_size` property of the
      core, to be used as initializers of the initial state variable.
* `trainable_regularizers`: Optional regularizer function or nested structure
    of functions with the same structure as the `state_size` property of the
    core, to be used as regularizers of the initial state variable. As a
    default, no regularizers are used. A regularizer should be a function
    that takes a single `Tensor` as an input and returns a scalar `Tensor`
    output, e.g. the L1 and L2 regularizers in `tf.contrib.layers`.
* `name`: Optional string used to prefix the initial state variable names, in
      the case of a trainable initial state. If not provided, defaults to
      the name of the module.

##### Returns:

  A tensor or nested tuple of tensors with same structure and shape as the
  `state_size` property of the core.

##### Raises:


* `ValueError`: if the user passes initializers that are not functions.
* `ValueError`: if the user passes regularizers that are not functions.


#### [`GRU.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="GRU.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`GRU.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="GRU.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`GRU.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="GRU.module_name" />

Returns the name of the Module.


#### [`GRU.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="GRU.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`GRU.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="GRU.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`GRU.output_size`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=1597)<a id="GRU.output_size" />

Integer or TensorShape: size of outputs produced by this cell.


#### [`GRU.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="GRU.scope_name" />

Returns the full name of the Module's variable scope.


#### [`GRU.state_size`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=1593)<a id="GRU.state_size" />

size(s) of state(s) used by this cell.

It can be represented by an Integer, a TensorShape or a tuple of Integers
or TensorShapes.


#### [`GRU.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="GRU.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`GRU.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="GRU.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`GRU.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="GRU.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`GRU.zero_state(batch_size, dtype)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/rnn_core.py?l=260)<a id="GRU.zero_state" />

Return zero-filled state tensor(s).

##### Args:


* `batch_size`: int, float, or unit Tensor representing the batch size.
* `dtype`: the data type to use for the state.

##### Returns:

  If `state_size` is an int or TensorShape, then the return value is a
  `N-D` tensor of shape `[batch_size x state_size]` filled with zeros.

  If `state_size` is a nested list or tuple, then the return value is
  a nested list or tuple (of the same structure) of `2-D` tensors with
  the shapes `[batch_size x s]` for each s in `state_size`.



### [`class GridWarper`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/spatial_transformer.py?q=class:GridWarper)<a id="GridWarper" />

Grid warper interface class.

An object implementing the `GridWarper` interface generates a reference grid
of feature points at construction time, and warps it via a parametric
transformation model, specified at run time by an input parameter Tensor.
Grid warpers must then implement a `create_features` function used to generate
the reference grid to be warped in the forward pass (according to a determined
warping model).

#### [`GridWarper.__init__(source_shape, output_shape, num_coeff, name, **kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/spatial_transformer.py?l=43)<a id="GridWarper.__init__" />

Constructs a GridWarper module and initializes the source grid params.

`source_shape` and `output_shape` are used to define the size of the source
and output signal domains, as opposed to the shape of the respective
Tensors. For example, for an image of size `width=W` and `height=H`,
`{source,output}_shape=[H, W]`; for a volume of size `width=W`, `height=H`
and `depth=D`, `{source,output}_shape=[H, W, D]`.

##### Args:


* `source_shape`: Iterable of integers determining the size of the source
    signal domain.
* `output_shape`: Iterable of integers determining the size of the destination
    resampled signal domain.
* `num_coeff`: Number of coefficients parametrizing the grid warp.
    For example, a 2D affine transformation will be defined by the 6
    parameters populating the corresponding 2x3 affine matrix.
* `name`: Name of Module.
* `**kwargs`: Extra kwargs to be forwarded to the `create_features` function,
    instantiating the source grid parameters.

##### Raises:


* `Error`: If `len(output_shape) > len(source_shape)`.
* `TypeError`: If `output_shape` and `source_shape` are not both iterable.


#### [`GridWarper.__call__(*args, **kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=296)<a id="GridWarper.__call__" />

Add elements to the Graph, computing output Tensors from input Tensors.

Subclasses must implement this method, which will be wrapped in a Template.

##### Args:


* `*args`: Input Tensors.
* `**kwargs`: Additional Python flags controlling connection.

##### Returns:

  output Tensor(s).


#### [`GridWarper.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="GridWarper.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`GridWarper.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="GridWarper.defun" />

Wraps this modules call method in a callable graph function.


#### [`GridWarper.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="GridWarper.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`GridWarper.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="GridWarper.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`GridWarper.get_possible_initializer_keys()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=505)<a id="GridWarper.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`GridWarper.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="GridWarper.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`GridWarper.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="GridWarper.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`GridWarper.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="GridWarper.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`GridWarper.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="GridWarper.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`GridWarper.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="GridWarper.module_name" />

Returns the name of the Module.


#### [`GridWarper.n_coeff`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/spatial_transformer.py?l=86)<a id="GridWarper.n_coeff" />

Returns number of coefficients of warping function.


#### [`GridWarper.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="GridWarper.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`GridWarper.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="GridWarper.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`GridWarper.output_shape`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/spatial_transformer.py?l=101)<a id="GridWarper.output_shape" />

Returns a tuple containing the shape of the output grid.


#### [`GridWarper.psi`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/spatial_transformer.py?l=91)<a id="GridWarper.psi" />

Returns a list of features used to compute the grid warp.


#### [`GridWarper.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="GridWarper.scope_name" />

Returns the full name of the Module's variable scope.


#### [`GridWarper.source_shape`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/spatial_transformer.py?l=96)<a id="GridWarper.source_shape" />

Returns a tuple containing the shape of the source signal.


#### [`GridWarper.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="GridWarper.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`GridWarper.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="GridWarper.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`GridWarper.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="GridWarper.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.



### [`class HighwayCore`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?q=class:HighwayCore)<a id="HighwayCore" />

Recurrent Highway Network cell.

The implementation is based on: https://arxiv.org/pdf/1607.03474v5.pdf
As per the first lines of section 5 of the reference paper, 1 - T is
used instead of a dedicated C gate.

Attributes:
  state_size: Integer indicating the size of state tensor.
  output_size: Integer indicating the size of the core output.

#### [`HighwayCore.__init__(hidden_size, num_layers, initializers=None, partitioners=None, regularizers=None, custom_getter=None, name='highwaycore')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=1620)<a id="HighwayCore.__init__" />

Construct a new Recurrent Highway core.

##### Args:


* `hidden_size`: (int) Hidden size dimensionality.
* `num_layers`: (int) Number of highway layers.
* `initializers`: Dict containing ops to initialize the weights. This
    dict may contain any of the keys returned by
    `HighwayCore.get_possible_initializer_keys`.
* `partitioners`: Optional dict containing partitioners to partition
    the weights and biases. As a default, no partitioners are used. This
    dict may contain any of the keys returned by
    `HighwayCore.get_possible_initializer_keys`.
* `regularizers`: Optional dict containing regularizers for the weights and
    biases. As a default, no regularizers are used. This
    dict may contain any of the keys returned by
    `HighwayCore.get_possible_initializer_keys`.
* `custom_getter`: Callable that takes as a first argument the true getter,
    and allows overwriting the internal get_variable method. See the
    `tf.get_variable` documentation for more details.
* `name`: Name of the module.

##### Raises:


* `KeyError`: if `initializers` contains any keys not returned by
    `HighwayCore.get_possible_initializer_keys`.
* `KeyError`: if `partitioners` contains any keys not returned by
    `HighwayCore.get_possible_initializer_keys`.
* `KeyError`: if `regularizers` contains any keys not returned by
    `HighwayCore.get_possible_initializer_keys`.


#### [`HighwayCore.__call__(inputs, prev_state)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=1696)<a id="HighwayCore.__call__" />

Connects the highway core module into the graph.

##### Args:


* `inputs`: Tensor of size `[batch_size, input_size]`.
* `prev_state`: Tensor of size `[batch_size, hidden_size]`.

##### Returns:

  A tuple (output, next_state) where `output` is a Tensor of size
  `[batch_size, hidden_size]` and `next_state` is a Tensor of size
  `[batch_size, hidden_size]`.

##### Raises:


* `ValueError`: If connecting the module into the graph any time after the
    first time, and the inferred size of the inputs does not match previous
    invocations.


#### [`HighwayCore.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="HighwayCore.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`HighwayCore.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="HighwayCore.defun" />

Wraps this modules call method in a callable graph function.


#### [`HighwayCore.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="HighwayCore.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`HighwayCore.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="HighwayCore.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`HighwayCore.get_possible_initializer_keys(num_layers)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=1668)<a id="HighwayCore.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

##### The set of all possible initializer keys are:


* `wt`: weight for input -> T gate
* `wh`: weight for input -> H gate
* `wtL`: weight for prev state -> T gate for layer L (indexed from 0)
* `whL`: weight for prev state -> H gate for layer L (indexed from 0)
* `btL`: bias for prev state -> T gate for layer L (indexed from 0)
* `bhL`: bias for prev state -> H gate for layer L (indexed from 0)

##### Args:


* `num_layers`: (int) Number of highway layers.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
    constructor.


#### [`HighwayCore.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="HighwayCore.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`HighwayCore.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="HighwayCore.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`HighwayCore.initial_state(batch_size, dtype=tf.float32, trainable=False, trainable_initializers=None, trainable_regularizers=None, name=None, **unused_kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/rnn_core.py?l=204)<a id="HighwayCore.initial_state" />

Builds the default start state for an RNNCore.

##### Args:


* `batch_size`: An int, or scalar int32 Tensor representing the batch size.
* `dtype`: The data type to use for the state.
* `trainable`: Boolean that indicates whether to learn the initial state.
    Note that intializers and regularizers will be ignored if
    `trainable=False`.
* `trainable_initializers`: An initializer function or nested structure of
      functions with same structure as the `state_size` property of the
      core, to be used as initializers of the initial state variable.
* `trainable_regularizers`: Optional regularizer function or nested structure
    of functions with the same structure as the `state_size` property of the
    core, to be used as regularizers of the initial state variable. As a
    default, no regularizers are used. A regularizer should be a function
    that takes a single `Tensor` as an input and returns a scalar `Tensor`
    output, e.g. the L1 and L2 regularizers in `tf.contrib.layers`.
* `name`: Optional string used to prefix the initial state variable names, in
      the case of a trainable initial state. If not provided, defaults to
      the name of the module.

##### Returns:

  A tensor or nested tuple of tensors with same structure and shape as the
  `state_size` property of the core.

##### Raises:


* `ValueError`: if the user passes initializers that are not functions.
* `ValueError`: if the user passes regularizers that are not functions.


#### [`HighwayCore.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="HighwayCore.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`HighwayCore.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="HighwayCore.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`HighwayCore.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="HighwayCore.module_name" />

Returns the name of the Module.


#### [`HighwayCore.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="HighwayCore.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`HighwayCore.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="HighwayCore.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`HighwayCore.output_size`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=1751)<a id="HighwayCore.output_size" />

Integer or TensorShape: size of outputs produced by this cell.


#### [`HighwayCore.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="HighwayCore.scope_name" />

Returns the full name of the Module's variable scope.


#### [`HighwayCore.state_size`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=1747)<a id="HighwayCore.state_size" />

size(s) of state(s) used by this cell.

It can be represented by an Integer, a TensorShape or a tuple of Integers
or TensorShapes.


#### [`HighwayCore.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="HighwayCore.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`HighwayCore.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="HighwayCore.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`HighwayCore.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="HighwayCore.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`HighwayCore.zero_state(batch_size, dtype)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/rnn_core.py?l=260)<a id="HighwayCore.zero_state" />

Return zero-filled state tensor(s).

##### Args:


* `batch_size`: int, float, or unit Tensor representing the batch size.
* `dtype`: the data type to use for the state.

##### Returns:

  If `state_size` is an int or TensorShape, then the return value is a
  `N-D` tensor of shape `[batch_size x state_size]` filled with zeros.

  If `state_size` is a nested list or tuple, then the return value is
  a nested list or tuple (of the same structure) of `2-D` tensors with
  the shapes `[batch_size x s]` for each s in `state_size`.



### [`class InPlaneConv2D`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?q=class:InPlaneConv2D)<a id="InPlaneConv2D" />

Applies an in-plane convolution to each channel with tied filter weights.

This acts as a light wrapper around the TensorFlow op
`tf.nn.depthwise_conv2d`; it differs from the DepthWiseConv2D module in that
it has tied weights (i.e. the same filter) for all the in-out channel pairs.

#### [`InPlaneConv2D.__init__(kernel_shape, stride=1, padding='SAME', use_bias=True, initializers=None, partitioners=None, regularizers=None, data_format='NHWC', padding_value='CONSTANT', custom_getter=None, name='in_plane_conv2d')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=2252)<a id="InPlaneConv2D.__init__" />

Constructs an InPlaneConv2D module.

See the following documentation for an explanation of VALID versus SAME
padding modes:
https://www.tensorflow.org/api_docs/python/tf/nn/convolution

##### Args:


* `kernel_shape`: Iterable with 2 elements in the layout [filter_height,
      filter_width]; or integer that is used to define the list in all
      dimensions.
* `stride`: Iterable with 2 or 4 elements of kernel strides, or integer that
      is used to define stride in all dimensions.
* `padding`: Padding algorithm. Either `snt.SAME`, `snt.VALID`, `snt.FULL`,
      `snt.CAUSAL`, `snt.REVERSE_CAUSAL`, or a sequence of these paddings
      of length 2.
      * snt.SAME and snt.VALID are explained in the Tensorflow docs at
        https://www.tensorflow.org/api_docs/python/tf/nn/convolution.
      * snt.FULL pre- and post-pads with the maximum padding which does not
        result in a convolution over just padded elements.
      * snt.CAUSAL pre-pads to ensure that each output value only depends on
        input values at the same or preceding indices ("no dependence on the
        future").
      * snt.REVERSE_CAUSAL post-pads to ensure that each output value only
        depends on input values at the same or *greater* indices ("no
        dependence on the past").
      If you use the same padding for all dimensions, and it is one of SAME
      or VALID, then this is supported directly by the underlying
      convolution op. In all other cases, the input data will be padded
      using tf.pad before calling the convolution op.
* `use_bias`: Whether to include bias parameters. Default `True`.
* `initializers`: Optional dict containing ops to initialize the filters (with
      key 'w') or biases (with key 'b').
* `partitioners`: Optional dict containing partitioners to partition the
      filters (with key 'w') or biases (with key 'b'). As a default, no
      partitioners are used.
* `regularizers`: Optional dict containing regularizers for the filters
      (with key 'w') and the biases (with key 'b'). As a default, no
      regularizers are used. A regularizer should be a function that takes
      a single `Tensor` as an input and returns a scalar `Tensor` output,
      e.g. the L1 and L2 regularizers in `tf.contrib.layers`.
* `data_format`: A string. Specifies whether the channel dimension
      of the input and output is the last dimension (default, NHWC), or the
      second dimension (NCHW).
* `padding_value`: The type of padding to use, either "CONSTANT", "SYMMETRIC"
      or "REFLECT", as supported by the underlying tf.pad
      (https://www.tensorflow.org/api_docs/python/tf/pad). Can only be set
      globally for all dimensions. Defaults to "CONSTANT" which will pad
      with zeros, potentially directly via the underlying convolution op if
      the padding is SAME for all dimensions.
* `custom_getter`: Callable or dictionary of callables to use as
      custom getters inside the module. If a dictionary, the keys
      correspond to regexes to match variable names. See the
      `tf.get_variable` documentation for information about the
      custom_getter API.
* `name`: Name of the module.

##### Raises:


* `ValueError`: If the given data_format is not a supported format (see
      `SUPPORTED_2D_DATA_FORMATS`).
  base.IncompatibleShapeError: If the given kernel shape is not an integer;
      or if the given kernel shape is not a sequence of two integers.
  base.IncompatibleShapeError: If the given stride is not an integer; or if
      the given stride is not a sequence of two integers.

* `ValueError`: If the given padding is not `snt.VALID`, `snt.SAME`,
      `snt.FULL`, `snt.CAUSAL`, `snt.REVERSE_CAUSAL` or a sequence of these.
* `KeyError`: If `initializers`, `partitioners` or `regularizers` contain any
      keys other than 'w' or 'b'.
* `TypeError`: If any of the given initializers, partitioners or regularizers
      are not callable.
* `ValueError`: If the passed-in data_format doesn't have a channel dimension.


#### [`InPlaneConv2D.__call__(inputs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=556)<a id="InPlaneConv2D.__call__" />

Connects the _ConvND module into the graph, with input Tensor `inputs`.

If this is not the first time the module has been connected to the graph,
the input Tensor provided here must have the same number of channels, in
order for the existing variables to be the correct size for the
multiplication; the batch size and input spatial dimensions may differ for
each connection.

##### Args:


* `inputs`: A ND Tensor of the same rank as `data_format`, and either of types
  `tf.float16`, `tf.bfloat16`, `tf.float32` or `tf.float64`.

##### Returns:

  A ND Tensor of shape [batch_size, output_dim_1, output_dim_2, ...,
      output_channels].

##### Raises:


* `ValueError`: If connecting the module into the graph any time after the
      first time and the inferred size of the input does not match previous
      invocations.
  base.IncompatibleShapeError: If the input tensor has the wrong number
      of dimensions.
  base.UnderspecifiedError: If the channel dimension of `inputs` isn't
      defined.
  base.IncompatibleShapeError: If a mask is present and its shape is
      incompatible with the shape of the weights.

* `TypeError`: If input Tensor dtype is not compatible with either
      `tf.float16`, `tf.bfloat16`, `tf.float32` or `tf.float64`.


#### [`InPlaneConv2D.b`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=814)<a id="InPlaneConv2D.b" />

Returns the Variable containing the bias.

##### Returns:

  Variable object containing the bias, from the most recent __call__.

##### Raises:

  base.NotConnectedError: If the module has not been connected to the graph
      yet, meaning the variables do not exist.

* `AttributeError`: If the module does not use bias.


#### [`InPlaneConv2D.clone(name=None)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=876)<a id="InPlaneConv2D.clone" />

Returns a cloned `_ConvND` module.

##### Args:


* `name`: Optional string assigning name of cloned module. The default name
    is constructed by appending "_clone" to `self.module_name`.

##### Returns:

  A copy of the current class.


#### [`InPlaneConv2D.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="InPlaneConv2D.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`InPlaneConv2D.conv_op_padding`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=803)<a id="InPlaneConv2D.conv_op_padding" />

Returns the padding algorithm used for the underlying convolution op.


#### [`InPlaneConv2D.data_format`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=857)<a id="InPlaneConv2D.data_format" />

Returns the data format.


#### [`InPlaneConv2D.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="InPlaneConv2D.defun" />

Wraps this modules call method in a callable graph function.


#### [`InPlaneConv2D.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="InPlaneConv2D.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`InPlaneConv2D.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="InPlaneConv2D.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`InPlaneConv2D.get_possible_initializer_keys(use_bias=True)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=552)<a id="InPlaneConv2D.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`InPlaneConv2D.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="InPlaneConv2D.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`InPlaneConv2D.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="InPlaneConv2D.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`InPlaneConv2D.has_bias`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=832)<a id="InPlaneConv2D.has_bias" />

Returns `True` if bias Variable is present in the module.


#### [`InPlaneConv2D.initializers`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=837)<a id="InPlaneConv2D.initializers" />

Returns the initializers dictionary.


#### [`InPlaneConv2D.input_channels`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=869)<a id="InPlaneConv2D.input_channels" />

Returns the number of input channels.


#### [`InPlaneConv2D.input_shape`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=863)<a id="InPlaneConv2D.input_shape" />

Returns the input shape.


#### [`InPlaneConv2D.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="InPlaneConv2D.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`InPlaneConv2D.kernel_shape`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=758)<a id="InPlaneConv2D.kernel_shape" />

Returns the kernel shape.


#### [`InPlaneConv2D.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="InPlaneConv2D.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`InPlaneConv2D.mask`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=852)<a id="InPlaneConv2D.mask" />

Returns the mask.


#### [`InPlaneConv2D.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="InPlaneConv2D.module_name" />

Returns the name of the Module.


#### [`InPlaneConv2D.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="InPlaneConv2D.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`InPlaneConv2D.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="InPlaneConv2D.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`InPlaneConv2D.output_channels`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=749)<a id="InPlaneConv2D.output_channels" />

Returns the number of output channels.


#### [`InPlaneConv2D.padding`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=775)<a id="InPlaneConv2D.padding" />

Returns the padding algorithm used, if this is the same for all dims.

Use `.paddings` if you want a tuple with the padding algorithm used for each
dimension.

##### Returns:

  The padding algorithm used, if this is the same for all dimensions.

##### Raises:


* `ValueError`: If different padding algorithms are used for different
    dimensions.


#### [`InPlaneConv2D.paddings`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=798)<a id="InPlaneConv2D.paddings" />

Returns a tuple with the padding algorithm used for each dimension.


#### [`InPlaneConv2D.partitioners`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=842)<a id="InPlaneConv2D.partitioners" />

Returns the partitioners dictionary.


#### [`InPlaneConv2D.rate`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=770)<a id="InPlaneConv2D.rate" />

Returns the dilation rate.


#### [`InPlaneConv2D.regularizers`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=847)<a id="InPlaneConv2D.regularizers" />

Returns the regularizers dictionary.


#### [`InPlaneConv2D.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="InPlaneConv2D.scope_name" />

Returns the full name of the Module's variable scope.


#### [`InPlaneConv2D.stride`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=763)<a id="InPlaneConv2D.stride" />

Returns the stride.


#### [`InPlaneConv2D.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="InPlaneConv2D.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`InPlaneConv2D.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="InPlaneConv2D.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`InPlaneConv2D.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="InPlaneConv2D.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`InPlaneConv2D.w`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=808)<a id="InPlaneConv2D.w" />

Returns the Variable containing the weight matrix.



### [`class IncompatibleShapeError`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base_errors.py?q=class:IncompatibleShapeError)<a id="IncompatibleShapeError" />

Error raised when the shape of the input at build time is incompatible.


### [`class LSTM`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?q=class:LSTM)<a id="LSTM" />

LSTM recurrent network cell with optional peepholes & layer normalization.

The implementation is based on: http://arxiv.org/abs/1409.2329. We add
forget_bias (default: 1) to the biases of the forget gate in order to
reduce the scale of forgetting in the beginning of the training.

#### Layer normalization

This is described in https://arxiv.org/pdf/1607.06450.pdf

#### Peep-hole connections

Peep-hole connections may optionally be used by specifying a flag in the
constructor. These connections can aid increasing the precision of output
timing, for more details see:

  https://research.google.com/pubs/archive/43905.pdf

#### Recurrent projections

Projection of the recurrent state, to reduce model parameters and speed up
computation. For more details see:

  https://arxiv.org/abs/1402.1128

Attributes:
  state_size: Tuple of `tf.TensorShape`s indicating the size of state tensors.
  output_size: `tf.TensorShape` indicating the size of the core output.
  use_peepholes: Boolean indicating whether peephole connections are used.

#### [`LSTM.__init__(hidden_size, forget_bias=1.0, initializers=None, partitioners=None, regularizers=None, use_peepholes=False, use_layer_norm=False, hidden_clip_value=None, projection_size=None, cell_clip_value=None, custom_getter=None, name='lstm')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=101)<a id="LSTM.__init__" />

Construct LSTM.

##### Args:


* `hidden_size`: (int) Hidden size dimensionality.
* `forget_bias`: (float) Bias for the forget activation.
* `initializers`: Dict containing ops to initialize the weights.
    This dictionary may contain any of the keys returned by
    `LSTM.get_possible_initializer_keys`.
* `partitioners`: Optional dict containing partitioners to partition
    the weights and biases. As a default, no partitioners are used. This
    dict may contain any of the keys returned by
    `LSTM.get_possible_initializer_keys`.
* `regularizers`: Optional dict containing regularizers for the weights and
    biases. As a default, no regularizers are used. This dict may contain
    any of the keys returned by
    `LSTM.get_possible_initializer_keys`.
* `use_peepholes`: Boolean that indicates whether peephole connections are
    used.
* `use_layer_norm`: Boolean that indicates whether to apply layer
    normalization.
* `hidden_clip_value`: Optional number; if set, then the LSTM hidden state
    vector is clipped by this value.
* `projection_size`: Optional number; if set, then the LSTM hidden state is
    projected to this size via a learnable projection matrix.
* `cell_clip_value`: Optional number; if set, then the LSTM cell vector is
    clipped by this value.
* `custom_getter`: Callable that takes as a first argument the true getter,
    and allows overwriting the internal get_variable method. See the
    `tf.get_variable` documentation for more details.
* `name`: Name of the module.

##### Raises:


* `KeyError`: if `initializers` contains any keys not returned by
    `LSTM.get_possible_initializer_keys`.
* `KeyError`: if `partitioners` contains any keys not returned by
    `LSTM.get_possible_initializer_keys`.
* `KeyError`: if `regularizers` contains any keys not returned by
    `LSTM.get_possible_initializer_keys`.
* `ValueError`: if a peephole initializer is passed in the initializer list,
    but `use_peepholes` is False.


#### [`LSTM.__call__(inputs, prev_state)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=211)<a id="LSTM.__call__" />

Connects the LSTM module into the graph.

If this is not the first time the module has been connected to the graph,
the Tensors provided as inputs and state must have the same final
dimension, in order for the existing variables to be the correct size for
their corresponding multiplications. The batch size may differ for each
connection.

##### Args:


* `inputs`: Tensor of size `[batch_size, input_size]`.
* `prev_state`: Tuple (prev_hidden, prev_cell).

##### Returns:

  A tuple (output, next_state) where 'output' is a Tensor of size
  `[batch_size, hidden_size]` and 'next_state' is a `LSTMState` namedtuple
  (next_hidden, next_cell) where `next_hidden` and `next_cell` have size
  `[batch_size, hidden_size]`. If `projection_size` is specified, then
  `next_hidden` will have size `[batch_size, projection_size]`.

##### Raises:


* `ValueError`: If connecting the module into the graph any time after the
    first time, and the inferred size of the inputs does not match previous
    invocations.


#### [`LSTM.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="LSTM.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`LSTM.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="LSTM.defun" />

Wraps this modules call method in a callable graph function.


#### [`LSTM.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="LSTM.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`LSTM.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="LSTM.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`LSTM.get_possible_initializer_keys(use_peepholes=False, use_projection=False)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=179)<a id="LSTM.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

##### The set of all possible initializer keys are:


* `w_gates`: weight for gates
* `b_gates`: bias of gates
* `w_f_diag`: weight for prev_cell -> forget gate peephole
* `w_i_diag`: weight for prev_cell -> input gate peephole
* `w_o_diag`: weight for prev_cell -> output gate peephole

##### Args:

  cls:The class.

* `use_peepholes`: Boolean that indicates whether peephole connections are
    used.
* `use_projection`: Boolean that indicates whether a recurrent projection
    layer is used.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
    constructor.


#### [`LSTM.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="LSTM.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`LSTM.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="LSTM.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`LSTM.initial_state(batch_size, dtype=tf.float32, trainable=False, trainable_initializers=None, trainable_regularizers=None, name=None, **unused_kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/rnn_core.py?l=204)<a id="LSTM.initial_state" />

Builds the default start state for an RNNCore.

##### Args:


* `batch_size`: An int, or scalar int32 Tensor representing the batch size.
* `dtype`: The data type to use for the state.
* `trainable`: Boolean that indicates whether to learn the initial state.
    Note that intializers and regularizers will be ignored if
    `trainable=False`.
* `trainable_initializers`: An initializer function or nested structure of
      functions with same structure as the `state_size` property of the
      core, to be used as initializers of the initial state variable.
* `trainable_regularizers`: Optional regularizer function or nested structure
    of functions with the same structure as the `state_size` property of the
    core, to be used as regularizers of the initial state variable. As a
    default, no regularizers are used. A regularizer should be a function
    that takes a single `Tensor` as an input and returns a scalar `Tensor`
    output, e.g. the L1 and L2 regularizers in `tf.contrib.layers`.
* `name`: Optional string used to prefix the initial state variable names, in
      the case of a trainable initial state. If not provided, defaults to
      the name of the module.

##### Returns:

  A tensor or nested tuple of tensors with same structure and shape as the
  `state_size` property of the core.

##### Raises:


* `ValueError`: if the user passes initializers that are not functions.
* `ValueError`: if the user passes regularizers that are not functions.


#### [`LSTM.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="LSTM.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`LSTM.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="LSTM.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`LSTM.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="LSTM.module_name" />

Returns the name of the Module.


#### [`LSTM.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="LSTM.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`LSTM.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="LSTM.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`LSTM.output_size`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=344)<a id="LSTM.output_size" />

`tf.TensorShape` indicating the size of the core output.


#### [`LSTM.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="LSTM.scope_name" />

Returns the full name of the Module's variable scope.


#### [`LSTM.state_size`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=338)<a id="LSTM.state_size" />

Tuple of `tf.TensorShape`s indicating the size of state tensors.


#### [`LSTM.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="LSTM.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`LSTM.use_layer_norm`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=354)<a id="LSTM.use_layer_norm" />

Boolean indicating whether layer norm is enabled.


#### [`LSTM.use_peepholes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=349)<a id="LSTM.use_peepholes" />

Boolean indicating whether peephole connections are used.


#### [`LSTM.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="LSTM.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`LSTM.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="LSTM.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`LSTM.zero_state(batch_size, dtype)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/rnn_core.py?l=260)<a id="LSTM.zero_state" />

Return zero-filled state tensor(s).

##### Args:


* `batch_size`: int, float, or unit Tensor representing the batch size.
* `dtype`: the data type to use for the state.

##### Returns:

  If `state_size` is an int or TensorShape, then the return value is a
  `N-D` tensor of shape `[batch_size x state_size]` filled with zeros.

  If `state_size` is a nested list or tuple, then the return value is
  a nested list or tuple (of the same structure) of `2-D` tensors with
  the shapes `[batch_size x s]` for each s in `state_size`.



### [`class LSTMBlockCell`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?q=class:LSTMBlockCell)<a id="LSTMBlockCell" />

Wraps the TensorFlow LSTMBlockCell as a Sonnet RNNCore.

#### [`LSTMBlockCell.__init__(num_units, forget_bias=1.0, cell_clip=None, use_peephole=False, dtype=None, reuse=None, name='lstm_cell')`](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/contrib/rnn/python/ops/lstm_ops.py?l=304)<a id="LSTMBlockCell.__init__" />

Initialize the basic LSTM cell.

##### Args:


* `num_units`: int, The number of units in the LSTM cell.
* `forget_bias`: float, The bias added to forget gates (see above).
* `cell_clip`: An optional `float`. Defaults to `-1` (no clipping).
* `use_peephole`: Whether to use peephole connections or not.
* `dtype`: the variable dtype of this layer. Default to tf.float32.
* `reuse`: (optional) boolean describing whether to reuse variables in an
    existing scope.  If not `True`, and the existing scope already has the
    given variables, an error is raised.
* `name`: String, the name of the layer. Layers with the same name will
    share weights, but to avoid mistakes we require reuse=True in such
    cases.  By default this is "lstm_cell", for variable-name compatibility
    with `tf.compat.v1.nn.rnn_cell.LSTMCell`.

  When restoring from CudnnLSTM-trained checkpoints, must use
  CudnnCompatibleLSTMBlockCell instead.


#### [`LSTMBlockCell.__call__(inputs, prev_state)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/rnn_core.py?l=374)<a id="LSTMBlockCell.__call__" />

Add elements to the Graph, computing output Tensors from input Tensors.

Subclasses must implement this method, which will be wrapped in a Template.

##### Args:


* `*args`: Input Tensors.
* `**kwargs`: Additional Python flags controlling connection.

##### Returns:

  output Tensor(s).


#### [`LSTMBlockCell.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="LSTMBlockCell.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`LSTMBlockCell.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="LSTMBlockCell.defun" />

Wraps this modules call method in a callable graph function.


#### [`LSTMBlockCell.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="LSTMBlockCell.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`LSTMBlockCell.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="LSTMBlockCell.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`LSTMBlockCell.get_possible_initializer_keys()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=505)<a id="LSTMBlockCell.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`LSTMBlockCell.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="LSTMBlockCell.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`LSTMBlockCell.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="LSTMBlockCell.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`LSTMBlockCell.initial_state(batch_size, dtype=tf.float32, trainable=False, trainable_initializers=None, trainable_regularizers=None, name=None, **unused_kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/rnn_core.py?l=204)<a id="LSTMBlockCell.initial_state" />

Builds the default start state for an RNNCore.

##### Args:


* `batch_size`: An int, or scalar int32 Tensor representing the batch size.
* `dtype`: The data type to use for the state.
* `trainable`: Boolean that indicates whether to learn the initial state.
    Note that intializers and regularizers will be ignored if
    `trainable=False`.
* `trainable_initializers`: An initializer function or nested structure of
      functions with same structure as the `state_size` property of the
      core, to be used as initializers of the initial state variable.
* `trainable_regularizers`: Optional regularizer function or nested structure
    of functions with the same structure as the `state_size` property of the
    core, to be used as regularizers of the initial state variable. As a
    default, no regularizers are used. A regularizer should be a function
    that takes a single `Tensor` as an input and returns a scalar `Tensor`
    output, e.g. the L1 and L2 regularizers in `tf.contrib.layers`.
* `name`: Optional string used to prefix the initial state variable names, in
      the case of a trainable initial state. If not provided, defaults to
      the name of the module.

##### Returns:

  A tensor or nested tuple of tensors with same structure and shape as the
  `state_size` property of the core.

##### Raises:


* `ValueError`: if the user passes initializers that are not functions.
* `ValueError`: if the user passes regularizers that are not functions.


#### [`LSTMBlockCell.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="LSTMBlockCell.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`LSTMBlockCell.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="LSTMBlockCell.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`LSTMBlockCell.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="LSTMBlockCell.module_name" />

Returns the name of the Module.


#### [`LSTMBlockCell.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="LSTMBlockCell.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`LSTMBlockCell.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="LSTMBlockCell.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`LSTMBlockCell.output_size`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/rnn_core.py?l=377)<a id="LSTMBlockCell.output_size" />

Integer or TensorShape: size of outputs produced by this cell.


#### [`LSTMBlockCell.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="LSTMBlockCell.scope_name" />

Returns the full name of the Module's variable scope.


#### [`LSTMBlockCell.state_size`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/rnn_core.py?l=381)<a id="LSTMBlockCell.state_size" />

size(s) of state(s) used by this cell.

It can be represented by an Integer, a TensorShape or a tuple of Integers
or TensorShapes.


#### [`LSTMBlockCell.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="LSTMBlockCell.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`LSTMBlockCell.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="LSTMBlockCell.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`LSTMBlockCell.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="LSTMBlockCell.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`LSTMBlockCell.zero_state(batch_size, dtype)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/rnn_core.py?l=260)<a id="LSTMBlockCell.zero_state" />

Return zero-filled state tensor(s).

##### Args:


* `batch_size`: int, float, or unit Tensor representing the batch size.
* `dtype`: the data type to use for the state.

##### Returns:

  If `state_size` is an int or TensorShape, then the return value is a
  `N-D` tensor of shape `[batch_size x state_size]` filled with zeros.

  If `state_size` is a nested list or tuple, then the return value is
  a nested list or tuple (of the same structure) of `2-D` tensors with
  the shapes `[batch_size x s]` for each s in `state_size`.



### [`class LSTMState`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?q=class:LSTMState)<a id="LSTMState" />

LSTMState(hidden, cell)

#### `LSTMState.cell`<a id="LSTMState.cell" />

Alias for field number 1


#### `LSTMState.hidden`<a id="LSTMState.hidden" />

Alias for field number 0



### [`class LayerNorm`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/layer_norm.py?q=class:LayerNorm)<a id="LayerNorm" />

Layer normalization module.

Implementation based on:
https://arxiv.org/abs/1607.06450

This module transforms input x into:

  outputs = gamma * (x - mu) / sigma + beta

where mu and sigma are respectively the mean and standard deviation of x.
Gamma and beta are trainable parameters for scaling and shifting respectively.

Since the axes over which normalization is perfomed is configurable, this also
subsumes instance normalization.

#### [`LayerNorm.__init__(axis=None, offset=True, scale=True, eps=1e-05, initializers=None, partitioners=None, regularizers=None, name='layer_norm')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/layer_norm.py?l=60)<a id="LayerNorm.__init__" />

Constructs a LayerNorm module.

##### Args:


* `axis`: Optional dimension or iterable of indices of dimensions to normalize
    and reduce over. By default `None` and all dimensions except the
    first/batch dimension are reduced over. If the input tensor represents
    an image, summing over all except the batch and channel dimensions (e.g.
    for image format NHWC, axes=[1,2]), then this module corresponds to
    Instance Normalization (https://arxiv.org/abs/1607.08022).
* `offset`: Optional boolean to specify whether or not to apply a trained
    component-wise bias after the layer normalization and scaling.
* `scale`: Optional boolean to specify whether or not to apply a trained
    component-wise scale after the layer normalization.
* `eps`: small epsilon to avoid division by zero variance. Defaults to
    1e-5 as used in the paper.
* `initializers`: Dict containing ops to initialize the scale
    (with key 'gamma') and bias (with key 'beta').
* `partitioners`: Optional dict containing partitioners to partition
    the scale (with key 'gamma') and bias (with key 'beta'). As a default,
    no partitioners are used.
* `regularizers`: Optional dict containing regularizers for the scale (with
    key 'gamma') and bias (with key 'beta').. As a default, no regularizers
    are used.
* `name`: name of the module.

##### Raises:


* `KeyError`: If `initializers`, `partitioners` or `regularizers` contain
    any keys other than `gamma` or `beta`.
* `TypeError`: If any of the given initializers, partitioners or regularizers
    are not callable.


#### [`LayerNorm.__call__(inputs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/layer_norm.py?l=115)<a id="LayerNorm.__call__" />

Connects the LayerNorm module into the graph.

##### Args:


* `inputs`: a Tensor of dimensionality >= 2.

##### Returns:


* `normalized`: layer normalized outputs with same shape as inputs.

##### Raises:

  base.NotSupportedError: If `inputs` has less than 2 dimensions.


#### [`LayerNorm.beta`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/layer_norm.py?l=193)<a id="LayerNorm.beta" />




#### [`LayerNorm.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="LayerNorm.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`LayerNorm.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="LayerNorm.defun" />

Wraps this modules call method in a callable graph function.


#### [`LayerNorm.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="LayerNorm.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`LayerNorm.gamma`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/layer_norm.py?l=198)<a id="LayerNorm.gamma" />




#### [`LayerNorm.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="LayerNorm.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`LayerNorm.get_possible_initializer_keys()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=505)<a id="LayerNorm.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`LayerNorm.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="LayerNorm.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`LayerNorm.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="LayerNorm.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`LayerNorm.initializers`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/layer_norm.py?l=181)<a id="LayerNorm.initializers" />




#### [`LayerNorm.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="LayerNorm.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`LayerNorm.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="LayerNorm.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`LayerNorm.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="LayerNorm.module_name" />

Returns the name of the Module.


#### [`LayerNorm.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="LayerNorm.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`LayerNorm.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="LayerNorm.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`LayerNorm.partitioners`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/layer_norm.py?l=185)<a id="LayerNorm.partitioners" />




#### [`LayerNorm.regularizers`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/layer_norm.py?l=189)<a id="LayerNorm.regularizers" />




#### [`LayerNorm.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="LayerNorm.scope_name" />

Returns the full name of the Module's variable scope.


#### [`LayerNorm.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="LayerNorm.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`LayerNorm.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="LayerNorm.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`LayerNorm.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="LayerNorm.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.



### [`class Linear`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?q=class:Linear)<a id="Linear" />

Linear module, optionally including bias.

#### [`Linear.__init__(output_size, use_bias=True, initializers=None, partitioners=None, regularizers=None, custom_getter=None, allow_many_batch_dims=False, name='linear')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?l=138)<a id="Linear.__init__" />

Constructs a linear module.

Linear map from `[batch_size, input_size]` -> `[batch_size, output_size]`.

One can also use this for inputs with multiple batch dimensions, by setting
`allow_many_batch_dims=True`. Then this maps

  `[batch_dim_1, ..., batch_dim_{n-1}, input_size]` ->
    `[batch_dim_1, ..., batch_dim_{n-1}, output_size]`.

In allow_many_batch_dims mode, this operation is equivalent to flattening
the n-1 leading dimensions of the input and applying a 2-D linear. However
it avoids the flatten and reshape operation.

##### Args:


* `output_size`: Output dimensionality. `output_size` can be either an integer
      or a callable. In the latter case, since the function invocation is
      deferred to graph construction time, the user must only ensure that
      output_size can be called, returning an integer, when build is called.
* `use_bias`: Whether to include bias parameters. Default `True`.
* `initializers`: Optional dict containing initializers to initialize the
      weights (with key 'w') or biases (with key 'b'). The default
      initializer for the weights is a truncated normal initializer, which
      is commonly used when the inputs are zero centered (see
      https://arxiv.org/pdf/1502.03167v3.pdf). The default initializer for
      the bias is a zero initializer.
* `partitioners`: Optional dict containing partitioners to partition
      weights (with key 'w') or biases (with key 'b'). As a default, no
      partitioners are used.
* `regularizers`: Optional dict containing regularizers for the weights
    (with key 'w') and the biases (with key 'b'). As a default, no
    regularizers are used. A regularizer should be a function that takes
    a single `Tensor` as an input and returns a scalar `Tensor` output, e.g.
    the L1 and L2 regularizers in `tf.contrib.layers`.
* `custom_getter`: Callable or dictionary of callables to use as
    custom getters inside the module. If a dictionary, the keys
    correspond to regexes to match variable names. See the `tf.get_variable`
    documentation for information about the custom_getter API.
* `allow_many_batch_dims`: If true, enables the use of a batched matmul over
    higher-dimensional inputs. The linear is applied to the final dimension.
    Namely instead of a `[batch_size, dim]` 2-D input, one can have a
    `[batch_dim_1, batch_dim_2, ..., batch_dim_{N-1}, input_size]` N-D
    input which will be mapped to a N-D
    `[batch_dim_1, batch_dim_2, ..., batch_dim_{N-1}, output_size]` output.
* `name`: Name of the module.

##### Raises:


* `KeyError`: If `initializers`, `partitioners` or `regularizers` contains any
    keys other than 'w' or 'b'.
* `TypeError`: If any of the given initializers, partitioners or regularizers
    are not callable.


#### [`Linear.__call__(inputs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?l=218)<a id="Linear.__call__" />

Connects the Linear module into the graph, with input Tensor `inputs`.

Linear maps the final dimension.

If this is not the first time the module has been connected to the graph,
the Tensor provided here must have the same final dimension, in order for
the existing variables to be the correct size for the multiplication. The
batch size may differ for each connection.

##### Args:


* `inputs`: A N-D Tensor of size [dim_1, ..., dim_{N-1}, input_size].

##### Returns:

  A N-D Tensor of size [dim_1, ..., dim_{N-1}, output_size].

##### Raises:

  base.IncompatibleShapeError: If the input is not a 2-D `Tensor` with
      the size of the second dimension specified and `allow_many_batch_dims`
      is set to False.
  base.IncompatibleShapeError: If reconnecting an already connected module
      into the graph, and the shape of the input is not compatible with
      previous inputs.


#### [`Linear.b`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?l=312)<a id="Linear.b" />

Returns the Variable containing the bias.

##### Returns:

  Variable object containing the bias, from the most recent __call__.

##### Raises:

  base.NotConnectedError: If the module has not been connected to the
      graph yet, meaning the variables do not exist.

* `AttributeError`: If the module does not use bias.


#### [`Linear.clone(name=None)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?l=357)<a id="Linear.clone" />

Returns a cloned `Linear` module.

##### Args:


* `name`: Optional string assigning name of cloned module. The default name
      is constructed by appending "_clone" to `self.module_name`.

##### Returns:

  Cloned `Linear` module.


#### [`Linear.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="Linear.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`Linear.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="Linear.defun" />

Wraps this modules call method in a callable graph function.


#### [`Linear.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="Linear.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`Linear.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="Linear.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Linear.get_possible_initializer_keys(use_bias=True)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?l=214)<a id="Linear.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`Linear.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="Linear.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Linear.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="Linear.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`Linear.has_bias`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?l=337)<a id="Linear.has_bias" />

Returns `True` if bias Variable is present in the module.


#### [`Linear.initializers`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?l=342)<a id="Linear.initializers" />

Returns the initializers dictionary.


#### [`Linear.input_shape`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?l=377)<a id="Linear.input_shape" />

Returns shape of input `Tensor` passed at last call to `build`.


#### [`Linear.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="Linear.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`Linear.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="Linear.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Linear.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="Linear.module_name" />

Returns the name of the Module.


#### [`Linear.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="Linear.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`Linear.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="Linear.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Linear.output_size`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?l=330)<a id="Linear.output_size" />

Returns the module output size.


#### [`Linear.partitioners`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?l=347)<a id="Linear.partitioners" />

Returns the partitioners dictionary.


#### [`Linear.regularizers`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?l=352)<a id="Linear.regularizers" />

Returns the regularizers dictionary.


#### [`Linear.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="Linear.scope_name" />

Returns the full name of the Module's variable scope.


#### [`Linear.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="Linear.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Linear.transpose(name=None)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?l=384)<a id="Linear.transpose" />

Returns transposed `Linear` module.

##### Args:


* `name`: Optional string assigning name of transpose module. The default name
      is constructed by appending "_transpose" to `self.module_name`.

##### Returns:

  Transposed `Linear` module.


#### [`Linear.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="Linear.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Linear.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="Linear.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Linear.w`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?l=298)<a id="Linear.w" />

Returns the Variable containing the weight matrix.

##### Returns:

  Variable object containing the weights, from the most recent __call__.

##### Raises:

  base.NotConnectedError: If the module has not been connected to the
      graph yet, meaning the variables do not exist.



### [`class MergeDims`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?q=class:MergeDims)<a id="MergeDims" />

Merges a tensor or nested list of tensors along a range of dimensions.

Tensors are reshaped by specifying the range of dimensions to merge.
Hence, the reshape can be performed without knowing in advance the rank of
the input tensor.

For example, merging dimensions 1, 2 and 3 together can be performed by
calling:

```python
output = MergeDims(start=1, size=3)(x)
```

A nested list of tensors can be merged:

```python
x = [tf.random_uniform(shape=[5, 5]), [tf.random_uniform(shape=[3, 3, 3])]]
output = MergeDims(start=0, size=2)(x)
```

#### [`MergeDims.__init__(start, size, name='merge_dims')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?l=1327)<a id="MergeDims.__init__" />

Constructs the MergeDims module.

##### Args:


* `start`: Start of the range of dimensions to merge.
* `size`: Size the range of dimensions to merge.
* `name`: The name of the module.

##### Raises:


* `ValueError`: If `size` is not strictly greater than 1.


#### [`MergeDims.__call__(inputs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?l=1385)<a id="MergeDims.__call__" />

Connects the MergeDims module into the graph.

##### Args:


* `inputs`: Tensor or a nested list of Tensors to merge. Its rank must be
      greater than or equal to `start` + `size`.

##### Returns:

  The merged Tensor or a nested list of merged Tensors.

##### Raises:


* `ValueError`: If any of the `inputs` tensors has insufficient rank.


#### [`MergeDims.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="MergeDims.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`MergeDims.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="MergeDims.defun" />

Wraps this modules call method in a callable graph function.


#### [`MergeDims.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="MergeDims.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`MergeDims.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="MergeDims.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`MergeDims.get_possible_initializer_keys()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=505)<a id="MergeDims.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`MergeDims.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="MergeDims.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`MergeDims.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="MergeDims.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`MergeDims.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="MergeDims.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`MergeDims.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="MergeDims.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`MergeDims.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="MergeDims.module_name" />

Returns the name of the Module.


#### [`MergeDims.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="MergeDims.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`MergeDims.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="MergeDims.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`MergeDims.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="MergeDims.scope_name" />

Returns the full name of the Module's variable scope.


#### [`MergeDims.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="MergeDims.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`MergeDims.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="MergeDims.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`MergeDims.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="MergeDims.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.



### [`class ModelRNN`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic_rnn.py?q=class:ModelRNN)<a id="ModelRNN" />

RNNCore that ignores input and uses a model to compute its next state.

#### [`ModelRNN.__init__(model, name='model_rnn')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic_rnn.py?l=493)<a id="ModelRNN.__init__" />

Construct a Basic RNN core.

##### Args:


* `model`: callable that computes the next state.
* `name`: name of the module.

##### Raises:


* `TypeError`: if model is not a callable object or if it is an RNNCore.
* `AttributeError`: if model does not have an output_size attribute.


#### [`ModelRNN.__call__(inputs, prev_state)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic_rnn.py?l=518)<a id="ModelRNN.__call__" />

Connects the ModelRNN module into the graph.

If this is not the first time the module has been connected to the graph,
the Tensors provided as input_ and state must have the same final
dimension, in order for the existing variables to be the correct size for
their corresponding multiplications. The batch size may differ for each
connection.

##### Args:


* `inputs`: Tensor input to the ModelRNN (ignored).
* `prev_state`: Tensor of size `model.output_size`.

##### Returns:


* `output`: Tensor of size `model.output_size`.
* `next_state`: Tensor of size `model.output_size`.


#### [`ModelRNN.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="ModelRNN.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`ModelRNN.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="ModelRNN.defun" />

Wraps this modules call method in a callable graph function.


#### [`ModelRNN.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="ModelRNN.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`ModelRNN.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="ModelRNN.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`ModelRNN.get_possible_initializer_keys()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=505)<a id="ModelRNN.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`ModelRNN.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="ModelRNN.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`ModelRNN.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="ModelRNN.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`ModelRNN.initial_state(batch_size, dtype=tf.float32, trainable=False, trainable_initializers=None, trainable_regularizers=None, name=None, **unused_kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/rnn_core.py?l=204)<a id="ModelRNN.initial_state" />

Builds the default start state for an RNNCore.

##### Args:


* `batch_size`: An int, or scalar int32 Tensor representing the batch size.
* `dtype`: The data type to use for the state.
* `trainable`: Boolean that indicates whether to learn the initial state.
    Note that intializers and regularizers will be ignored if
    `trainable=False`.
* `trainable_initializers`: An initializer function or nested structure of
      functions with same structure as the `state_size` property of the
      core, to be used as initializers of the initial state variable.
* `trainable_regularizers`: Optional regularizer function or nested structure
    of functions with the same structure as the `state_size` property of the
    core, to be used as regularizers of the initial state variable. As a
    default, no regularizers are used. A regularizer should be a function
    that takes a single `Tensor` as an input and returns a scalar `Tensor`
    output, e.g. the L1 and L2 regularizers in `tf.contrib.layers`.
* `name`: Optional string used to prefix the initial state variable names, in
      the case of a trainable initial state. If not provided, defaults to
      the name of the module.

##### Returns:

  A tensor or nested tuple of tensors with same structure and shape as the
  `state_size` property of the core.

##### Raises:


* `ValueError`: if the user passes initializers that are not functions.
* `ValueError`: if the user passes regularizers that are not functions.


#### [`ModelRNN.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="ModelRNN.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`ModelRNN.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="ModelRNN.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`ModelRNN.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="ModelRNN.module_name" />

Returns the name of the Module.


#### [`ModelRNN.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="ModelRNN.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`ModelRNN.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="ModelRNN.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`ModelRNN.output_size`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic_rnn.py?l=544)<a id="ModelRNN.output_size" />

Integer or TensorShape: size of outputs produced by this cell.


#### [`ModelRNN.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="ModelRNN.scope_name" />

Returns the full name of the Module's variable scope.


#### [`ModelRNN.state_size`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic_rnn.py?l=540)<a id="ModelRNN.state_size" />

size(s) of state(s) used by this cell.

It can be represented by an Integer, a TensorShape or a tuple of Integers
or TensorShapes.


#### [`ModelRNN.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="ModelRNN.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`ModelRNN.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="ModelRNN.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`ModelRNN.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="ModelRNN.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`ModelRNN.zero_state(batch_size, dtype)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/rnn_core.py?l=260)<a id="ModelRNN.zero_state" />

Return zero-filled state tensor(s).

##### Args:


* `batch_size`: int, float, or unit Tensor representing the batch size.
* `dtype`: the data type to use for the state.

##### Returns:

  If `state_size` is an int or TensorShape, then the return value is a
  `N-D` tensor of shape `[batch_size x state_size]` filled with zeros.

  If `state_size` is a nested list or tuple, then the return value is
  a nested list or tuple (of the same structure) of `2-D` tensors with
  the shapes `[batch_size x s]` for each s in `state_size`.



### [`class Module`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?q=class:Module)<a id="Module" />

Module wrapping a function provided by the user.

#### [`Module.__init__(build, custom_getter=None, name=None)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=768)<a id="Module.__init__" />

Constructs a module with a given build function.

The Module class can be used to wrap a function assembling a network into a
module.

For example, the following code implements a simple one-hidden-layer MLP
model by defining a function called make_model and using a Module instance
to wrap it.

```python
def make_model(inputs):
  lin1 = snt.Linear(name="lin1", output_size=10)(inputs)
  relu1 = tf.nn.relu(lin1, name="relu1")
  lin2 = snt.Linear(name="lin2", output_size=20)(relu1)
  return lin2

model = snt.Module(name='simple_mlp', build=make_model)
outputs = model(inputs)
```

The `partial` package from `functools` can be used to bake configuration
parameters into the function at construction time, as shown in the following
example.

```python
from functools import partial

def make_model(inputs, output_sizes):
  lin1 = snt.Linear(name="lin1", output_size=output_sizes[0])(inputs)
  relu1 = tf.nn.relu(lin1, name="relu1")
  lin2 = snt.Linear(name="lin2", output_size=output_sizes[1])(relu1)
  return lin2

model = snt.Module(name='simple_mlp',
                   build=partial(make_model, output_sizes=[10, 20])
outputs = model(inputs)
```

##### Args:


* `build`: Callable to be invoked when connecting the module to the graph.
      The `build` function is invoked when the module is called, and its
      role is to specify how to add elements to the Graph, and how to
      compute output Tensors from input Tensors.
      The `build` function signature can include the following parameters:
        *args - Input Tensors.
        **kwargs - Additional Python parameters controlling connection.
* `custom_getter`: Callable or dictionary of callables to use as
      custom getters inside the module. If a dictionary, the keys
      correspond to regexes to match variable names. See the
      `tf.get_variable` documentation for information about the
      custom_getter API.
* `name`: Module name. If set to `None` (the default), the name will be set to
      that of the `build` callable converted to `snake_case`. If `build` has
      no name, the name will be 'module'.

##### Raises:


* `TypeError`: If build is not callable.
* `TypeError`: If a given `custom_getter` is not callable.


#### [`Module.__call__(*args, **kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=835)<a id="Module.__call__" />

Forwards call to the passed-in build function.


#### [`Module.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="Module.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`Module.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="Module.defun" />

Wraps this modules call method in a callable graph function.


#### [`Module.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="Module.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`Module.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="Module.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Module.get_possible_initializer_keys()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=505)<a id="Module.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`Module.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="Module.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Module.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="Module.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`Module.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="Module.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`Module.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="Module.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Module.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="Module.module_name" />

Returns the name of the Module.


#### [`Module.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="Module.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`Module.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="Module.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Module.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="Module.scope_name" />

Returns the full name of the Module's variable scope.


#### [`Module.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="Module.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Module.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="Module.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Module.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="Module.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.



### [`class ModuleInfoError`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base_errors.py?q=class:ModuleInfoError)<a id="ModuleInfoError" />

Error raised when Sonnet `ModuleInfo` cannot be serialized.


### [`class MovingAverage`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/moving_average.py?q=class:MovingAverage)<a id="MovingAverage" />

Calculates a differentiable decaying moving average.

The moving average is kept in a variable that can either be local or global.
The initial moving average value is set to the first value that is received
by the module. The module lets gradients flow through the last element added
to the moving average.

#### [`MovingAverage.__init__(decay=0.99, local=False, name='moving_average')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/moving_average.py?l=38)<a id="MovingAverage.__init__" />

Constructor.

##### Args:


* `decay`: float in range [0, 1], decay of the moving average.
* `local`: bool, specifies whether the variables are local or not.
* `name`: string, name of the Sonnet module. Default is 'moving_average'.

##### Raises:


* `ValueError`: if decay is not in the valid range [0, 1].


#### [`MovingAverage.__call__(inputs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/moving_average.py?l=65)<a id="MovingAverage.__call__" />

Returns the moving average of the values that went through `inputs`.

##### Args:


* `inputs`: tensor.

##### Returns:

  A moving average calculated as `(1 - decay) * inputs + decay * average`.


#### [`MovingAverage.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="MovingAverage.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`MovingAverage.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="MovingAverage.defun" />

Wraps this modules call method in a callable graph function.


#### [`MovingAverage.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="MovingAverage.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`MovingAverage.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="MovingAverage.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`MovingAverage.get_possible_initializer_keys()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=505)<a id="MovingAverage.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`MovingAverage.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="MovingAverage.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`MovingAverage.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="MovingAverage.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`MovingAverage.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="MovingAverage.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`MovingAverage.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="MovingAverage.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`MovingAverage.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="MovingAverage.module_name" />

Returns the name of the Module.


#### [`MovingAverage.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="MovingAverage.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`MovingAverage.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="MovingAverage.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`MovingAverage.reset()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/moving_average.py?l=59)<a id="MovingAverage.reset" />




#### [`MovingAverage.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="MovingAverage.scope_name" />

Returns the full name of the Module's variable scope.


#### [`MovingAverage.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="MovingAverage.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`MovingAverage.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="MovingAverage.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`MovingAverage.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="MovingAverage.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.



### [`class NotConnectedError`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base_errors.py?q=class:NotConnectedError)<a id="NotConnectedError" />

Error raised when operating on a module that has not yet been connected.

Some module properties / methods are valid to access before the module has
been connected into the graph, but some are not. This Error is raised when
the user attempts to do anything not valid before connection.


### [`class NotInitializedError`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base_errors.py?q=class:NotInitializedError)<a id="NotInitializedError" />

Error raised when connecting an uninitialized Sonnet module.

Before they can be connected, all Sonnet modules must call
`AbstractModule.__init__` (e.g. via a `super` call).


### [`class NotSupportedError`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base_errors.py?q=class:NotSupportedError)<a id="NotSupportedError" />

Error raised when something that cannot be supported is requested.

For example a Dilated Convolution module cannot be transposed.


### [`class OptimizationConstraints`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/optimization_constraints.py?q=class:OptimizationConstraints)<a id="OptimizationConstraints" />

Container for optimization constraints.

Users can add to an OptimizationConstraints instance multiple inequality
constraints, either implicitly passing inequality ops, such as
`optimization_constraints.add(x < y)`, or explicitly specifying the constraint
type, as in `optimization_constraints.add_geq(x, y)`.
Users can finally add the constraints to the TensorFlow graph calling
`optimization_constraints()`; when doing so, Lagrange multipliers are
automatically added to the graph, so that users can optimize them alongside
other variables in the graph, using the same optimizer and `minimize()`.

Example usage:
```
regularization_loss = model.regularization_loss(data)
reconstruction_error = model.reconstruction_error(data)
avg_reconstruction_error = snt.MovingAverage()(reconstruction_error)
constraints = snt.OptimizationConstraints()
constraints.add(avg_reconstruction_error < reconstruction_threshold)
loss = regularization_loss + constraints()
# The following call actually performs an update step for
# min_{theta} max_{lambda} (
#     regularization_loss(theta) +
#     lambda * (avg_reconstruction_error - reconstruction_threshold))
# where theta are the model parameters and lambda are the Lagrange
# multipliers.
update = optimizer.minimize(loss)
```

#### [`OptimizationConstraints.__init__(rate=1.0, valid_range=None)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/optimization_constraints.py?l=73)<a id="OptimizationConstraints.__init__" />

Instantiates a container for optimization constraints.

##### Args:


* `rate`: optional float, default 1.0. Default factor for Lagrange multiplier
      gradient scaling. Use there `rate` argument to scale the gradients of
      the Lagrange multipliers - note that this parameter has no effect when
      using optimisers such as Adam. This parameter can be overridden
      when adding constraints to the container.
* `valid_range`: optional tuple of length 2, default None. Default valid range
      for Lagrange multipliers. This parameter can be overridden when adding
      constraints to the container.


#### [`OptimizationConstraints.add(expression, rate=None, valid_range=None, initializer=None)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/optimization_constraints.py?l=101)<a id="OptimizationConstraints.add" />

Add inequality constraint whose type depends on analysis of input op.

##### Args:


* `expression`: op of type `Greater`, `GreaterEqual`, `Less` or `LessEqual`.
      Note that `GreaterEqual` and `LessEqual` are accepted only for
      convenience, and will result in the same behavior as `Greater` and
      `Less` respectively.
* `rate`: optional float, default None. Factor for Lagrange multiplier
      gradient scaling. Use there `rate` argument to scale the gradients of
      the Lagrange multipliers - note that this parameter has no effect when
      using optimisers such as Adam. This parameter overrides the defaults
      defined instantiating the container.
* `valid_range`: optional tuple of length 2, default None. Default valid
      range for Lagrange multipliers. This parameter overrides the defaults
      defined instantiating the container.
* `initializer`: optional tensorflow initializer, array or value to be used
      for the Lagrange multiplier initialization. By default Lagrange
      multiplier will be initialized to 1.0.

##### Returns:

  Self.

##### Raises:

  `TypeError`, when input expression op is not one of `Greater`,
  `GreaterEqual`, `Less`, `LessEqual`.


#### [`OptimizationConstraints.add_geq(lhs, rhs=0.0, rate=None, valid_range=None, initializer=None)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/optimization_constraints.py?l=179)<a id="OptimizationConstraints.add_geq" />

Add a 'greater than' inequality constraint.

##### Args:


* `lhs`: left hand argument of inequality expression.
* `rhs`: reft hand argument of inequality expression, defaults to 0.0.
* `rate`: optional float, default None. Factor for Lagrange multiplier
      gradient scaling. Use there `rate` argument to scale the gradients of
      the Lagrange multipliers - note that this parameter has no effect when
      using optimisers such as Adam. This parameter overrides the defaults
      defined instantiating the container.
* `valid_range`: optional tuple of length 2, default None. Default valid
      range for Lagrange multipliers. This parameter overrides the defaults
      defined instantiating the container.
* `initializer`: optional tensorflow initializer, array or value to be used
      for the Lagrange multiplier initialization. By default Lagrange
      multiplier will be initialized to 1.0.

##### Returns:

  Self.


#### [`OptimizationConstraints.add_leq(lhs, rhs=0.0, rate=None, valid_range=None, initializer=None)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/optimization_constraints.py?l=144)<a id="OptimizationConstraints.add_leq" />

Add a 'less than' inequality constraint.

##### Args:


* `lhs`: left hand argument of inequality expression.
* `rhs`: reft hand argument of inequality expression, defaults to 0.0.
* `rate`: optional float, default None. Factor for Lagrange multiplier
      gradient scaling. Use there `rate` argument to scale the gradients of
      the Lagrange multipliers - note that this parameter has no effect when
      using optimisers such as Adam. This parameter overrides the defaults
      defined instantiating the container.
* `valid_range`: optional tuple of length 2, default None. Default valid
      range for Lagrange multipliers. This parameter overrides the defaults
      defined instantiating the container.
* `initializer`: optional tensorflow initializer, array or value to be used
      for the Lagrange multiplier initialization. By default Lagrange
      multiplier will be initialized to 1.0.

##### Returns:

  Self.


#### [`OptimizationConstraints.constraints`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/optimization_constraints.py?l=93)<a id="OptimizationConstraints.constraints" />




#### [`OptimizationConstraints.lagrange_multipliers`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/optimization_constraints.py?l=97)<a id="OptimizationConstraints.lagrange_multipliers" />





### [`class ParentNotBuiltError`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base_errors.py?q=class:ParentNotBuiltError)<a id="ParentNotBuiltError" />

Error raised when the parent of a module has not been built yet.

For example, when making a transpose of modules that inherit from
`module.Transposable`, the parent has to be connected to the graph before the
child transpose to ensure that shape inference has already occurred.


### [`class RNNCellWrapper`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/rnn_core.py?q=class:RNNCellWrapper)<a id="RNNCellWrapper" />

RNN core that delegates to a `tf.contrib.rnn.RNNCell`.

#### [`RNNCellWrapper.__init__(cell_ctor, *args, **kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/rnn_core.py?l=356)<a id="RNNCellWrapper.__init__" />

Constructs the cell, within this module's variable scope.

##### Args:


* `cell_ctor`: Callable that instantiates a `tf.contrib.rnn.RNNCell`.
* `*args`: Arguments to pass to `cell_ctor`.
* `**kwargs`: Keyword arguments to pass to `cell_ctor`.
    If `name` is provided, it is passed to `RNNCore.__init__` as well.
    If `custom_getter` is provided, it is passed to `RNNCore.__init__`
    but not to `cell_ctor`.


#### [`RNNCellWrapper.__call__(inputs, prev_state)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/rnn_core.py?l=374)<a id="RNNCellWrapper.__call__" />

Add elements to the Graph, computing output Tensors from input Tensors.

Subclasses must implement this method, which will be wrapped in a Template.

##### Args:


* `*args`: Input Tensors.
* `**kwargs`: Additional Python flags controlling connection.

##### Returns:

  output Tensor(s).


#### [`RNNCellWrapper.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="RNNCellWrapper.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`RNNCellWrapper.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="RNNCellWrapper.defun" />

Wraps this modules call method in a callable graph function.


#### [`RNNCellWrapper.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="RNNCellWrapper.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`RNNCellWrapper.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="RNNCellWrapper.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`RNNCellWrapper.get_possible_initializer_keys()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=505)<a id="RNNCellWrapper.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`RNNCellWrapper.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="RNNCellWrapper.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`RNNCellWrapper.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="RNNCellWrapper.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`RNNCellWrapper.initial_state(batch_size, dtype=tf.float32, trainable=False, trainable_initializers=None, trainable_regularizers=None, name=None, **unused_kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/rnn_core.py?l=204)<a id="RNNCellWrapper.initial_state" />

Builds the default start state for an RNNCore.

##### Args:


* `batch_size`: An int, or scalar int32 Tensor representing the batch size.
* `dtype`: The data type to use for the state.
* `trainable`: Boolean that indicates whether to learn the initial state.
    Note that intializers and regularizers will be ignored if
    `trainable=False`.
* `trainable_initializers`: An initializer function or nested structure of
      functions with same structure as the `state_size` property of the
      core, to be used as initializers of the initial state variable.
* `trainable_regularizers`: Optional regularizer function or nested structure
    of functions with the same structure as the `state_size` property of the
    core, to be used as regularizers of the initial state variable. As a
    default, no regularizers are used. A regularizer should be a function
    that takes a single `Tensor` as an input and returns a scalar `Tensor`
    output, e.g. the L1 and L2 regularizers in `tf.contrib.layers`.
* `name`: Optional string used to prefix the initial state variable names, in
      the case of a trainable initial state. If not provided, defaults to
      the name of the module.

##### Returns:

  A tensor or nested tuple of tensors with same structure and shape as the
  `state_size` property of the core.

##### Raises:


* `ValueError`: if the user passes initializers that are not functions.
* `ValueError`: if the user passes regularizers that are not functions.


#### [`RNNCellWrapper.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="RNNCellWrapper.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`RNNCellWrapper.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="RNNCellWrapper.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`RNNCellWrapper.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="RNNCellWrapper.module_name" />

Returns the name of the Module.


#### [`RNNCellWrapper.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="RNNCellWrapper.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`RNNCellWrapper.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="RNNCellWrapper.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`RNNCellWrapper.output_size`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/rnn_core.py?l=377)<a id="RNNCellWrapper.output_size" />

Integer or TensorShape: size of outputs produced by this cell.


#### [`RNNCellWrapper.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="RNNCellWrapper.scope_name" />

Returns the full name of the Module's variable scope.


#### [`RNNCellWrapper.state_size`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/rnn_core.py?l=381)<a id="RNNCellWrapper.state_size" />

size(s) of state(s) used by this cell.

It can be represented by an Integer, a TensorShape or a tuple of Integers
or TensorShapes.


#### [`RNNCellWrapper.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="RNNCellWrapper.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`RNNCellWrapper.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="RNNCellWrapper.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`RNNCellWrapper.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="RNNCellWrapper.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`RNNCellWrapper.zero_state(batch_size, dtype)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/rnn_core.py?l=260)<a id="RNNCellWrapper.zero_state" />

Return zero-filled state tensor(s).

##### Args:


* `batch_size`: int, float, or unit Tensor representing the batch size.
* `dtype`: the data type to use for the state.

##### Returns:

  If `state_size` is an int or TensorShape, then the return value is a
  `N-D` tensor of shape `[batch_size x state_size]` filled with zeros.

  If `state_size` is a nested list or tuple, then the return value is
  a nested list or tuple (of the same structure) of `2-D` tensors with
  the shapes `[batch_size x s]` for each s in `state_size`.



### [`class RNNCore`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/rnn_core.py?q=class:RNNCore)<a id="RNNCore" />

Superclass for Recurrent Neural Network Cores.

This class defines the basic functionality that every core should implement,
mainly the `initial_state` method which will return an example of their
initial state.
It also inherits from the interface `snt.AbstractModule`.

As with any other `snt.Module` any subclass must implement a `_build` method
that constructs the graph that corresponds to a core. Such a `_build` method
should always have the same interface, which is the following:

    output, next_state = self._build(input, prev_state)

where output, next_state, input, and prev_state are arbitrarily nested
tensors. Such structures can be defined according to the following
grammar:

    element = tuple(element*) | list(element*) | tf.Tensor

This class is to be used with tensorflow containers such as `rnn` in
tensorflow.python.ops.rnn.
These containers only accept inputs which are compatible with the
`tf.contrib.rnn.RNNCell` API, so that all the RNNCores should expose
`state_size` and `output_size` properties.

#### [`RNNCore.__init__(_sentinel=None, custom_getter=None, name=None)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=127)<a id="RNNCore.__init__" />

Performs the initialisation necessary for all AbstractModule instances.

Every subclass of AbstractModule must begin their constructor with a call to
this constructor, i.e.

`super(MySubModule, self).__init__(custom_getter=custom_getter, name=name)`.

If you instantiate sub-modules in __init__ you must create them within the
`_enter_variable_scope` context manager to ensure they are in the module's
variable scope. Alternatively, instantiate sub-modules in `_build`.

##### Args:

  _sentinel: Variable that only carries a non-None value if `__init__` was
      called without named parameters. If this is the case, a deprecation
      warning is issued in form of a `ValueError`.

* `custom_getter`: Callable or dictionary of callables to use as
    custom getters inside the module. If a dictionary, the keys
    correspond to regexes to match variable names. See the `tf.get_variable`
    documentation for information about the custom_getter API.
* `name`: Name of this module. Used to construct the Templated build function.
      If `None` the module's class name is used (converted to snake case).

##### Raises:


* `TypeError`: If `name` is not a string.
* `TypeError`: If a given `custom_getter` is not callable.
* `ValueError`: If `__init__` was called without named arguments.


#### [`RNNCore.__call__(*args, **kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=296)<a id="RNNCore.__call__" />

Add elements to the Graph, computing output Tensors from input Tensors.

Subclasses must implement this method, which will be wrapped in a Template.

##### Args:


* `*args`: Input Tensors.
* `**kwargs`: Additional Python flags controlling connection.

##### Returns:

  output Tensor(s).


#### [`RNNCore.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="RNNCore.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`RNNCore.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="RNNCore.defun" />

Wraps this modules call method in a callable graph function.


#### [`RNNCore.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="RNNCore.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`RNNCore.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="RNNCore.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`RNNCore.get_possible_initializer_keys()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=505)<a id="RNNCore.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`RNNCore.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="RNNCore.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`RNNCore.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="RNNCore.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`RNNCore.initial_state(batch_size, dtype=tf.float32, trainable=False, trainable_initializers=None, trainable_regularizers=None, name=None, **unused_kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/rnn_core.py?l=204)<a id="RNNCore.initial_state" />

Builds the default start state for an RNNCore.

##### Args:


* `batch_size`: An int, or scalar int32 Tensor representing the batch size.
* `dtype`: The data type to use for the state.
* `trainable`: Boolean that indicates whether to learn the initial state.
    Note that intializers and regularizers will be ignored if
    `trainable=False`.
* `trainable_initializers`: An initializer function or nested structure of
      functions with same structure as the `state_size` property of the
      core, to be used as initializers of the initial state variable.
* `trainable_regularizers`: Optional regularizer function or nested structure
    of functions with the same structure as the `state_size` property of the
    core, to be used as regularizers of the initial state variable. As a
    default, no regularizers are used. A regularizer should be a function
    that takes a single `Tensor` as an input and returns a scalar `Tensor`
    output, e.g. the L1 and L2 regularizers in `tf.contrib.layers`.
* `name`: Optional string used to prefix the initial state variable names, in
      the case of a trainable initial state. If not provided, defaults to
      the name of the module.

##### Returns:

  A tensor or nested tuple of tensors with same structure and shape as the
  `state_size` property of the core.

##### Raises:


* `ValueError`: if the user passes initializers that are not functions.
* `ValueError`: if the user passes regularizers that are not functions.


#### [`RNNCore.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="RNNCore.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`RNNCore.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="RNNCore.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`RNNCore.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="RNNCore.module_name" />

Returns the name of the Module.


#### [`RNNCore.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="RNNCore.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`RNNCore.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="RNNCore.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`RNNCore.output_size`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/rnn_core.py?l=255)<a id="RNNCore.output_size" />

Integer or TensorShape: size of outputs produced by this cell.


#### [`RNNCore.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="RNNCore.scope_name" />

Returns the full name of the Module's variable scope.


#### [`RNNCore.state_size`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/rnn_core.py?l=246)<a id="RNNCore.state_size" />

size(s) of state(s) used by this cell.

It can be represented by an Integer, a TensorShape or a tuple of Integers
or TensorShapes.


#### [`RNNCore.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="RNNCore.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`RNNCore.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="RNNCore.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`RNNCore.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="RNNCore.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`RNNCore.zero_state(batch_size, dtype)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/rnn_core.py?l=260)<a id="RNNCore.zero_state" />

Return zero-filled state tensor(s).

##### Args:


* `batch_size`: int, float, or unit Tensor representing the batch size.
* `dtype`: the data type to use for the state.

##### Returns:

  If `state_size` is an int or TensorShape, then the return value is a
  `N-D` tensor of shape `[batch_size x state_size]` filled with zeros.

  If `state_size` is a nested list or tuple, then the return value is
  a nested list or tuple (of the same structure) of `2-D` tensors with
  the shapes `[batch_size x s]` for each s in `state_size`.



### [`class RelationalMemory`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/relational_memory.py?q=class:RelationalMemory)<a id="RelationalMemory" />

Relational Memory Core.

#### [`RelationalMemory.__init__(mem_slots, head_size, num_heads=1, num_blocks=1, forget_bias=1.0, input_bias=0.0, gate_style='unit', attention_mlp_layers=2, key_size=None, name='relational_memory')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/relational_memory.py?l=36)<a id="RelationalMemory.__init__" />

Constructs a `RelationalMemory` object.

##### Args:


* `mem_slots`: The total number of memory slots to use.
* `head_size`: The size of an attention head.
* `num_heads`: The number of attention heads to use. Defaults to 1.
* `num_blocks`: Number of times to compute attention per time step. Defaults
    to 1.
* `forget_bias`: Bias to use for the forget gate, assuming we are using
    some form of gating. Defaults to 1.
* `input_bias`: Bias to use for the input gate, assuming we are using
    some form of gating. Defaults to 0.
* `gate_style`: Whether to use per-element gating ('unit'),
    per-memory slot gating ('memory'), or no gating at all (None).
    Defaults to `unit`.
* `attention_mlp_layers`: Number of layers to use in the post-attention
    MLP. Defaults to 2.
* `key_size`: Size of vector to use for key & query vectors in the attention
    computation. Defaults to None, in which case we use `head_size`.
* `name`: Name of the module.

##### Raises:


* `ValueError`: gate_style not one of [None, 'memory', 'unit'].
* `ValueError`: num_blocks is < 1.
* `ValueError`: attention_mlp_layers is < 1.


#### [`RelationalMemory.__call__(inputs, memory, treat_input_as_matrix=False)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/relational_memory.py?l=236)<a id="RelationalMemory.__call__" />

Adds relational memory to the TensorFlow graph.

##### Args:


* `inputs`: Tensor input.
* `memory`: Memory output from the previous time step.
* `treat_input_as_matrix`: Optional, whether to treat `input` as a sequence
    of matrices. Defaulta to False, in which case the input is flattened
    into a vector.

##### Returns:


* `output`: This time step's output.
* `next_memory`: The next version of memory to use.


#### [`RelationalMemory.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="RelationalMemory.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`RelationalMemory.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="RelationalMemory.defun" />

Wraps this modules call method in a callable graph function.


#### [`RelationalMemory.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="RelationalMemory.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`RelationalMemory.forget_gate`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/relational_memory.py?l=280)<a id="RelationalMemory.forget_gate" />

Returns the forget gate Tensor.


#### [`RelationalMemory.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="RelationalMemory.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`RelationalMemory.get_possible_initializer_keys()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=505)<a id="RelationalMemory.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`RelationalMemory.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="RelationalMemory.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`RelationalMemory.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="RelationalMemory.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`RelationalMemory.initial_state(batch_size, trainable=False)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/relational_memory.py?l=92)<a id="RelationalMemory.initial_state" />

Creates the initial memory.

We should ensure each row of the memory is initialized to be unique,
so initialize the matrix to be the identity. We then pad or truncate
as necessary so that init_state is of size
(batch_size, self._mem_slots, self._mem_size).

##### Args:


* `batch_size`: The size of the batch.
* `trainable`: Whether the initial state is trainable. This is always True.

##### Returns:


* `init_state`: A truncated or padded matrix of size
    (batch_size, self._mem_slots, self._mem_size).


#### [`RelationalMemory.input_gate`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/relational_memory.py?l=274)<a id="RelationalMemory.input_gate" />

Returns the input gate Tensor.


#### [`RelationalMemory.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="RelationalMemory.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`RelationalMemory.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="RelationalMemory.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`RelationalMemory.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="RelationalMemory.module_name" />

Returns the name of the Module.


#### [`RelationalMemory.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="RelationalMemory.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`RelationalMemory.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="RelationalMemory.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`RelationalMemory.output_size`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/relational_memory.py?l=167)<a id="RelationalMemory.output_size" />

Integer or TensorShape: size of outputs produced by this cell.


#### [`RelationalMemory.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="RelationalMemory.scope_name" />

Returns the full name of the Module's variable scope.


#### [`RelationalMemory.state_size`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/relational_memory.py?l=163)<a id="RelationalMemory.state_size" />

size(s) of state(s) used by this cell.

It can be represented by an Integer, a TensorShape or a tuple of Integers
or TensorShapes.


#### [`RelationalMemory.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="RelationalMemory.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`RelationalMemory.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="RelationalMemory.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`RelationalMemory.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="RelationalMemory.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`RelationalMemory.zero_state(batch_size, dtype)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/rnn_core.py?l=260)<a id="RelationalMemory.zero_state" />

Return zero-filled state tensor(s).

##### Args:


* `batch_size`: int, float, or unit Tensor representing the batch size.
* `dtype`: the data type to use for the state.

##### Returns:

  If `state_size` is an int or TensorShape, then the return value is a
  `N-D` tensor of shape `[batch_size x state_size]` filled with zeros.

  If `state_size` is a nested list or tuple, then the return value is
  a nested list or tuple (of the same structure) of `2-D` tensors with
  the shapes `[batch_size x s]` for each s in `state_size`.



### [`class Residual`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/residual.py?q=class:Residual)<a id="Residual" />

Adds a residual connection to a base module.

This module wraps a module M, where if M with traditionally output M(X),
Residual(M)(x) = M(x) + x.

#### [`Residual.__init__(base_module, name='residual')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/residual.py?l=37)<a id="Residual.__init__" />

Performs the initialisation necessary for all AbstractModule instances.

Every subclass of AbstractModule must begin their constructor with a call to
this constructor, i.e.

`super(MySubModule, self).__init__(custom_getter=custom_getter, name=name)`.

If you instantiate sub-modules in __init__ you must create them within the
`_enter_variable_scope` context manager to ensure they are in the module's
variable scope. Alternatively, instantiate sub-modules in `_build`.

##### Args:

  _sentinel: Variable that only carries a non-None value if `__init__` was
      called without named parameters. If this is the case, a deprecation
      warning is issued in form of a `ValueError`.

* `custom_getter`: Callable or dictionary of callables to use as
    custom getters inside the module. If a dictionary, the keys
    correspond to regexes to match variable names. See the `tf.get_variable`
    documentation for information about the custom_getter API.
* `name`: Name of this module. Used to construct the Templated build function.
      If `None` the module's class name is used (converted to snake case).

##### Raises:


* `TypeError`: If `name` is not a string.
* `TypeError`: If a given `custom_getter` is not callable.
* `ValueError`: If `__init__` was called without named arguments.


#### [`Residual.__call__(inputs, **kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/residual.py?l=42)<a id="Residual.__call__" />

Add elements to the Graph, computing output Tensors from input Tensors.

Subclasses must implement this method, which will be wrapped in a Template.

##### Args:


* `*args`: Input Tensors.
* `**kwargs`: Additional Python flags controlling connection.

##### Returns:

  output Tensor(s).


#### [`Residual.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="Residual.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`Residual.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="Residual.defun" />

Wraps this modules call method in a callable graph function.


#### [`Residual.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="Residual.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`Residual.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="Residual.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Residual.get_possible_initializer_keys()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=505)<a id="Residual.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`Residual.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="Residual.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Residual.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="Residual.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`Residual.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="Residual.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`Residual.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="Residual.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Residual.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="Residual.module_name" />

Returns the name of the Module.


#### [`Residual.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="Residual.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`Residual.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="Residual.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Residual.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="Residual.scope_name" />

Returns the full name of the Module's variable scope.


#### [`Residual.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="Residual.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Residual.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="Residual.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Residual.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="Residual.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.



### [`class ResidualCore`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/residual.py?q=class:ResidualCore)<a id="ResidualCore" />

Adds a residual connection to a base RNN core.

This module wraps a module M, where if M with traditionally output M(X),
Residual(M)(x) = M(x) + x.

#### [`ResidualCore.__init__(base_core, name='residual_core')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/residual.py?l=55)<a id="ResidualCore.__init__" />

Performs the initialisation necessary for all AbstractModule instances.

Every subclass of AbstractModule must begin their constructor with a call to
this constructor, i.e.

`super(MySubModule, self).__init__(custom_getter=custom_getter, name=name)`.

If you instantiate sub-modules in __init__ you must create them within the
`_enter_variable_scope` context manager to ensure they are in the module's
variable scope. Alternatively, instantiate sub-modules in `_build`.

##### Args:

  _sentinel: Variable that only carries a non-None value if `__init__` was
      called without named parameters. If this is the case, a deprecation
      warning is issued in form of a `ValueError`.

* `custom_getter`: Callable or dictionary of callables to use as
    custom getters inside the module. If a dictionary, the keys
    correspond to regexes to match variable names. See the `tf.get_variable`
    documentation for information about the custom_getter API.
* `name`: Name of this module. Used to construct the Templated build function.
      If `None` the module's class name is used (converted to snake case).

##### Raises:


* `TypeError`: If `name` is not a string.
* `TypeError`: If a given `custom_getter` is not callable.
* `ValueError`: If `__init__` was called without named arguments.


#### [`ResidualCore.__call__(inputs, prev_state, **kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/residual.py?l=59)<a id="ResidualCore.__call__" />

Add elements to the Graph, computing output Tensors from input Tensors.

Subclasses must implement this method, which will be wrapped in a Template.

##### Args:


* `*args`: Input Tensors.
* `**kwargs`: Additional Python flags controlling connection.

##### Returns:

  output Tensor(s).


#### [`ResidualCore.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="ResidualCore.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`ResidualCore.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="ResidualCore.defun" />

Wraps this modules call method in a callable graph function.


#### [`ResidualCore.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="ResidualCore.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`ResidualCore.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="ResidualCore.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`ResidualCore.get_possible_initializer_keys()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=505)<a id="ResidualCore.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`ResidualCore.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="ResidualCore.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`ResidualCore.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="ResidualCore.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`ResidualCore.initial_state(*args, **kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/residual.py?l=72)<a id="ResidualCore.initial_state" />

Builds the default start state for an RNNCore.

##### Args:


* `batch_size`: An int, or scalar int32 Tensor representing the batch size.
* `dtype`: The data type to use for the state.
* `trainable`: Boolean that indicates whether to learn the initial state.
    Note that intializers and regularizers will be ignored if
    `trainable=False`.
* `trainable_initializers`: An initializer function or nested structure of
      functions with same structure as the `state_size` property of the
      core, to be used as initializers of the initial state variable.
* `trainable_regularizers`: Optional regularizer function or nested structure
    of functions with the same structure as the `state_size` property of the
    core, to be used as regularizers of the initial state variable. As a
    default, no regularizers are used. A regularizer should be a function
    that takes a single `Tensor` as an input and returns a scalar `Tensor`
    output, e.g. the L1 and L2 regularizers in `tf.contrib.layers`.
* `name`: Optional string used to prefix the initial state variable names, in
      the case of a trainable initial state. If not provided, defaults to
      the name of the module.

##### Returns:

  A tensor or nested tuple of tensors with same structure and shape as the
  `state_size` property of the core.

##### Raises:


* `ValueError`: if the user passes initializers that are not functions.
* `ValueError`: if the user passes regularizers that are not functions.


#### [`ResidualCore.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="ResidualCore.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`ResidualCore.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="ResidualCore.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`ResidualCore.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="ResidualCore.module_name" />

Returns the name of the Module.


#### [`ResidualCore.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="ResidualCore.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`ResidualCore.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="ResidualCore.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`ResidualCore.output_size`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/residual.py?l=64)<a id="ResidualCore.output_size" />

Integer or TensorShape: size of outputs produced by this cell.


#### [`ResidualCore.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="ResidualCore.scope_name" />

Returns the full name of the Module's variable scope.


#### [`ResidualCore.state_size`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/residual.py?l=68)<a id="ResidualCore.state_size" />

size(s) of state(s) used by this cell.

It can be represented by an Integer, a TensorShape or a tuple of Integers
or TensorShapes.


#### [`ResidualCore.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="ResidualCore.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`ResidualCore.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="ResidualCore.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`ResidualCore.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="ResidualCore.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`ResidualCore.zero_state(*args, **kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/residual.py?l=75)<a id="ResidualCore.zero_state" />

Return zero-filled state tensor(s).

##### Args:


* `batch_size`: int, float, or unit Tensor representing the batch size.
* `dtype`: the data type to use for the state.

##### Returns:

  If `state_size` is an int or TensorShape, then the return value is a
  `N-D` tensor of shape `[batch_size x state_size]` filled with zeros.

  If `state_size` is a nested list or tuple, then the return value is
  a nested list or tuple (of the same structure) of `2-D` tensors with
  the shapes `[batch_size x s]` for each s in `state_size`.



### [`class SelectInput`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?q=class:SelectInput)<a id="SelectInput" />

Returns a subset of its inputs in an arbitrarily nested configuration.

This module can be used for multiple purposes.

The basic usage is to select a tensor or a subset of tensors:

```
output = snt.SelectInput(idx=0, name='select')(input0, input1)
==> input0

output = snt.SelectInput(idx=[0, 2], name='select')(input0, input1, input2)
==> (input0, input2)
```

Another usage is to change the orders of the input tensors:

```
output = snt.SelectInput(idx=[1, 0], name='select')(input0, input1)
==> (input1, input0)
```

Another usage is to duplicate an input:

```
output = snt.SelectInput(idx=[0, 0], name='select')(input0)
==> (input0, input0)
```

Another usage is to add arbitrary nesting:

```
output = snt.SelectInput(
    idx=[0, [1, [2]]], name='select')(input0, input1, input2)
==> (input0, (input1, (input2,)))
```

#### [`SelectInput.__init__(idx, name='select_input')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?l=1444)<a id="SelectInput.__init__" />

Module constructor.

##### Args:


* `idx`: Indexes of the tensors to select. If `idx` is an integer, then
      a `Tensor` is returned. If `idx` is a (nested) list/tuple, then a
      (nested) tuple of `Tensor` is returned.
* `name`: Name of the module.

##### Raises:


* `TypeError`: If `idx` is not an list, tuple or integer.


#### [`SelectInput.__call__(*inputs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?l=1478)<a id="SelectInput.__call__" />

Connects the module into the graph.

##### Args:


* `*inputs`: `Tensor` variables to select.

##### Returns:

  Subset of `inputs` in an arbitrarily nested configuration.

##### Raises:


* `ValueError`: If any entry of `idx` is out of bounds with respect to the
      size of `inputs`.


#### [`SelectInput.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="SelectInput.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`SelectInput.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="SelectInput.defun" />

Wraps this modules call method in a callable graph function.


#### [`SelectInput.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="SelectInput.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`SelectInput.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="SelectInput.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`SelectInput.get_possible_initializer_keys()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=505)<a id="SelectInput.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`SelectInput.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="SelectInput.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`SelectInput.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="SelectInput.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`SelectInput.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="SelectInput.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`SelectInput.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="SelectInput.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`SelectInput.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="SelectInput.module_name" />

Returns the name of the Module.


#### [`SelectInput.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="SelectInput.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`SelectInput.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="SelectInput.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`SelectInput.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="SelectInput.scope_name" />

Returns the full name of the Module's variable scope.


#### [`SelectInput.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="SelectInput.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`SelectInput.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="SelectInput.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`SelectInput.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="SelectInput.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.



### [`class SeparableConv1D`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?q=class:SeparableConv1D)<a id="SeparableConv1D" />

Performs an in-plane convolution to each channel independently.

This acts as a light wrapper around the TensorFlow op
`tf.nn.separable_conv2d`, abstracting away variable creation and sharing.

#### [`SeparableConv1D.__init__(output_channels, channel_multiplier, kernel_shape, stride=1, rate=1, padding='SAME', use_bias=True, initializers=None, partitioners=None, regularizers=None, data_format='NWC', padding_value='CONSTANT', custom_getter=None, name='separable_conv1d')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=2809)<a id="SeparableConv1D.__init__" />

Constructs a SeparableConv1D module.

See the following documentation for an explanation of VALID versus SAME
padding modes:
https://www.tensorflow.org/api_docs/python/tf/nn/convolution

##### Args:


* `output_channels`: Number of output channels. Must be an integer.
* `channel_multiplier`: Number of channels to expand pointwise (depthwise)
      convolution to. Must be an integer. Must be > 0.
      When `channel_multiplier` is set to 1, applies a different filter to
      each input channel. Numbers larger than 1 cause the filter to be
      applied to `channel_multiplier` input channels. Outputs are
      concatenated together.
* `kernel_shape`: List with 2 elements in the following layout:
      [filter_height, filter_width] or integer that is
      used to define the list in all dimensions.
* `stride`: List with 4 elements of kernel strides, or integer that is used to
      define stride in all dimensions. Layout of list:
      [1, stride_y, stride_x, 1].
* `rate`: Sequence of dilation rates (of size 1), or integer that is used to
      define dilation rate in all dimensions. 1 corresponds to standard 1D
      convolution, `rate > 1` corresponds to dilated convolution. Cannot be
      > 1 if any of `stride` is also > 1.
* `padding`: Padding algorithm. Either `snt.SAME`, `snt.VALID`, `snt.FULL`,
      `snt.CAUSAL`, `snt.REVERSE_CAUSAL`, or a sequence of these paddings
      of length 1.
      * snt.SAME and snt.VALID are explained in the Tensorflow docs at
        https://www.tensorflow.org/api_docs/python/tf/nn/convolution.
      * snt.FULL pre- and post-pads with the maximum padding which does not
        result in a convolution over just padded elements.
      * snt.CAUSAL pre-pads to ensure that each output value only depends on
        input values at the same or preceding indices ("no dependence on the
        future").
      * snt.REVERSE_CAUSAL post-pads to ensure that each output value only
        depends on input values at the same or *greater* indices ("no
        dependence on the past").
      If you use the same padding for all dimensions, and it is one of SAME
      or VALID, then this is supported directly by the underlying
      convolution op. In all other cases, the input data will be padded
      using tf.pad before calling the convolution op.
* `use_bias`: Whether to include bias parameters. Default `True`.
* `initializers`: Optional dict containing ops to initialize the filters (with
      keys 'w_dw' for depthwise and 'w_pw' for pointwise) or biases
      (with key 'b').
* `partitioners`: Optional dict containing partitioners to partition the
      filters (with key 'w') or biases (with key 'b'). As a default, no
      partitioners are used.
* `regularizers`: Optional dict containing regularizers for the filters
      (with keys 'w_dw' for depthwise and 'w_pw' for pointwise) and the
      biases (with key 'b'). As a default, no regularizers are used.
      A regularizer should be a function that takes a single `Tensor` as an
      input and returns a scalar `Tensor` output, e.g. the L1 and L2
      regularizers in `tf.contrib.layers`.
* `data_format`: A string. Specifies whether the channel dimension
      of the input and output is the last dimension (default, NWC), or the
      second dimension ("NCW").
* `padding_value`: The type of padding to use, either "CONSTANT", "SYMMETRIC"
      or "REFLECT", as supported by the underlying tf.pad
      (https://www.tensorflow.org/api_docs/python/tf/pad). Can only be set
      globally for all dimensions. Defaults to "CONSTANT" which will pad
      with zeros, potentially directly via the underlying convolution op if
      the padding is SAME for all dimensions.
* `custom_getter`: Callable or dictionary of callables to use as
      custom getters inside the module. If a dictionary, the keys
      correspond to regexes to match variable names. See the
      `tf.get_variable` documentation for information about the
      custom_getter API.
* `name`: Name of the module.

##### Raises:


* `ValueError`: If `channel_multiplier` isn't of type (`numbers.Integral` or
      `tf.Dimension`).
* `ValueError`: If `channel_multiplier` is less than 1.
* `ValueError`: If the given data_format is not a supported format (see
      `SUPPORTED_1D_DATA_FORMATS`).
  base.IncompatibleShapeError: If the given kernel shape is not an integer;
      or if the given kernel shape is not a sequence of one integer.
  base.IncompatibleShapeError: If the given stride is not an integer; or if
      the given stride is not a sequence of two integers.
  base.IncompatibleShapeError: If the given rate is not an integer; or if
      the given rate is not a sequence of two integers.
  base.IncompatibleShapeError: If a mask is a TensorFlow Tensor with
      a not fully defined shape.
  base.NotSupportedError: If rate in any dimension and the stride in any
      dimension are simultaneously > 1.

* `ValueError`: If the given padding is not `snt.VALID`, `snt.SAME`,
      `snt.FULL`, `snt.CAUSAL`, `snt.REVERSE_CAUSAL` or a sequence of these.
* `KeyError`: If `initializers`, `partitioners` or `regularizers` contain any
      keys other than 'w_dw', 'w_pw' or 'b'.
* `TypeError`: If any of the given initializers, partitioners or regularizers
      are not callable.
* `TypeError`: If mask is given and it is not convertible to a Tensor.
* `ValueError`: If the passed-in data_format doesn't have a channel dimension.


#### [`SeparableConv1D.__call__(inputs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=556)<a id="SeparableConv1D.__call__" />

Connects the _ConvND module into the graph, with input Tensor `inputs`.

If this is not the first time the module has been connected to the graph,
the input Tensor provided here must have the same number of channels, in
order for the existing variables to be the correct size for the
multiplication; the batch size and input spatial dimensions may differ for
each connection.

##### Args:


* `inputs`: A ND Tensor of the same rank as `data_format`, and either of types
  `tf.float16`, `tf.bfloat16`, `tf.float32` or `tf.float64`.

##### Returns:

  A ND Tensor of shape [batch_size, output_dim_1, output_dim_2, ...,
      output_channels].

##### Raises:


* `ValueError`: If connecting the module into the graph any time after the
      first time and the inferred size of the input does not match previous
      invocations.
  base.IncompatibleShapeError: If the input tensor has the wrong number
      of dimensions.
  base.UnderspecifiedError: If the channel dimension of `inputs` isn't
      defined.
  base.IncompatibleShapeError: If a mask is present and its shape is
      incompatible with the shape of the weights.

* `TypeError`: If input Tensor dtype is not compatible with either
      `tf.float16`, `tf.bfloat16`, `tf.float32` or `tf.float64`.


#### [`SeparableConv1D.b`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=814)<a id="SeparableConv1D.b" />

Returns the Variable containing the bias.

##### Returns:

  Variable object containing the bias, from the most recent __call__.

##### Raises:

  base.NotConnectedError: If the module has not been connected to the graph
      yet, meaning the variables do not exist.

* `AttributeError`: If the module does not use bias.


#### [`SeparableConv1D.channel_multiplier`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=3031)<a id="SeparableConv1D.channel_multiplier" />

Returns the channel multiplier argument.


#### [`SeparableConv1D.clone(name=None)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=876)<a id="SeparableConv1D.clone" />

Returns a cloned `_ConvND` module.

##### Args:


* `name`: Optional string assigning name of cloned module. The default name
    is constructed by appending "_clone" to `self.module_name`.

##### Returns:

  A copy of the current class.


#### [`SeparableConv1D.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="SeparableConv1D.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`SeparableConv1D.conv_op_padding`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=803)<a id="SeparableConv1D.conv_op_padding" />

Returns the padding algorithm used for the underlying convolution op.


#### [`SeparableConv1D.data_format`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=857)<a id="SeparableConv1D.data_format" />

Returns the data format.


#### [`SeparableConv1D.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="SeparableConv1D.defun" />

Wraps this modules call method in a callable graph function.


#### [`SeparableConv1D.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="SeparableConv1D.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`SeparableConv1D.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="SeparableConv1D.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`SeparableConv1D.get_possible_initializer_keys(use_bias=True)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=2942)<a id="SeparableConv1D.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`SeparableConv1D.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="SeparableConv1D.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`SeparableConv1D.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="SeparableConv1D.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`SeparableConv1D.has_bias`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=832)<a id="SeparableConv1D.has_bias" />

Returns `True` if bias Variable is present in the module.


#### [`SeparableConv1D.initializers`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=837)<a id="SeparableConv1D.initializers" />

Returns the initializers dictionary.


#### [`SeparableConv1D.input_channels`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=869)<a id="SeparableConv1D.input_channels" />

Returns the number of input channels.


#### [`SeparableConv1D.input_shape`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=863)<a id="SeparableConv1D.input_shape" />

Returns the input shape.


#### [`SeparableConv1D.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="SeparableConv1D.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`SeparableConv1D.kernel_shape`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=758)<a id="SeparableConv1D.kernel_shape" />

Returns the kernel shape.


#### [`SeparableConv1D.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="SeparableConv1D.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`SeparableConv1D.mask`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=852)<a id="SeparableConv1D.mask" />

Returns the mask.


#### [`SeparableConv1D.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="SeparableConv1D.module_name" />

Returns the name of the Module.


#### [`SeparableConv1D.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="SeparableConv1D.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`SeparableConv1D.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="SeparableConv1D.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`SeparableConv1D.output_channels`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=749)<a id="SeparableConv1D.output_channels" />

Returns the number of output channels.


#### [`SeparableConv1D.padding`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=775)<a id="SeparableConv1D.padding" />

Returns the padding algorithm used, if this is the same for all dims.

Use `.paddings` if you want a tuple with the padding algorithm used for each
dimension.

##### Returns:

  The padding algorithm used, if this is the same for all dimensions.

##### Raises:


* `ValueError`: If different padding algorithms are used for different
    dimensions.


#### [`SeparableConv1D.paddings`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=798)<a id="SeparableConv1D.paddings" />

Returns a tuple with the padding algorithm used for each dimension.


#### [`SeparableConv1D.partitioners`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=842)<a id="SeparableConv1D.partitioners" />

Returns the partitioners dictionary.


#### [`SeparableConv1D.rate`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=770)<a id="SeparableConv1D.rate" />

Returns the dilation rate.


#### [`SeparableConv1D.regularizers`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=847)<a id="SeparableConv1D.regularizers" />

Returns the regularizers dictionary.


#### [`SeparableConv1D.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="SeparableConv1D.scope_name" />

Returns the full name of the Module's variable scope.


#### [`SeparableConv1D.stride`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=763)<a id="SeparableConv1D.stride" />

Returns the stride.


#### [`SeparableConv1D.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="SeparableConv1D.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`SeparableConv1D.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="SeparableConv1D.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`SeparableConv1D.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="SeparableConv1D.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`SeparableConv1D.w`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=808)<a id="SeparableConv1D.w" />

Returns the Variable containing the weight matrix.


#### [`SeparableConv1D.w_dw`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=3036)<a id="SeparableConv1D.w_dw" />

Returns the Variable containing the depthwise weight matrix.


#### [`SeparableConv1D.w_pw`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=3042)<a id="SeparableConv1D.w_pw" />

Returns the Variable containing the pointwise weight matrix.



### [`class SeparableConv2D`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?q=class:SeparableConv2D)<a id="SeparableConv2D" />

Performs an in-plane convolution to each channel independently.

This acts as a light wrapper around the TensorFlow op
`tf.nn.separable_conv2d`, abstracting away variable creation and sharing.

#### [`SeparableConv2D.__init__(output_channels, channel_multiplier, kernel_shape, stride=1, rate=1, padding='SAME', use_bias=True, initializers=None, partitioners=None, regularizers=None, data_format='NHWC', padding_value='CONSTANT', custom_getter=None, name='separable_conv2d')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=2576)<a id="SeparableConv2D.__init__" />

Constructs a SeparableConv2D module.

See the following documentation for an explanation of VALID versus SAME
padding modes:
https://www.tensorflow.org/api_docs/python/tf/nn/convolution

##### Args:


* `output_channels`: Number of output channels. Must be an integer.
* `channel_multiplier`: Number of channels to expand pointwise (depthwise)
      convolution to. Must be an integer. Must be > 0.
      When `channel_multiplier` is set to 1, applies a different filter to
      each input channel. Numbers larger than 1 cause the filter to be
      applied to `channel_multiplier` input channels. Outputs are
      concatenated together.
* `kernel_shape`: List with 2 elements in the following layout:
      [filter_height, filter_width] or integer that is
      used to define the list in all dimensions.
* `stride`: List with 4 elements of kernel strides, or integer that is used to
      define stride in all dimensions. Layout of list:
      [1, stride_y, stride_x, 1].
* `rate`: Sequence of dilation rates (of size 2), or integer that is used to
      define dilation rate in all dimensions. 1 corresponds to standard 2D
      convolution, `rate > 1` corresponds to dilated convolution. Cannot be
      > 1 if any of `stride` is also > 1.
* `padding`: Padding algorithm. Either `snt.SAME`, `snt.VALID`, `snt.FULL`,
      `snt.CAUSAL`, `snt.REVERSE_CAUSAL`, or a sequence of these paddings
      of length 2.
      * snt.SAME and snt.VALID are explained in the Tensorflow docs at
        https://www.tensorflow.org/api_docs/python/tf/nn/convolution.
      * snt.FULL pre- and post-pads with the maximum padding which does not
        result in a convolution over just padded elements.
      * snt.CAUSAL pre-pads to ensure that each output value only depends on
        input values at the same or preceding indices ("no dependence on the
        future").
      * snt.REVERSE_CAUSAL post-pads to ensure that each output value only
        depends on input values at the same or *greater* indices ("no
        dependence on the past").
      If you use the same padding for all dimensions, and it is one of SAME
      or VALID, then this is supported directly by the underlying
      convolution op. In all other cases, the input data will be padded
      using tf.pad before calling the convolution op.
* `use_bias`: Whether to include bias parameters. Default `True`.
* `initializers`: Optional dict containing ops to initialize the filters (with
      keys 'w_dw' for depthwise and 'w_pw' for pointwise) or biases
      (with key 'b').
* `partitioners`: Optional dict containing partitioners to partition the
      filters (with key 'w') or biases (with key 'b'). As a default, no
      partitioners are used.
* `regularizers`: Optional dict containing regularizers for the filters
      (with keys 'w_dw' for depthwise and 'w_pw' for pointwise) and the
      biases (with key 'b'). As a default, no regularizers are used.
      A regularizer should be a function that takes a single `Tensor` as an
      input and returns a scalar `Tensor` output, e.g. the L1 and L2
      regularizers in `tf.contrib.layers`.
* `data_format`: A string. Specifies whether the channel dimension
      of the input and output is the last dimension (default, NHWC), or the
      second dimension ("NCHW").
* `padding_value`: The type of padding to use, either "CONSTANT", "SYMMETRIC"
      or "REFLECT", as supported by the underlying tf.pad
      (https://www.tensorflow.org/api_docs/python/tf/pad). Can only be set
      globally for all dimensions. Defaults to "CONSTANT" which will pad
      with zeros, potentially directly via the underlying convolution op if
      the padding is SAME for all dimensions.
* `custom_getter`: Callable or dictionary of callables to use as
      custom getters inside the module. If a dictionary, the keys
      correspond to regexes to match variable names. See the
      `tf.get_variable` documentation for information about the
      custom_getter API.
* `name`: Name of the module.

##### Raises:


* `ValueError`: If `channel_multiplier` isn't of type (`numbers.Integral` or
      `tf.Dimension`).
* `ValueError`: If `channel_multiplier` is less than 1.
* `ValueError`: If the given data_format is not a supported format (see
      `SUPPORTED_2D_DATA_FORMATS`).
  base.IncompatibleShapeError: If the given kernel shape is not an integer;
      or if the given kernel shape is not a sequence of two integers.
  base.IncompatibleShapeError: If the given stride is not an integer; or if
      the given stride is not a sequence of two integers.
  base.IncompatibleShapeError: If the given rate is not an integer; or if
      the given rate is not a sequence of two integers.
  base.IncompatibleShapeError: If a mask is a TensorFlow Tensor with
      a not fully defined shape.
  base.NotSupportedError: If rate in any dimension and the stride in any
      dimension are simultaneously > 1.

* `ValueError`: If the given padding is not `snt.VALID`, `snt.SAME`,
      `snt.FULL`, `snt.CAUSAL`, `snt.REVERSE_CAUSAL` or a sequence of these.
* `KeyError`: If `initializers`, `partitioners` or `regularizers` contain any
      keys other than 'w_dw', 'w_pw' or 'b'.
* `TypeError`: If any of the given initializers, partitioners or regularizers
      are not callable.
* `TypeError`: If mask is given and it is not convertible to a Tensor.
* `ValueError`: If the passed-in data_format doesn't have a channel dimension.


#### [`SeparableConv2D.__call__(inputs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=556)<a id="SeparableConv2D.__call__" />

Connects the _ConvND module into the graph, with input Tensor `inputs`.

If this is not the first time the module has been connected to the graph,
the input Tensor provided here must have the same number of channels, in
order for the existing variables to be the correct size for the
multiplication; the batch size and input spatial dimensions may differ for
each connection.

##### Args:


* `inputs`: A ND Tensor of the same rank as `data_format`, and either of types
  `tf.float16`, `tf.bfloat16`, `tf.float32` or `tf.float64`.

##### Returns:

  A ND Tensor of shape [batch_size, output_dim_1, output_dim_2, ...,
      output_channels].

##### Raises:


* `ValueError`: If connecting the module into the graph any time after the
      first time and the inferred size of the input does not match previous
      invocations.
  base.IncompatibleShapeError: If the input tensor has the wrong number
      of dimensions.
  base.UnderspecifiedError: If the channel dimension of `inputs` isn't
      defined.
  base.IncompatibleShapeError: If a mask is present and its shape is
      incompatible with the shape of the weights.

* `TypeError`: If input Tensor dtype is not compatible with either
      `tf.float16`, `tf.bfloat16`, `tf.float32` or `tf.float64`.


#### [`SeparableConv2D.b`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=814)<a id="SeparableConv2D.b" />

Returns the Variable containing the bias.

##### Returns:

  Variable object containing the bias, from the most recent __call__.

##### Raises:

  base.NotConnectedError: If the module has not been connected to the graph
      yet, meaning the variables do not exist.

* `AttributeError`: If the module does not use bias.


#### [`SeparableConv2D.channel_multiplier`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=2784)<a id="SeparableConv2D.channel_multiplier" />

Returns the channel multiplier argument.


#### [`SeparableConv2D.clone(name=None)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=876)<a id="SeparableConv2D.clone" />

Returns a cloned `_ConvND` module.

##### Args:


* `name`: Optional string assigning name of cloned module. The default name
    is constructed by appending "_clone" to `self.module_name`.

##### Returns:

  A copy of the current class.


#### [`SeparableConv2D.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="SeparableConv2D.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`SeparableConv2D.conv_op_padding`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=803)<a id="SeparableConv2D.conv_op_padding" />

Returns the padding algorithm used for the underlying convolution op.


#### [`SeparableConv2D.data_format`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=857)<a id="SeparableConv2D.data_format" />

Returns the data format.


#### [`SeparableConv2D.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="SeparableConv2D.defun" />

Wraps this modules call method in a callable graph function.


#### [`SeparableConv2D.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="SeparableConv2D.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`SeparableConv2D.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="SeparableConv2D.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`SeparableConv2D.get_possible_initializer_keys(use_bias=True)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=2709)<a id="SeparableConv2D.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`SeparableConv2D.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="SeparableConv2D.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`SeparableConv2D.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="SeparableConv2D.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`SeparableConv2D.has_bias`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=832)<a id="SeparableConv2D.has_bias" />

Returns `True` if bias Variable is present in the module.


#### [`SeparableConv2D.initializers`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=837)<a id="SeparableConv2D.initializers" />

Returns the initializers dictionary.


#### [`SeparableConv2D.input_channels`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=869)<a id="SeparableConv2D.input_channels" />

Returns the number of input channels.


#### [`SeparableConv2D.input_shape`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=863)<a id="SeparableConv2D.input_shape" />

Returns the input shape.


#### [`SeparableConv2D.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="SeparableConv2D.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`SeparableConv2D.kernel_shape`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=758)<a id="SeparableConv2D.kernel_shape" />

Returns the kernel shape.


#### [`SeparableConv2D.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="SeparableConv2D.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`SeparableConv2D.mask`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=852)<a id="SeparableConv2D.mask" />

Returns the mask.


#### [`SeparableConv2D.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="SeparableConv2D.module_name" />

Returns the name of the Module.


#### [`SeparableConv2D.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="SeparableConv2D.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`SeparableConv2D.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="SeparableConv2D.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`SeparableConv2D.output_channels`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=749)<a id="SeparableConv2D.output_channels" />

Returns the number of output channels.


#### [`SeparableConv2D.padding`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=775)<a id="SeparableConv2D.padding" />

Returns the padding algorithm used, if this is the same for all dims.

Use `.paddings` if you want a tuple with the padding algorithm used for each
dimension.

##### Returns:

  The padding algorithm used, if this is the same for all dimensions.

##### Raises:


* `ValueError`: If different padding algorithms are used for different
    dimensions.


#### [`SeparableConv2D.paddings`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=798)<a id="SeparableConv2D.paddings" />

Returns a tuple with the padding algorithm used for each dimension.


#### [`SeparableConv2D.partitioners`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=842)<a id="SeparableConv2D.partitioners" />

Returns the partitioners dictionary.


#### [`SeparableConv2D.rate`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=770)<a id="SeparableConv2D.rate" />

Returns the dilation rate.


#### [`SeparableConv2D.regularizers`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=847)<a id="SeparableConv2D.regularizers" />

Returns the regularizers dictionary.


#### [`SeparableConv2D.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="SeparableConv2D.scope_name" />

Returns the full name of the Module's variable scope.


#### [`SeparableConv2D.stride`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=763)<a id="SeparableConv2D.stride" />

Returns the stride.


#### [`SeparableConv2D.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="SeparableConv2D.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`SeparableConv2D.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="SeparableConv2D.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`SeparableConv2D.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="SeparableConv2D.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`SeparableConv2D.w`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=808)<a id="SeparableConv2D.w" />

Returns the Variable containing the weight matrix.


#### [`SeparableConv2D.w_dw`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=2789)<a id="SeparableConv2D.w_dw" />

Returns the Variable containing the depthwise weight matrix.


#### [`SeparableConv2D.w_pw`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=2795)<a id="SeparableConv2D.w_pw" />

Returns the Variable containing the pointwise weight matrix.



### [`class Sequential`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/sequential.py?q=class:Sequential)<a id="Sequential" />

Builds a module out of a sequence of callables.

Note that `Sequential` is limited in the range of possible architectures
it can handle. This is a deliberate design decision; `Sequential` is only
meant to be used for the simple case of fusing together modules/ops where
the input of a particular module/op is the output of the previous one. Another
restriction is that it is not possible to have extra arguments in the `_build`
method that are passed to the constituents of the module - for example,
if there is a `BatchNorm` module in `Sequential` and the user wishes to switch
the `is_training` flag. If this is the desired use case, the recommended
solution is to use `snt.Module` to wrap a custom function, as shown in the
following example:

https://github.com/deepmind/sonnet/blob/master/sonnet/examples/module_with_build_args.py

#### [`Sequential.__init__(layers, name='sequential')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/sequential.py?l=47)<a id="Sequential.__init__" />

Constructs a Sequential module.

This feeds the output of each layer into the next and returns the output
of the final layer.

If a layer returns a tuple, it is assumed that this must be unpacked into
the argument list of the next layer. If it is not a tuple, it is simply
passed through to the next layer unchanged.

##### Args:


* `layers`: Iterable of callables to stack together, which can be modules
      or ops.
* `name`: Name of the module.

##### Raises:


* `TypeError`: If `layers` is None or contains any non-callable items.


#### [`Sequential.__call__(*args)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/sequential.py?l=79)<a id="Sequential.__call__" />

Connects the Sequential module into the graph.

##### Args:


* `*args`: A tuple of inputs, to be unpacked as the arguments to the first
      layer.

##### Returns:

  The output value of the last layer.


#### [`Sequential.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="Sequential.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`Sequential.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="Sequential.defun" />

Wraps this modules call method in a callable graph function.


#### [`Sequential.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="Sequential.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`Sequential.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="Sequential.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Sequential.get_possible_initializer_keys()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=505)<a id="Sequential.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`Sequential.get_variables(*args, **kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/sequential.py?l=113)<a id="Sequential.get_variables" />

Provide a warning that get_variables on Sequential always returns ().


#### [`Sequential.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="Sequential.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`Sequential.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="Sequential.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`Sequential.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="Sequential.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Sequential.layers`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/sequential.py?l=109)<a id="Sequential.layers" />




#### [`Sequential.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="Sequential.module_name" />

Returns the name of the Module.


#### [`Sequential.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="Sequential.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`Sequential.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="Sequential.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Sequential.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="Sequential.scope_name" />

Returns the full name of the Module's variable scope.


#### [`Sequential.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="Sequential.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Sequential.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="Sequential.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`Sequential.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="Sequential.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.



### [`class SkipConnectionCore`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/residual.py?q=class:SkipConnectionCore)<a id="SkipConnectionCore" />

Adds a skip connection to the base RNN core.

The output of the wrapped core is the concatenation of the output of the base
core with its input. The state of the wrapped core is the state of the base
core.

#### [`SkipConnectionCore.__init__(base_core, input_shape=None, name='skip_connection_core')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/residual.py?l=87)<a id="SkipConnectionCore.__init__" />

Construct a SkipConnectionCore.

##### Args:


* `base_core`: Base RNNCore to wrap.
* `input_shape`: Shape of the input as tuple, excluding the batch size.
* `name`: Name of the module.


#### [`SkipConnectionCore.__call__(inputs, prev_state, **kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/residual.py?l=99)<a id="SkipConnectionCore.__call__" />

Add elements to the Graph, computing output Tensors from input Tensors.

Subclasses must implement this method, which will be wrapped in a Template.

##### Args:


* `*args`: Input Tensors.
* `**kwargs`: Additional Python flags controlling connection.

##### Returns:

  output Tensor(s).


#### [`SkipConnectionCore.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="SkipConnectionCore.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`SkipConnectionCore.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="SkipConnectionCore.defun" />

Wraps this modules call method in a callable graph function.


#### [`SkipConnectionCore.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="SkipConnectionCore.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`SkipConnectionCore.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="SkipConnectionCore.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`SkipConnectionCore.get_possible_initializer_keys()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=505)<a id="SkipConnectionCore.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`SkipConnectionCore.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="SkipConnectionCore.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`SkipConnectionCore.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="SkipConnectionCore.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`SkipConnectionCore.initial_state(*args, **kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/residual.py?l=127)<a id="SkipConnectionCore.initial_state" />

Builds the default start state for an RNNCore.

##### Args:


* `batch_size`: An int, or scalar int32 Tensor representing the batch size.
* `dtype`: The data type to use for the state.
* `trainable`: Boolean that indicates whether to learn the initial state.
    Note that intializers and regularizers will be ignored if
    `trainable=False`.
* `trainable_initializers`: An initializer function or nested structure of
      functions with same structure as the `state_size` property of the
      core, to be used as initializers of the initial state variable.
* `trainable_regularizers`: Optional regularizer function or nested structure
    of functions with the same structure as the `state_size` property of the
    core, to be used as regularizers of the initial state variable. As a
    default, no regularizers are used. A regularizer should be a function
    that takes a single `Tensor` as an input and returns a scalar `Tensor`
    output, e.g. the L1 and L2 regularizers in `tf.contrib.layers`.
* `name`: Optional string used to prefix the initial state variable names, in
      the case of a trainable initial state. If not provided, defaults to
      the name of the module.

##### Returns:

  A tensor or nested tuple of tensors with same structure and shape as the
  `state_size` property of the core.

##### Raises:


* `ValueError`: if the user passes initializers that are not functions.
* `ValueError`: if the user passes regularizers that are not functions.


#### [`SkipConnectionCore.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="SkipConnectionCore.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`SkipConnectionCore.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="SkipConnectionCore.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`SkipConnectionCore.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="SkipConnectionCore.module_name" />

Returns the name of the Module.


#### [`SkipConnectionCore.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="SkipConnectionCore.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`SkipConnectionCore.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="SkipConnectionCore.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`SkipConnectionCore.output_size`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/residual.py?l=109)<a id="SkipConnectionCore.output_size" />

Integer or TensorShape: size of outputs produced by this cell.


#### [`SkipConnectionCore.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="SkipConnectionCore.scope_name" />

Returns the full name of the Module's variable scope.


#### [`SkipConnectionCore.state_size`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/residual.py?l=123)<a id="SkipConnectionCore.state_size" />

size(s) of state(s) used by this cell.

It can be represented by an Integer, a TensorShape or a tuple of Integers
or TensorShapes.


#### [`SkipConnectionCore.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="SkipConnectionCore.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`SkipConnectionCore.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="SkipConnectionCore.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`SkipConnectionCore.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="SkipConnectionCore.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`SkipConnectionCore.zero_state(*args, **kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/residual.py?l=130)<a id="SkipConnectionCore.zero_state" />

Return zero-filled state tensor(s).

##### Args:


* `batch_size`: int, float, or unit Tensor representing the batch size.
* `dtype`: the data type to use for the state.

##### Returns:

  If `state_size` is an int or TensorShape, then the return value is a
  `N-D` tensor of shape `[batch_size x state_size]` filled with zeros.

  If `state_size` is a nested list or tuple, then the return value is
  a nested list or tuple (of the same structure) of `2-D` tensors with
  the shapes `[batch_size x s]` for each s in `state_size`.



### [`class SliceByDim`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?q=class:SliceByDim)<a id="SliceByDim" />

Slices a tensor along specific dimensions.

The user can slice a tensor by specifying only the list of dimensions that
they want to slice, together with the lists of integers containing the
beginning indices of the slicing, and the size of the slices. Hence, with
`SliceByDim` slicing can be performed without knowing in advance the rank of
the input tensor.

Tensorflow also offers a built-in op performing slicing, `tf.slice`. However,
`tf.slice` requires all the slicing dimensions to be specified, using
wildcards when no slicing is required. For example, with `tf.slice`, slicing
half a 5D tensor along dimension `1` would be:

```python
output = tf.slice(inputs,
                  begin=[0, 0, 0, 0, 0],
                  size=[-1, inputs.get_shape()[1].value//2, -1, -1, -1])
```

The same operation using `SliceByDim` would be:

```python
output = SliceByDim(dims=[1], begin=[0], size=[x.get_shape()[1].value//2])(x)
```

`SliceByDim` can be used to specify multiple slicing dimensions, for example:

```python
output = SliceByDim(dims=[1, 3], begin=[0, 0], size=[12, 24])(x)
```

#### [`SliceByDim.__init__(dims, begin, size, name='slice_by_dim')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?l=1167)<a id="SliceByDim.__init__" />

Constructs the `SliceByDim` module.

##### Args:


* `dims`: The dimensions to slice along, as a list of unique integers.
      Negative integers index from the final dimension backwards, as in
      python arrays.
* `begin`: The beginning indices of the slicing, as a list of integers. Must
      be the same length as the `dims` list.
* `size`: The size of the slices, as a list of integers. Must be the same
      length as the `dims` list.
* `name`: The name of the module.

##### Raises:


* `ValueError`: If `dims` has non-unique integers, or if the size of `begin`
      is different from the size of `dims`, or if the size of `size` is
      different from the size of `dims`.


#### [`SliceByDim.__call__(inputs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?l=1198)<a id="SliceByDim.__call__" />

Connects the SliceByDim module into the graph.

##### Args:


* `inputs`: `Tensor` to slice. Its rank must be greater than the maximum
      dimension specified in `dims` (plus one as python is 0 indexed).

##### Returns:

  The sliced tensor.

##### Raises:


* `ValueError`: If `inputs` tensor has insufficient rank.


#### [`SliceByDim.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="SliceByDim.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`SliceByDim.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="SliceByDim.defun" />

Wraps this modules call method in a callable graph function.


#### [`SliceByDim.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="SliceByDim.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`SliceByDim.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="SliceByDim.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`SliceByDim.get_possible_initializer_keys()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=505)<a id="SliceByDim.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`SliceByDim.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="SliceByDim.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`SliceByDim.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="SliceByDim.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`SliceByDim.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="SliceByDim.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`SliceByDim.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="SliceByDim.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`SliceByDim.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="SliceByDim.module_name" />

Returns the name of the Module.


#### [`SliceByDim.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="SliceByDim.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`SliceByDim.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="SliceByDim.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`SliceByDim.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="SliceByDim.scope_name" />

Returns the full name of the Module's variable scope.


#### [`SliceByDim.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="SliceByDim.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`SliceByDim.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="SliceByDim.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`SliceByDim.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="SliceByDim.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.



### [`class TileByDim`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?q=class:TileByDim)<a id="TileByDim" />

Tile a tensor along specific dimensions.

The user can tile a tensor by specifying only the list of dimensions that
they want to tile, together with the lists of integers containing the
multiples of the tiling. Hence, with `TileByDim` tiling can be performed
without knowing in advance the rank of the input tensor.

Tensorflow also offers a built-in op performing tiling, `tf.tile`. However,
`tf.tile` requires all the tiling dimensions to be specified, using `1`
when no tiling is required. For example, with tf.tiling, tiling a 5D
tensor along dimension `1`, by `2` would be:

```python
output = tf.tile(inputs, multiples=[1, 2, 1, 1, 1])
```

The same operation using `TileByDim` would be:

```python
output = TileByDim(dims=[1], multiples=[2])(x)
```

`TileByDim` can be used to specify multiple tiling dimensions, for example:

```python
output = TileByDim(dims=[1, 3], multiples=[2, 4])(x)
```

#### [`TileByDim.__init__(dims, multiples, name='tile_by_dim')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?l=1261)<a id="TileByDim.__init__" />

Constructs the `TileByDim` module.

##### Args:


* `dims`: The dimensions to tile along, as a list of unique integers.
* `multiples`: The multiple of the tiling, as a list of integers. Must
      be the same length as the `dims` list.
* `name`: The name of the module.

##### Raises:


* `ValueError`: If `dims` has non-unique integers, or if the size of
      `multiples` is different from the size of `dims`.


#### [`TileByDim.__call__(inputs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?l=1283)<a id="TileByDim.__call__" />

Connects the `TileByDim` module into the graph.

##### Args:


* `inputs`: `Tensor` to tile.

##### Returns:

  The tiled tensor.


#### [`TileByDim.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="TileByDim.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`TileByDim.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="TileByDim.defun" />

Wraps this modules call method in a callable graph function.


#### [`TileByDim.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="TileByDim.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`TileByDim.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="TileByDim.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`TileByDim.get_possible_initializer_keys()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=505)<a id="TileByDim.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`TileByDim.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="TileByDim.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`TileByDim.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="TileByDim.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`TileByDim.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="TileByDim.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`TileByDim.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="TileByDim.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`TileByDim.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="TileByDim.module_name" />

Returns the name of the Module.


#### [`TileByDim.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="TileByDim.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`TileByDim.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="TileByDim.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`TileByDim.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="TileByDim.scope_name" />

Returns the full name of the Module's variable scope.


#### [`TileByDim.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="TileByDim.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`TileByDim.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="TileByDim.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`TileByDim.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="TileByDim.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.



### [`class TrainableInitialState`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/rnn_core.py?q=class:TrainableInitialState)<a id="TrainableInitialState" />

Helper Module that creates a learnable initial state for an RNNCore.

This class receives an example (possibly nested) initial state of an RNNCore,
and returns a state that has the same shape, structure, and values, but is
trainable. Additionally, the user may specify a boolean mask that
indicates which parts of the initial state should be trainable.

This allows users to train an unrolled RNNCore with a learnable initial state
in the following way:

    core = ... # Any RNNCore module object.
    initial_state = core.initial_state(batch_size, dtype)
    trainable_initial_state = snt.TrainableInitialState(initial_state)()
    output, final_state = tf.nn.dynamic_rnn(
        core, input_sequence, initial_state=trainable_initial_state)

#### [`TrainableInitialState.__init__(initial_state, mask=None, name='trainable_initial_state')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/rnn_core.py?l=299)<a id="TrainableInitialState.__init__" />

Constructs the Module that introduces a trainable state in the graph.

It receives an initial state that will be used as the initial values for the
trainable variables that the module contains, and optionally a mask that
indicates the parts of the initial state that should be learnable.

##### Args:


* `initial_state`: tensor or arbitrarily nested iterables of tensors.
* `mask`: optional boolean mask. It should have the same nested structure as
   the given initial_state.
* `name`: module name.

##### Raises:


* `TypeError`: if mask is not a list of booleans or None.


#### [`TrainableInitialState.__call__()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/rnn_core.py?l=332)<a id="TrainableInitialState.__call__" />

Connects the module to the graph.

##### Returns:

  The learnable state, which has the same type, structure and shape as
    the `initial_state` passed to the constructor.


#### [`TrainableInitialState.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="TrainableInitialState.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`TrainableInitialState.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="TrainableInitialState.defun" />

Wraps this modules call method in a callable graph function.


#### [`TrainableInitialState.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="TrainableInitialState.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`TrainableInitialState.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="TrainableInitialState.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`TrainableInitialState.get_possible_initializer_keys()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=505)<a id="TrainableInitialState.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`TrainableInitialState.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="TrainableInitialState.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`TrainableInitialState.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="TrainableInitialState.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`TrainableInitialState.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="TrainableInitialState.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`TrainableInitialState.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="TrainableInitialState.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`TrainableInitialState.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="TrainableInitialState.module_name" />

Returns the name of the Module.


#### [`TrainableInitialState.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="TrainableInitialState.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`TrainableInitialState.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="TrainableInitialState.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`TrainableInitialState.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="TrainableInitialState.scope_name" />

Returns the full name of the Module's variable scope.


#### [`TrainableInitialState.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="TrainableInitialState.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`TrainableInitialState.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="TrainableInitialState.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`TrainableInitialState.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="TrainableInitialState.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.



### [`class TrainableVariable`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?q=class:TrainableVariable)<a id="TrainableVariable" />

Provides learnable parameter Tensor.

#### [`TrainableVariable.__init__(shape, dtype=tf.float32, initializers=None, partitioners=None, regularizers=None, custom_getter=None, name='trainable_variable')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?l=968)<a id="TrainableVariable.__init__" />

Constructs a TrainableVariable module.

##### Args:


* `shape`: Tensor shape.
* `dtype`: Tensor data type.
* `initializers`: Optional dictionary containing ops to initialize the weight
      Tensor, with key 'w'.
* `partitioners`: Optional dict containing a partitioner to partition
      the weight (with key 'w'). As a default, no partitioner is used.
* `regularizers`: Optional dict containing regularizers for the weights
    (with key 'w'). As a default, no regularizers are used. A regularizer
    should be a function that takes a single `Tensor` as an input and
    returns a scalar `Tensor` output, e.g. the L1 and L2 regularizers in
    `tf.contrib.layers`.
* `custom_getter`: Optional callable or dictionary of callables to use as
    custom_getter for the module.
* `name`: Name of the module.

##### Raises:


* `KeyError`: If `initializers` contains any keys other than 'w'.
* `KeyError`: If `partitioners` contains any keys other than 'w'.
* `KeyError`: If `regularizers` contains any keys other than 'w'.
* `TypeError`: If any of the given initializers are not callable.
* `TypeError`: If any of the given partitioners are not callable.
* `TypeError`: If any of the given regularizers are not callable.


#### [`TrainableVariable.__call__()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?l=1014)<a id="TrainableVariable.__call__" />

Connects the TrainableTensor module into the graph.

##### Returns:

  A Tensor of shape as determined in the constructor.


#### [`TrainableVariable.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="TrainableVariable.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`TrainableVariable.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="TrainableVariable.defun" />

Wraps this modules call method in a callable graph function.


#### [`TrainableVariable.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="TrainableVariable.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`TrainableVariable.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="TrainableVariable.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`TrainableVariable.get_possible_initializer_keys()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=505)<a id="TrainableVariable.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`TrainableVariable.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="TrainableVariable.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`TrainableVariable.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="TrainableVariable.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`TrainableVariable.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="TrainableVariable.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`TrainableVariable.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="TrainableVariable.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`TrainableVariable.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="TrainableVariable.module_name" />

Returns the name of the Module.


#### [`TrainableVariable.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="TrainableVariable.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`TrainableVariable.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="TrainableVariable.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`TrainableVariable.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="TrainableVariable.scope_name" />

Returns the full name of the Module's variable scope.


#### [`TrainableVariable.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="TrainableVariable.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`TrainableVariable.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="TrainableVariable.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`TrainableVariable.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="TrainableVariable.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`TrainableVariable.w`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?l=1032)<a id="TrainableVariable.w" />

Returns the Variable containing the weights Tensor.

##### Returns:

  Variable object containing the weights, from the most recent __call__.

##### Raises:

  base.Error: If the module has not been connected to the graph yet,
      meaning the variables do not exist.



### [`class Transposable`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?q=class:Transposable)<a id="Transposable" />

Transposable module interface.

The Transposable interface requires that transposable modules implement
a method called `transpose`, returning a module that is the transposed
version of the one the method is called on.
Calling the method twice should return a module with the same specifications
as the original module.

When implementing a transposable module, special care is required to make
sure that parameters needed to instantiate the module are provided as
functions whose invocation is deferred to graph construction time.

For example, in Linear we might want to call:

```python
linear = snt.Linear(name="linear", output_size=output_size)
linear_transpose = linear.transpose()
```

where the output_size for linear_transpose is not known yet, as linear is
not yet connected to the graph: output_size is passed to linear_transpose's
constructor as a lambda returning linear.input_size. The lambda will return
the correct value once linear is given an input.
Notice that linear_transpose's output_size value does not need to be defined
until the module is connected to the graph.

#### [`Transposable.input_shape()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=760)<a id="Transposable.input_shape" />

Returns shape of input `Tensor` passed at last call to `build`.


#### [`Transposable.transpose(name=None, **kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=748)<a id="Transposable.transpose" />

Builds and returns transposed version of module.

##### Args:


* `name`: Name of the transposed module.
* `**kwargs`: Additional Python flags controlling transposition.

##### Returns:

  Transposed version of the module.



### [`class UnderspecifiedError`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base_errors.py?q=class:UnderspecifiedError)<a id="UnderspecifiedError" />

Error raised when too little information is available.

This does not typically mean the user is trying to do something that doesn't
work (in which case `IncompatibleShapeError` should be used), just that
some more information needs to be provided in order to build the Graph.


### [`class VanillaRNN`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic_rnn.py?q=class:VanillaRNN)<a id="VanillaRNN" />

Basic fully connected vanilla RNN core.

#### [`VanillaRNN.__init__(hidden_size, activation=<function tanh>, initializers=None, partitioners=None, regularizers=None, name='vanilla_rnn')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic_rnn.py?l=72)<a id="VanillaRNN.__init__" />

Construct a Basic RNN core.

##### Args:


* `hidden_size`: hidden size dimensionality.
* `activation`: activation function to use.
* `initializers`: optional dict containing ops to initialize the weights. This
    dictionary may contain the keys 'in_to_hidden' and/or
    'hidden_to_hidden'.
* `partitioners`: optional dict containing ops to partition the weights. This
    dictionary may contain the keys 'in_to_hidden' and/or
    'hidden_to_hidden'.
* `regularizers`: optional dict containing ops to regularize the weights. This
    dictionary may contain the keys 'in_to_hidden' and/or
    'hidden_to_hidden'.
* `name`: name of the module.

##### Raises:


* `KeyError`: if `initializers` contains any keys other than 'in_to_hidden' or
    'hidden_to_hidden'.
* `KeyError`: if `partitioners` contains any keys other than 'in_to_hidden' or
    'hidden_to_hidden'.
* `KeyError`: if `regularizers` contains any keys other than 'in_to_hidden' or
    'hidden_to_hidden'.
* `TypeError`: If any of the given initializers are not callable.
* `TypeError`: If any of the given partitioners are not callable.
* `TypeError`: If any of the given regularizers are not callable.


#### [`VanillaRNN.__call__(input_, prev_state)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic_rnn.py?l=111)<a id="VanillaRNN.__call__" />

Connects the VanillaRNN module into the graph.

If this is not the first time the module has been connected to the graph,
the Tensors provided as input_ and state must have the same final
dimension, in order for the existing variables to be the correct size for
their corresponding multiplications. The batch size may differ for each
connection.

##### Args:


* `input_`: a 2D Tensor of size [batch_size, input_size].
* `prev_state`: a 2D Tensor of size [batch_size, hidden_size].

##### Returns:


* `output`: a 2D Tensor of size [batch_size, hidden_size].
* `next_state`: a Tensor of size [batch_size, hidden_size].

##### Raises:


* `ValueError`: if connecting the module into the graph any time after the
    first time, and the inferred size of the inputs does not match previous
    invocations.


#### [`VanillaRNN.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="VanillaRNN.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`VanillaRNN.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="VanillaRNN.defun" />

Wraps this modules call method in a callable graph function.


#### [`VanillaRNN.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="VanillaRNN.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`VanillaRNN.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="VanillaRNN.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`VanillaRNN.get_possible_initializer_keys()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=505)<a id="VanillaRNN.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`VanillaRNN.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="VanillaRNN.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`VanillaRNN.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="VanillaRNN.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`VanillaRNN.hidden_to_hidden_linear`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic_rnn.py?l=157)<a id="VanillaRNN.hidden_to_hidden_linear" />




#### [`VanillaRNN.hidden_to_hidden_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic_rnn.py?l=167)<a id="VanillaRNN.hidden_to_hidden_variables" />




#### [`VanillaRNN.in_to_hidden_linear`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic_rnn.py?l=152)<a id="VanillaRNN.in_to_hidden_linear" />




#### [`VanillaRNN.in_to_hidden_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic_rnn.py?l=162)<a id="VanillaRNN.in_to_hidden_variables" />




#### [`VanillaRNN.initial_state(batch_size, dtype=tf.float32, trainable=False, trainable_initializers=None, trainable_regularizers=None, name=None, **unused_kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/rnn_core.py?l=204)<a id="VanillaRNN.initial_state" />

Builds the default start state for an RNNCore.

##### Args:


* `batch_size`: An int, or scalar int32 Tensor representing the batch size.
* `dtype`: The data type to use for the state.
* `trainable`: Boolean that indicates whether to learn the initial state.
    Note that intializers and regularizers will be ignored if
    `trainable=False`.
* `trainable_initializers`: An initializer function or nested structure of
      functions with same structure as the `state_size` property of the
      core, to be used as initializers of the initial state variable.
* `trainable_regularizers`: Optional regularizer function or nested structure
    of functions with the same structure as the `state_size` property of the
    core, to be used as regularizers of the initial state variable. As a
    default, no regularizers are used. A regularizer should be a function
    that takes a single `Tensor` as an input and returns a scalar `Tensor`
    output, e.g. the L1 and L2 regularizers in `tf.contrib.layers`.
* `name`: Optional string used to prefix the initial state variable names, in
      the case of a trainable initial state. If not provided, defaults to
      the name of the module.

##### Returns:

  A tensor or nested tuple of tensors with same structure and shape as the
  `state_size` property of the core.

##### Raises:


* `ValueError`: if the user passes initializers that are not functions.
* `ValueError`: if the user passes regularizers that are not functions.


#### [`VanillaRNN.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="VanillaRNN.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`VanillaRNN.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="VanillaRNN.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`VanillaRNN.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="VanillaRNN.module_name" />

Returns the name of the Module.


#### [`VanillaRNN.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="VanillaRNN.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`VanillaRNN.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="VanillaRNN.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`VanillaRNN.output_size`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic_rnn.py?l=176)<a id="VanillaRNN.output_size" />

Integer or TensorShape: size of outputs produced by this cell.


#### [`VanillaRNN.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="VanillaRNN.scope_name" />

Returns the full name of the Module's variable scope.


#### [`VanillaRNN.state_size`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic_rnn.py?l=172)<a id="VanillaRNN.state_size" />

size(s) of state(s) used by this cell.

It can be represented by an Integer, a TensorShape or a tuple of Integers
or TensorShapes.


#### [`VanillaRNN.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="VanillaRNN.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`VanillaRNN.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="VanillaRNN.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`VanillaRNN.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="VanillaRNN.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`VanillaRNN.zero_state(batch_size, dtype)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/rnn_core.py?l=260)<a id="VanillaRNN.zero_state" />

Return zero-filled state tensor(s).

##### Args:


* `batch_size`: int, float, or unit Tensor representing the batch size.
* `dtype`: the data type to use for the state.

##### Returns:

  If `state_size` is an int or TensorShape, then the return value is a
  `N-D` tensor of shape `[batch_size x state_size]` filled with zeros.

  If `state_size` is a nested list or tuple, then the return value is
  a nested list or tuple (of the same structure) of `2-D` tensors with
  the shapes `[batch_size x s]` for each s in `state_size`.



### [`check_initializers(initializers, keys)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/util.py?l=142)<a id="check_initializers" />

Checks the given initializers.

This checks that `initializers` is a dictionary that only contains keys in
`keys`, and furthermore the entries in `initializers` are functions or
further dictionaries (the latter used, for example, in passing initializers
to modules inside modules) that must satisfy the same constraints.

##### Args:


* `initializers`: Dictionary of initializers (allowing nested dictionaries) or
    None.
* `keys`: Iterable of valid keys for `initializers`.

##### Returns:

  Copy of checked dictionary of initializers. If `initializers=None`, an empty
  dictionary will be returned.

##### Raises:


* `KeyError`: If an initializer is provided for a key not in `keys`.
* `TypeError`: If a provided initializer is not a callable function, or
    `initializers` is not a Mapping.


### [`check_partitioners(partitioners, keys)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/util.py?l=183)<a id="check_partitioners" />

Checks the given partitioners.

This checks that `partitioners` is a dictionary that only contains keys in
`keys`, and furthermore the entries in `partitioners` are functions or
further dictionaries (the latter used, for example, in passing partitioners
to modules inside modules) that must satisfy the same constraints.

##### Args:


* `partitioners`: Dictionary of partitioners (allowing nested dictionaries) or
      None.
* `keys`: Iterable of valid keys for `partitioners`.

##### Returns:

  Checked dictionary of partitioners. If `partitioners=None`, an empty
  dictionary will be returned.

##### Raises:


* `KeyError`: If an partitioner is provided for a key not in `keys`.
* `TypeError`: If a provided partitioner is not a callable function, or
    `partitioners` is not a Mapping.


### [`check_regularizers(regularizers, keys)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/util.py?l=224)<a id="check_regularizers" />

Checks the given regularizers.

This checks that `regularizers` is a dictionary that only contains keys in
`keys`, and furthermore the entries in `regularizers` are functions or
further dictionaries (the latter used, for example, in passing regularizers
to modules inside modules) that must satisfy the same constraints.

##### Args:


* `regularizers`: Dictionary of regularizers (allowing nested dictionaries) or
    None.
* `keys`: Iterable of valid keys for `regularizers`.

##### Returns:

  Copy of checked dictionary of regularizers. If `regularizers=None`, an empty
  dictionary will be returned.

##### Raises:


* `KeyError`: If an regularizers is provided for a key not in `keys`.
* `TypeError`: If a provided regularizer is not a callable function, or
    `regularizers` is not a Mapping.


### [`clip_gradient(net, clip_value_min, clip_value_max, name=None)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/clip_gradient.py?l=31)<a id="clip_gradient" />

Clips respective gradients of a given tensor.

Acts as identity for the forward pass, but clips gradient tensor element-wise
by value during the backward pass. Any gradient values less than
`clip_value_min` or greater than `clip_values_max` are set to the respective
limit values.

##### Args:


* `net`: A `tf.Tensor`.
* `clip_value_min`: A 0-D Tensor or scalar. The minimum value to clip by.
* `clip_value_max`: A 0-D Tensor or scalar. The maximum value to clip by.
* `name`: A name for the operation (optional, default 'clip_gradient').

##### Returns:

  A `tf.Tensor` with the same type as the input tensor.

##### Raises:


* `ValueError`: If `net` dtype is non-float.


### [`count_variables_by_type(variables=None)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/util.py?l=633)<a id="count_variables_by_type" />

Returns a dict mapping dtypes to number of variables and scalars.

##### Args:


* `variables`: iterable of `tf.Variable`s, or None. If None is passed, then all
    global and local variables in the current graph are used.

##### Returns:

  A dict mapping tf.dtype keys to a dict containing the keys 'num_scalars' and
    'num_variables'.


### [`custom_getter_router(custom_getter_map, name_fn)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/util.py?l=302)<a id="custom_getter_router" />

Creates a custom getter than matches requests to dict of custom getters.

Custom getters are callables which implement the
[custom getter API]
(https://www.tensorflow.org/versions/r1.0/api_docs/python/tf/get_variable).

The returned custom getter dispatches calls based on pattern matching the
name of the requested variable to the keys of custom_getter_map. For example,

    {
      ".*/w": snt.custom_getters.stop_gradient,
    }

will match all variables named with the suffix "/w". The `name_fn` is
provided to allow processing of the name, such as stripping off a scope prefix
before matching.

##### Args:


* `custom_getter_map`: Mapping of regular expressions to custom getter
    functions.
* `name_fn`: Callable to map variable name through before matching to regular
    expressions. This might, for example, strip off a scope prefix.

##### Returns:

  A custom getter.

##### Raises:


* `TypeError`: If an entry in `custom_getter_map` is not a callable function.


### [`deprecation_warning(deprecation_message)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/util.py?l=970)<a id="deprecation_warning" />

Log a warning message the user is using deprecated functionality.


### [`format_variable_map(variable_map, join_lines=True)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/util.py?l=554)<a id="format_variable_map" />

Takes a key-to-variable map and formats it as a table.


### [`format_variables(variables, join_lines=True)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/util.py?l=539)<a id="format_variables" />

Takes a collection of variables and formats it as a table.


### [`get_lagrange_multiplier(shape=(), rate=1.0, initializer=1.0, maximize=True, valid_range=None, name='lagrange_multiplier')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/optimization_constraints.py?l=228)<a id="get_lagrange_multiplier" />

Lagrange multiplier factory.

This factory returns ops that help setting up constrained optimization
problems in Tensorflow. Given a constraint function op (either scalar or
vectorial), use this function to instantiate a Lagrange multiplier op, then
dot product the two and add them to the loss that is being optimized over.
There is no need to instantiate a second optimizer to solve the minmax
problem, as the Lagrange Multiplier op is setup to manipulate its own
gradients so that a single optmizer can be used to update all the variables
correctly.

##### Args:


* `shape`: Lagrange multipliers can be used with both scalar and vector
      constraint functions; when using vector constraints use the shape kwarg
      to pass in shape information and instantiate variables of the correct
      shape.
* `rate`: Scalar used to scale the magnitude of gradients of the Lagrange
      multipliers, defaulting to 1e-2. Using the default value will make the
      Lagrange multipliers updates slower compared to the ones for the model's
      parameters.
* `initializer`: Initializer for the Lagrange multipliers. Note that
      when using inequality constraints the initial value of the multiplier
      will be transformed via the parametrization function.
* `maximize`: Boolean, True if we want to maximize the loss w.r.t. the Lagrange
      multipliers, False otherwise.
* `valid_range`: tuple, or list. of values used to clip the value of the
      (possibly reparametrized) Lagrange multipliers.
* `name`: Name of the Lagrange multiplier op.

##### Returns:

  An op to be inserted in the graph, by multipling it with a constraint op
      and adding the resulting op to a loss. The Lagrange multiplier
      gradients are modified to that by calling minimize on the loss the
      optimizer will actually minimize w.r.t. to the model's parameters and
      maximize w.r.t. the Lagrande multipliers, hence enforcing the
      constraints.

##### Raises:


* `ValueError`: If the Lagrange multiplier is set to enforce an equality
      constraint and a parametrization function is also provided.


### [`get_normalized_variable_map(scope_or_module, collection='variables', context=None, group_sliced_variables=True)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/util.py?l=373)<a id="get_normalized_variable_map" />

Builds map of `tf.Variable`s in scope or module with normalized names.

The names of the variables are normalized to remove the scope prefix.

##### Args:


* `scope_or_module`: Scope or module to build map from.
* `collection`: Collection to restrict query to. By default this is
      `tf.GraphKeys.GLOBAL_VARIABLES`, which includes
      non-trainable variables such as moving averages.
* `context`: Scope or module, identical to or parent of `scope`. If given, this
      will be used as the stripped prefix. By default `None`, which means
      `context=scope`.
* `group_sliced_variables`: Boolean, if set to True, sliced variables are
     grouped together in the returned map; if set to False, each partition of
     a sliced variable is a separate (key, value) pair.

##### Returns:

  Dictionary mapping normalized variable name to `tf.Variable`, or a list
      of `tf.Variables` if the variable is a sliced (partitioned) variable.

##### Raises:


* `ValueError`: If `context` is given but is not a proper prefix of `scope`.


### [`get_saver(scope, collections=('variables',), context=None, **kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/util.py?l=431)<a id="get_saver" />

Builds a `tf.train.Saver` for the scope or module, with normalized names.

The names of the variables are normalized to remove the scope prefix.
This allows the same variables to be restored into another similar scope or
module using a complementary `tf.train.Saver` object.

##### Args:


* `scope`: Scope or module. Variables within will be saved or restored.
* `collections`: Sequence of collections of variables to restrict
      `tf.train.Saver` to. By default this is
      `tf.GraphKeys.GLOBAL_VARIABLES` which includes moving
      averages variables as well as trainable variables.
* `context`: Scope or module, identical to or parent of `scope`. If given, this
      will be used as the stripped prefix.
* `**kwargs`: Extra keyword arguments to pass to tf.train.Saver.

##### Returns:

    A `tf.train.Saver` object for Variables in the scope or module.


### [`get_variables_in_module(module, collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/util.py?l=86)<a id="get_variables_in_module" />

Returns tuple of `tf.Variable`s declared inside an `snt.Module`.

Note that this operates by searching the variable scope a module contains,
and so does not know about any modules which were constructed elsewhere but
used inside this module.

##### Args:


* `module`: `snt.Module` instance to query the scope of.
* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


### [`get_variables_in_scope(scope, collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/util.py?l=62)<a id="get_variables_in_scope" />

Returns a tuple `tf.Variable`s in a scope for a given collection.

##### Args:


* `scope`: `tf.VariableScope` or string to retrieve variables from.
* `collection`: Collection to restrict query to. By default this is
      `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
      include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.


### [`has_variable_scope(obj)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/util.py?l=460)<a id="has_variable_scope" />

Determines whether the given object has a variable scope.


### [`highway_core_with_recurrent_dropout(hidden_size, num_layers, keep_prob=0.5, **kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=1756)<a id="highway_core_with_recurrent_dropout" />

Highway core with recurrent dropout.

##### Args:


* `hidden_size`: (int) Hidden size dimensionality.
* `num_layers`: (int) Number of highway layers.
* `keep_prob`: the probability to keep an entry when applying dropout.
* `**kwargs`: Extra keyword arguments to pass to the highway core.

##### Returns:

  A tuple (train_core, test_core) where train_core is a higway core with
  recurrent dropout enabled to be used for training and test_core is the
  same highway core without recurrent dropout.


### [`log_variables(variables=None)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/util.py?l=568)<a id="log_variables" />

Logs variable information.

This function logs the name, shape, type, collections, and device for either
all variables or a given iterable of variables. In the "Device" columns,
the nature of the variable (legacy or resource (for ResourceVariables)) is
also specified in parenthesis.

##### Args:


* `variables`: iterable of variables; if not provided, then all variables
      (in the default graph) are logged.


### [`lstm_with_recurrent_dropout(hidden_size, keep_prob=0.5, **kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=436)<a id="lstm_with_recurrent_dropout" />

LSTM with recurrent dropout.

##### Args:


* `hidden_size`: the LSTM hidden size.
* `keep_prob`: the probability to keep an entry when applying dropout.
* `**kwargs`: Extra keyword arguments to pass to the LSTM.

##### Returns:

  A tuple (train_lstm, test_lstm) where train_lstm is an LSTM with
  recurrent dropout enabled to be used for training and test_lstm
  is the same LSTM without recurrent dropout.


### [`lstm_with_zoneout(hidden_size, keep_prob_c=0.5, keep_prob_h=0.95, **kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=523)<a id="lstm_with_zoneout" />

LSTM with recurrent dropout.

##### Args:


* `hidden_size`: the LSTM hidden size.
* `keep_prob_c`: the probability to use the new value of the cell state rather
    than freezing it.
* `keep_prob_h`: the probability to use the new value of the hidden state
    rather than freezing it.
* `**kwargs`: Extra keyword arguments to pass to the LSTM.

##### Returns:

  A tuple (train_lstm, test_lstm) where train_lstm is an LSTM with
  recurrent dropout enabled to be used for training and test_lstm
  is the same LSTM without zoneout.


### [`merge_leading_dims(array_or_tensor, n_dims=2)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?l=39)<a id="merge_leading_dims" />

Merge the first dimensions of a tensor.

##### Args:


* `array_or_tensor`: Tensor to have its first dimensions merged. Can also
      be an array or numerical value, which will be converted to a tensor
      for batch application, if needed.
* `n_dims`: Number of dimensions to merge.

##### Returns:

  Either the input value converted to a Tensor, with the requested dimensions
  merged, or the unmodified input value if the input has less than `n_dims`
  dimensions.

##### Raises:


* `ValueError`: If the rank of `array_or_tensor` is not well-defined.


### [`observe_connections(observer)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=157)<a id="observe_connections" />

Notifies the observer whenever any Sonnet module is connected to the graph.

If a module contains nested modules, the observer is notified once for each
nested module, followed by the containing module.

For example:

```python
def logging_observer(connected_subgraph):
  logging.info(connected_subgraph.module.module_name)

with snt.observe_connections(logging_observer):
  output = imagenet_module(input_tensor)
```

##### Args:


* `observer`: Callable accepting a single argument. Will be called with a
  `ConnectedSubGraph` each time a module is connected to the graph.

##### Yields:


* `None`: just yields control to the inner context.


### [`parse_string_to_constructor(ctor_string)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/util.py?l=985)<a id="parse_string_to_constructor" />

Returns a callable which corresponds to the constructor string.

Various modules (eg, ConvNet2D) take constructor arguments which are
callables, indicating a submodule to build. These can be passed as
actual constructors, eg `snt.LayerNorm`, however that makes the config
for that module not trivially serializable. This function tries to map
a string representation to the underlying callable, allowing configs to
remain serializable where necessary.

##### Args:


* `ctor_string`: string representing some module in Sonnet. If the string is
    provided with no dots, we assume it is a member of Sonnet available at
    top level, i.e. "LayerNorm" maps to `snt.LayerNorm`.

##### Raises:


* `ValueError`: if no matching constructor can be found.

##### Returns:

  Callable constructor which corresponds to `ctor_string`.


### [`remove_unsupported_kwargs(module_or_fn, all_kwargs_dict)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/util.py?l=1103)<a id="remove_unsupported_kwargs" />

Removes any kwargs not supported by `module_or_fn` from `all_kwargs_dict`.

A new dict is return with shallow copies of keys & values from
`all_kwargs_dict`, as long as the key is accepted by module_or_fn. The
returned dict can then be used to connect `module_or_fn` (along with some
other inputs, ie non-keyword arguments, in general).

`snt.supports_kwargs` is used to tell whether a given kwarg is supported. Note
that this method may give false negatives, which would lead to extraneous
removals in the result of this function. Please read the docstring for
`snt.supports_kwargs` for details, and manually inspect the results from this
function if in doubt.

##### Args:


* `module_or_fn`: some callable which can be interrogated by
    `snt.supports_kwargs`. Generally a Sonnet module or a method (wrapped in
    `@reuse_variables`) of a Sonnet module.
* `all_kwargs_dict`: a dict containing strings as keys, or None.

##### Raises:


* `ValueError`: if `all_kwargs_dict` is not a dict.

##### Returns:

  A dict containing some subset of the keys and values in `all_kwargs_dict`.
  This subset may be empty. If `all_kwargs_dict` is None, this will be an
  empty dict.


### [`reuse_variables(method)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/util.py?l=663)<a id="reuse_variables" />

Wraps an arbitrary method so it does variable sharing.

This decorator creates variables the first time it calls `method`, and reuses
them for subsequent calls. The object that calls `method` provides a
`tf.VariableScope`, either as a `variable_scope` attribute or as the return
value of an `_enter_variable_scope()` method.

The first time the wrapped method is invoked, it enters the caller's
`tf.VariableScope` with `reuse=False`. On all subsequent calls it enters the
same variable scope with `reuse=True`.

Variables are created in the context of the `tf.VariableScope` provided by the
caller object. Ops are created with an additional `tf.name_scope()`, which
adds a scope for the wrapped method name. For example:

```python
class MyClass(object):

  def __init__(self, name):
    with tf.variable_scope(None, default_name=name) as variable_scope:
      self.variable_scope = variable_scope

  @snt.reuse_variables
  def add_x(self, tensor):
    x = tf.get_variable("x", shape=tensor.get_shape())
    return tensor + x

module = MyClass("my_module_name")
input_tensor = tf.zeros(shape=(5,))

# This creates the variable "my_module_name/x"
# and op "my_module_name/add_x/add"
output = module.add_x(input_tensor)
```

For performance when executing eagerly it may be desirable to additionally
annotate these methods using `defun`, such that they are encapsulated as
graph functions. This is not recommended if your method returns a variable
since the output of `defun` would be an op that returned the variable's value
when evaluated (rather than the variable instance).

```python
class FooModule(snt.AbstractModule):
  def _build(self, inputs):
    return complex_math(inputs)

  @tfe.defun
  @snt.reuse_variables
  def more_complex_stuff(self, inputs):
    return more_complex_math(inputs)
```

##### Args:


* `method`: The method to wrap.

##### Returns:

  The wrapped method.


### [`scale_gradient(net, scale, name='scale_gradient')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/scale_gradient.py?l=33)<a id="scale_gradient" />

Scales gradients for the backwards pass.

This might be used to, for example, allow one part of a model to learn at a
lower rate than the rest.

WARNING: Think carefully about how your optimizer works. If, for example, you
use rmsprop, the gradient is always rescaled (with some additional epsilon)
towards unity. This means `scale_gradient` won't have the effect of
lowering the learning rate.

If `scale` is `0.0`, this op reduces to `tf.stop_gradient`. If `scale`
is `1.0`, this op reduces to `tf.identity`.

##### Args:


* `net`: A `tf.Tensor` or in eager mode a callable that produces a `tf.Tensor`.
* `scale`: The scale factor for the gradient on the backwards pass.
* `name`: A name for the operation (optional).

##### Returns:

  In graph mode returns a `tf.Tensor` with the same type as the input tensor.
  In eager mode returns a callable wrapping `net` whose gradients are scaled.

##### Raises:


* `ValueError`: If `net` dtype is non-float and `scale` is not zero or one.


### [`split_leading_dim(tensor, inputs, n_dims=2)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?l=93)<a id="split_leading_dim" />

Split the first dimension of a tensor.

##### Args:


* `tensor`: Tensor to have its first dimension split.
* `inputs`: Original reference input to look the dimensions of.
* `n_dims`: Number of dimensions to split.

##### Returns:

  The input tensor, with its first dimension split.


### [`summarize_variables(variables=None)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/util.py?l=598)<a id="summarize_variables" />

Logs a summary of variable information.

This function groups Variables by dtype and prints out the number of Variables
and the total number of scalar values for each datatype, as well as the total
memory consumed.

For Variables of type tf.string, the memory usage cannot be accurately
calculated from the Graph as the memory requirements change based on what
strings are actually stored, which can only be determined inside a session.
In this case, the amount of memory used to stored the pointers to the strings
is logged, along with a warning.

##### Args:


* `variables`: iterable of variables; if not provided, then all variables
    (in the default graph) are summarized.


### [`supports_kwargs(module_or_fn, kwargs_list)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/util.py?l=1040)<a id="supports_kwargs" />

Determines whether the provided callable supports all the kwargs.

This is useful when you have a module that might or might not support a
kwarg such as `is_training`. Rather than calling the module and catching the
error, risking the potential modification of underlying state, this function
introspects the module to see what kwargs are actually supported, using
the python `inspect` module.

Note that many TF functions do not export a valid argspec object, rather they
have a generic *args, **kwargs signature due to various layers of wrapping
(deprecation decorators, etc). In those circumstances we return
MAYBE_SUPPORTED, and users will have to use another method to tell whether
the kwargs are supported (e.g. by just calling the function).

##### Args:


* `module_or_fn`: some callable, generally an object or a method of some object.
    If an object is provided, we check wither `module_or_fn.__call__` supports
    the provided kwargs, which for a Sonnet module will automatically check
    the signature of _build. If `module_or_fn` is a function/method, then
    we check its signature directly, so non-Sonnet functions can be used.
* `kwargs_list`: string or iterable of strings of keyword arg names to test for.
    If an empty iterable is provided this function will always return True.

##### Raises:


* `ValueError`: if a non-string is provided in `kwargs_list`.

##### Returns:

  a string, one of 'supported', 'not_supported' or 'maybe_supported'.


### [`trainable_initial_state(batch_size, state_size, dtype, initializers=None, regularizers=None, name=None)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/rnn_core.py?l=93)<a id="trainable_initial_state" />

Creates an initial state consisting of trainable variables.

The trainable variables are created with the same shapes as the elements of
`state_size` and are tiled to produce an initial state.

##### Args:


* `batch_size`: An int, or scalar int32 Tensor representing the batch size.
* `state_size`: A `TensorShape` or nested tuple of `TensorShape`s to use for the
      shape of the trainable variables.
* `dtype`: The data type used to create the variables and thus initial state.
* `initializers`: An optional container of the same structure as `state_size`
      containing initializers for the variables.
* `regularizers`: An optional container of the same structure as `state_size`
      containing regularizers for the variables.
* `name`: optional string used to prefix the initial state variable names.

##### Returns:

  A `Tensor` or nested tuple of `Tensor`s with the same size and structure
  as `state_size`, where each `Tensor` is a tiled trainable `Variable`.

##### Raises:


* `ValueError`: if the user passes initializers that are not functions.
* `ValueError`: if the user passes regularizers that are not functions.


### [`variable_map_items(variable_map)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/util.py?l=475)<a id="variable_map_items" />

Yields an iterator over (string, variable) pairs in the variable map.

In general, variable maps map variable names to either a `tf.Variable`, or
list of `tf.Variable`s (in case of sliced variables).

##### Args:


* `variable_map`: dict, variable map over which to iterate.

##### Yields:

  (string, tf.Variable) pairs.


### [`wrap_with_spectral_norm(module_class, sn_kwargs=None, pow_iter_collection=None)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/spectral_normalization.py?l=37)<a id="wrap_with_spectral_norm" />

Returns a constructor for the inner class with spectral normalization.

This function accepts a Sonnet AbstractModule class as argument (the class,
*not* an instance of that class) alongside an optional dictionary of keyword
arguments for the spectral_norm function, and returns a constructor which can
be treated identically to the constructor of the input class, but with
spectral normalization applied to the weights created by the class.

Internally, this is just a partially evaluated SpectralNormWrapper module.

`pow_iter_collection`, if not None, is treated as the name of a TensorFlow
global collection. Each time the module's weight matrix is accessed ops are
built for performing one step of power iteration to approximate that weight's
first singular follow and ops are created for saving this new approximation in
an internal variable. At build-time the resulting object takes a special
boolean 'enable_power_iteration' keyword argument. If this is True (the
default), a control dependency on the operation for updating this internal
variable is attached to the returned weight. Otherwise, the update is *not*
attached as a control dependency, but an op is placed into the
`pow_iter_collection` global collection which causes the internal variable to
be updated. It is then up to the user to choose whether to run this update.

##### Args:


* `module_class`: A constructor/class reference for a Sonnet module you would
      like to wrap and automatically apply spectral normalization.
* `sn_kwargs`: Keyword arguments to be passed to the spectral_norm function
      in addition to the weight tensor.
* `pow_iter_collection`: The name of a global collection for potentially
      storing ops for updating internal variables.

##### Returns:

  An snt.AbstractModule class representing the original with spectral norm.


### [`class custom_getters.Context`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/custom_getters/context.py?q=class:Context)<a id="custom_getters.Context" />

Contextually switching a custom getter on.

Example usage, using `snt.custom_getters.stop_gradient` with `Context` to
selectively disable gradients flowing to variables for particular connections
of the module:

```python
  custom_getter = snt.custom_getters.Context(snt.custom_getters.stop_gradient)
  lin = snt.Linear(10, custom_getter=custom_getter)

  lin(net1)  # custom getter not used, gradients on
  with custom_getter:
    lin(net2)  # custom getter used, gradients off
```

Warning: If the custom getter affects the way the variable is created, then
switching it on or off after the variable has been created will have no
effect. For example, it is not possible to selectively switch off
trainability using `custom_getters.non_trainable`, since this is a
creation-time attribute. It is however possible to selectively switch
off gradients using `custom_getters.stop_gradient`, since
this applies an operation to the variable.

#### [`custom_getters.Context.__init__(getter, verbose=False, default_getter=None)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/custom_getters/context.py?l=49)<a id="custom_getters.Context.__init__" />

Initializes a contextual switch for a custom getter.

##### Args:


* `getter`: The custom getter which we may want to switch on.
* `verbose`: Log out every time a variable is fetched, and whether or not
    `getter` is used.
* `default_getter`: The custom getter to use when this context is not active.
    If None, the default custom getter is used.

##### Returns:

  A custom getter which can also be used as a context manager.
  Entering the context enables the custom getter.



### [`custom_getters.non_trainable(getter, *args, **kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/custom_getters/non_trainable.py?l=22)<a id="custom_getters.non_trainable" />

Custom getter which makes a variable non-trainable.

Usage like:

  with tf.variable_scope("", custom_getter=snt.custom_getters.non_trainable):
      net = snt.Linear(num_hidden)(net)

or, using the `custom_getter` constructor argument,

  linear = snt.Linear(num_hidden,
                      custom_getter=snt.custom_getters.non_trainable)
  net = linear(net)

will result in the variables inside the linear having `trainable=False`, i.e.
won't be added to tf.trainable_variables() and thus won't be optimized.

Warning: If `reuse=True` and the variable has previously been created in
the same graph with `trainable=True`, this custom getter will do
nothing. Similarly if the variable is reused after being created by this
custom getter it will still be non-trainable, even if `trainable=True`.

When used with a Sonnet module, the module must be constructed inside the
variable scope with the custom getter. Just building the module inside said
variable scope will not use the custom getter.

##### Args:


* `getter`: The true getter to call.
* `*args`: Arguments, in the same format as tf.get_variable.
* `**kwargs`: Keyword arguments, in the same format as tf.get_variable.

##### Returns:

  The return value of `getter(*args, **kwargs)` except with `trainable=False`
  enforced.


### [`custom_getters.override_args(**kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/custom_getters/override_args.py?l=24)<a id="custom_getters.override_args" />

Creates a custom getter that applies specified named arguments.

##### Args:


* `**kwargs`: Overriding arguments for the custom getter to use in preference
    the named arguments it's called with.

##### Returns:

  Custom getter.


### [`custom_getters.override_default_args(**kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/custom_getters/override_args.py?l=55)<a id="custom_getters.override_default_args" />

Creates a custom getter that applies specified named arguments.

The returned custom getter treats the specified named arguments as revised
defaults, and does not override any non-`None` argument values supplied by
the original get_variable call (or by a nested scope's custom getter).

##### Args:


* `**kwargs`: Overriding arguments for the custom getter to use in preference
    the named arguments it's called with.

##### Returns:

  Custom getter.


### [`custom_getters.restore_initializer(filename, name_fn=None, collection='variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/custom_getters/restore_initializer.py?l=26)<a id="custom_getters.restore_initializer" />

Custom getter to restore all variables with `snt.restore_initializer`.

##### Args:


* `filename`: The filename of the checkpoint.
* `name_fn`: A function which can map the name of the variable requested. This
    allows restoring variables with values having different names in the
    checkpoint.
* `collection`: Only set the restore initializer for variables in this
    collection. If `None`, it will attempt to restore all variables. By
    default `tf.GraphKeys.GLOBAL_VARIABLES`.

##### Returns:

  A restore_initializer custom getter, which is a function taking arguments
  (getter, name, *args, **kwargs).


### [`custom_getters.stop_gradient(getter, *args, **kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/custom_getters/stop_gradient.py?l=24)<a id="custom_getters.stop_gradient" />

Custom getter which prevents variables being optimized.

Usage like:

  with tf.variable_scope("", custom_getter=snt.custom_getters.stop_gradient):
      net = snt.Linear(num_hidden)(net)

or, using the `custom_getter` constructor argument,

  linear = snt.Linear(num_hidden,
                      custom_getter=snt.custom_getters.stop_gradient)
  net = linear(net)

will result in the gradient with respect to the variables in the linear
module being `None`. By default, the variables will still be in the trainable
variables collection.

When used with a Sonnet module, the module must be constructed inside the
variable scope with the custom getter. Just building the module inside said
variable scope will not use the custom getter.

##### Args:


* `getter`: The true getter to call.
* `*args`: Arguments, in the same format as tf.get_variable.
* `**kwargs`: Keyword arguments, in the same format as tf.get_variable.

##### Returns:

  The return value of `getter(*args, **kwargs)` with a tf.stop_gradient.


### [`class custom_getters.bayes_by_backprop.EstimatorModes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/custom_getters/bayes_by_backprop.py?q=class:EstimatorModes)<a id="custom_getters.bayes_by_backprop.EstimatorModes" />




### [`class custom_getters.bayes_by_backprop._VariableMetadata`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/custom_getters/bayes_by_backprop.py?q=class:VariableMetadata)<a id="custom_getters.bayes_by_backprop._VariableMetadata" />

VariableMetadata(raw_variable_name, raw_variable_shape, scope_name, posterior, posterior_estimate, prior, kl_cost, prior_vars, posterior_vars)

#### `custom_getters.bayes_by_backprop._VariableMetadata.kl_cost`<a id="custom_getters.bayes_by_backprop._VariableMetadata.kl_cost" />

Alias for field number 6


#### `custom_getters.bayes_by_backprop._VariableMetadata.posterior`<a id="custom_getters.bayes_by_backprop._VariableMetadata.posterior" />

Alias for field number 3


#### `custom_getters.bayes_by_backprop._VariableMetadata.posterior_estimate`<a id="custom_getters.bayes_by_backprop._VariableMetadata.posterior_estimate" />

Alias for field number 4


#### `custom_getters.bayes_by_backprop._VariableMetadata.posterior_vars`<a id="custom_getters.bayes_by_backprop._VariableMetadata.posterior_vars" />

Alias for field number 8


#### `custom_getters.bayes_by_backprop._VariableMetadata.prior`<a id="custom_getters.bayes_by_backprop._VariableMetadata.prior" />

Alias for field number 5


#### `custom_getters.bayes_by_backprop._VariableMetadata.prior_vars`<a id="custom_getters.bayes_by_backprop._VariableMetadata.prior_vars" />

Alias for field number 7


#### `custom_getters.bayes_by_backprop._VariableMetadata.raw_variable_name`<a id="custom_getters.bayes_by_backprop._VariableMetadata.raw_variable_name" />

Alias for field number 0


#### `custom_getters.bayes_by_backprop._VariableMetadata.raw_variable_shape`<a id="custom_getters.bayes_by_backprop._VariableMetadata.raw_variable_shape" />

Alias for field number 1


#### `custom_getters.bayes_by_backprop._VariableMetadata.scope_name`<a id="custom_getters.bayes_by_backprop._VariableMetadata.scope_name" />

Alias for field number 2



### [`custom_getters.bayes_by_backprop.adaptive_gaussian_prior_builder(getter, name, *args, **kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/custom_getters/bayes_by_backprop.py?l=218)<a id="custom_getters.bayes_by_backprop.adaptive_gaussian_prior_builder" />

A pre-canned builder for adaptive scalar gaussian prior distributions.

Given a true `getter` function and arguments forwarded from `tf.get_variable`,
return a distribution object for a scalar-valued adaptive gaussian prior
which will be broadcast over a variable of the requisite shape. This prior's
parameters (e.g `loc` and `scale` for a gaussian) will consist of a single
learned scalar for the entire `tf.Variable` for which it serves as the prior,
regardless of that `tf.Variable`'s shape.

##### Args:


* `getter`: The `getter` passed to a `custom_getter`. Please see the
    documentation for `tf.get_variable`.
* `name`: The `name` argument passed to `tf.get_variable`.
* `*args`: See positional arguments passed to `tf.get_variable`.
* `**kwargs`: See keyword arguments passed to `tf.get_variable`.

##### Returns:

  An instance of `tfp.distributions.Normal` representing the prior
  distribution over the variable in question.


### [`custom_getters.bayes_by_backprop.analytic_kl_builder(posterior, prior, sample)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/custom_getters/bayes_by_backprop.py?l=257)<a id="custom_getters.bayes_by_backprop.analytic_kl_builder" />

A pre-canned builder for the analytic kl divergence.


### [`custom_getters.bayes_by_backprop.bayes_by_backprop_getter(posterior_builder=<function diagonal_gaussian_posterior_builder>, prior_builder=<function fixed_gaussian_prior_builder>, kl_builder=<function stochastic_kl_builder>, sampling_mode_tensor=None, fresh_noise_per_connection=True, keep_control_dependencies=False)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/custom_getters/bayes_by_backprop.py?l=263)<a id="custom_getters.bayes_by_backprop.bayes_by_backprop_getter" />

Creates a custom getter which does Bayes by Backprop.

Please see `tf.get_variable` for general documentation on custom getters.

All arguments are optional. If nothing is configued, then a diagonal gaussian
posterior will be used, and a fixed N(0, 0.01) prior will be used. Please
see the default `posterior_builder` and `prior_builder` for a more detailed
understanding of the default settings.

##### Args:


* `posterior_builder`: A builder function which constructs an instance of
    `tfp.distributions.Distribution` which shall serve as the posterior over
    the `tf.Variable` of interest. The builder receives the `getter` and the
    arguments forwarded from `tf.get_variable`. Suppose one wrote

    ```
    tf.get_variable(
        'weights', shape=(3,), initializer=tf.zeros_initializer,
        dtype=tf.float32)
    ```

    then the `posterior_builder` argument would receive the `name`, `shape`,
    `initializer`, and `dtype` arguments passed above. The builder must return
    a `tfp.distributions.Distribution` object.

    Please see the `tf.get_variable` for documentation on `custom_getter` and
    `getter`, and see `bbb.diagonal_gaussian_posterior_builder`
    (the default) for an example of using this builder API.

* `prior_builder`: A builder function which constructs an instance of
    `tfp.distributions.Distribution` which shall serve as the prior over the
    `tf.Variable` of interest. Identical API to `posterior_builder`. See
    `bbb.fixed_gaussian_prior_builder` (the default) for an example.
* `kl_builder`: A builder function which receives the posterior distribution,
    prior distribution, and a sample from the posterior. It returns a
    scalar-shaped `tf.Tensor` representing the total KL cost for the
    `tf.Variable` in question. See `bbb.stochastic_kl_builder` (default) and
    `bbb.analytic_kl_builder` for examples.
* `sampling_mode_tensor`: A `tf.Tensor` which determines how an estimate from
    the posterior is produced. It must be scalar-shaped and have a `dtype` of
    `tf.string`. Valid values for this tensor are `bbb.EstimatorModes.sample`
    (which is the default), `bbb.EstimatorModes.mean`, and
    `bbb.EstimatorModes.last_sample`. `bbb.EstimatorModes.sample` is
    appropriate for training, and `bbb.EstimatorModes.mean` can be used
    at test time.
* `fresh_noise_per_connection`: A boolean. Indicates that each time a stochastic
    variable is retrieved with this custom getter, new sampling noise should
    be used. This is `True` by default. If this argument is set to `False`,
    then the same noise is used for each connection. Note that this does not
    apply to connections within a `tf.while_loop`; the same sampling noise
    is always used in different iterations of a `tf.while_loop` within one
    `session.run()` call. See the unit tests for details.
* `keep_control_dependencies`: A boolean. This argument should only be
    used by advanced users. Indicates that each time a stochastic variable is
    retrieved in the loop body of a `tf.while_loop` construct, new sampling
    noise should be used.
    The default behavior is `False`, so that RNNs use the same weights at each
    recurrent time step. This is done by removing the creation of the Variable
    from any existing control flow contexts. Notably, the Variables will be
    created outside the context of any tf.while_loop, making them fetchable.
    When this argument is `True`, any Variables used in the loop body of a
    `tf.while_loop` will be non-fetchable. If the KL cost needs to be
    evaluated, the Variable must *first* be used *outside* the loop body. This
    op using the Variable simply needs to be placed on the graph to get a
    stochastic estimate of the KL; it doesn't need to ever be used. Example:

    ```
    def loop_body(i):
      logits = sonnet_module(queue)
      i = i + 1

    with tf.variable_scope('bbb', custom_getter=bbb.bayes_by_backprop_getter(
        fresh_noise_per_connection=True,
        keep_control_dependencies=True)):
      unused_op = sonnet_module(queue)  # Adds KL estimate to bbb Collection
      final_i = tf.while_loop(lambda i: i < 5, loop_body, tf.constant(0.))
    ```

    Here when we add `unused_op` to the graph, we also add a number of tensors
    associated with the particular stochastic variable, including its
    contribution to the KL cost, to a graph-level registry. These are
    organized in a per-stochastic-variable data structure and be accessed with
    `bbb.get_variable_metadata()`. Without this line, these Tensors would
    instead be added the first time the Variable is used in the while_loop,
    which would make them non-fetchable.

    In all cases, the KL cost is only added once per Variable, which is the
    correct behavior, since if a variable is used multiple times in a model,
    the KL cost should remain unaffected.

##### Returns:

  A `custom_getter` function which implements Bayes by Backprop.


### [`custom_getters.bayes_by_backprop.diagonal_gaussian_posterior_builder(getter, name, shape=None, *args, **kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/custom_getters/bayes_by_backprop.py?l=148)<a id="custom_getters.bayes_by_backprop.diagonal_gaussian_posterior_builder" />

A pre-canned builder for diagonal gaussian posterior distributions.

Given a true `getter` function and arguments forwarded from `tf.get_variable`,
return a distribution object for a diagonal posterior over a variable of the
requisite shape.

##### Args:


* `getter`: The `getter` passed to a `custom_getter`. Please see the
    documentation for `tf.get_variable`.
* `name`: The `name` argument passed to `tf.get_variable`.
* `shape`: The `shape` argument passed to `tf.get_variable`.
* `*args`: See positional arguments passed to `tf.get_variable`.
* `**kwargs`: See keyword arguments passed to `tf.get_variable`.

##### Returns:

  An instance of `tfp.distributions.Normal` representing the posterior
  distribution over the variable in question.


### [`custom_getters.bayes_by_backprop.fixed_gaussian_prior_builder(getter, name, dtype=None, *args, **kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/custom_getters/bayes_by_backprop.py?l=188)<a id="custom_getters.bayes_by_backprop.fixed_gaussian_prior_builder" />

A pre-canned builder for fixed gaussian prior distributions.

Given a true `getter` function and arguments forwarded from `tf.get_variable`,
return a distribution object for a scalar-valued fixed gaussian prior which
will be broadcast over a variable of the requisite shape.

##### Args:


* `getter`: The `getter` passed to a `custom_getter`. Please see the
    documentation for `tf.get_variable`.
* `name`: The `name` argument passed to `tf.get_variable`.
* `dtype`: The `dtype` argument passed to `tf.get_variable`.
* `*args`: See positional arguments passed to `tf.get_variable`.
* `**kwargs`: See keyword arguments passed to `tf.get_variable`.

##### Returns:

  An instance of `tfp.distributions.Normal` representing the prior
  distribution over the variable in question.


### [`custom_getters.bayes_by_backprop.get_total_kl_cost(name='total_kl_cost', filter_by_name_substring=None)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/custom_getters/bayes_by_backprop.py?l=514)<a id="custom_getters.bayes_by_backprop.get_total_kl_cost" />

Get the total cost for all (or a subset of) the stochastic variables.

##### Args:


* `name`: A name for the tensor representing the total kl cost.
* `filter_by_name_substring`: A string used to filter which variables count
    toward the total KL cost. By default, this argument is `None`, and all
    variables trained using Bayes by Backprop are included. If this argument
    is provided, the variables whose KL costs are summed will be all those
    whose name contains `filter_by_name_substring`. An example use of this
    would be to select all variables within a particular scope.

##### Returns:

  A tensor representing the total KL cost in the ELBO loss.


### [`custom_getters.bayes_by_backprop.get_variable_metadata(scope_name_substring=None)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/custom_getters/bayes_by_backprop.py?l=536)<a id="custom_getters.bayes_by_backprop.get_variable_metadata" />




### [`custom_getters.bayes_by_backprop.inverse_softplus(y)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/custom_getters/bayes_by_backprop.py?l=114)<a id="custom_getters.bayes_by_backprop.inverse_softplus" />

The inverse of the softplus function.

Computes the *inverse* of softplus, a function which maps an
unconstrained real number to the positive reals, e.g. to squash an
unconstrained neural network activation to parameterize a variance.

##### Args:


* `y`: A positive number.

##### Returns:

  The number `x` such that softplus(x) = y.


### [`custom_getters.bayes_by_backprop.scale_variable_initializer(desired_scale)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/custom_getters/bayes_by_backprop.py?l=129)<a id="custom_getters.bayes_by_backprop.scale_variable_initializer" />




### [`custom_getters.bayes_by_backprop.stochastic_kl_builder(posterior, prior, sample)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/custom_getters/bayes_by_backprop.py?l=250)<a id="custom_getters.bayes_by_backprop.stochastic_kl_builder" />

A pre-canned builder for a ubiquitous stochastic KL estimator.


### [`nest.assert_same_structure(*args, **kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/ops/nest.py?l=36)<a id="nest.assert_same_structure" />




### [`nest.assert_shallow_structure(*args, **kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/ops/nest.py?l=36)<a id="nest.assert_shallow_structure" />




### [`nest.flatten(*args, **kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/ops/nest.py?l=36)<a id="nest.flatten" />




### [`nest.flatten_dict_items(*args, **kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/ops/nest.py?l=36)<a id="nest.flatten_dict_items" />




### [`nest.flatten_iterable(*args, **kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/ops/nest.py?l=36)<a id="nest.flatten_iterable" />




### [`nest.flatten_up_to(*args, **kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/ops/nest.py?l=36)<a id="nest.flatten_up_to" />




### [`nest.is_iterable(*args, **kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/ops/nest.py?l=36)<a id="nest.is_iterable" />




### [`nest.is_sequence(*args, **kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/ops/nest.py?l=36)<a id="nest.is_sequence" />




### [`nest.map(*args, **kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/ops/nest.py?l=36)<a id="nest.map" />




### [`nest.map_up_to(*args, **kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/ops/nest.py?l=36)<a id="nest.map_up_to" />




### [`nest.pack_iterable_as(*args, **kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/ops/nest.py?l=36)<a id="nest.pack_iterable_as" />




### [`nest.pack_sequence_as(*args, **kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/ops/nest.py?l=36)<a id="nest.pack_sequence_as" />




### [`nest.with_deprecation_warning(fn, extra_message='')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/ops/nest.py?l=34)<a id="nest.with_deprecation_warning" />

Wraps the function and prints a warn-once (per `extra_message`) warning.


### [`class nets.AlexNet`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/alexnet.py?q=class:AlexNet)<a id="nets.AlexNet" />

Implementation of AlexNet with full and mini versions.

Based on:
  'ImageNet Classification with Deep Convolutional Neural Networks'
  Alex Krizhevsky, Ilya Sutskever, Geoffrey E. Hinton, NIPS 2012
  http://papers.nips.cc/paper/4824-imagenet-classification-w

#### [`nets.AlexNet.__init__(mode, use_batch_norm=False, batch_norm_config=None, initializers=None, partitioners=None, regularizers=None, bn_on_fc_layers=True, custom_getter=None, name='alex_net')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/alexnet.py?l=61)<a id="nets.AlexNet.__init__" />

Constructs AlexNet.

##### Args:


* `mode`: Construction mode of network: `AlexNet.FULL` or `AlexNet.MINI`.
* `use_batch_norm`: Whether to use batch normalization between the output of
      a layer and the activation function.
* `batch_norm_config`: Optional mapping of additional configuration for the
      `snt.BatchNorm` modules.
* `initializers`: Optional dict containing ops to initialize the filters (with
      key 'w') or biases (with key 'b'). The default initializers are
      truncated normal initializers, which are commonly used when the inputs
      are zero centered (see https://arxiv.org/pdf/1502.03167v3.pdf).
* `partitioners`: Optional dict containing partitioners for the filters
    (with key 'w') and the biases (with key 'b'). As a default, no
    partitioners are used.
* `regularizers`: Optional dict containing regularizers for the filters
    (with key 'w') and the biases (with key 'b'). As a default, no
    regularizers are used. A regularizer should be a function that takes
    a single `Tensor` as an input and returns a scalar `Tensor` output, e.g.
    the L1 and L2 regularizers in `tf.contrib.layers`.
* `bn_on_fc_layers`: If `use_batch_norm` is True, add batch normalization to
    the fully-connected layers. This is deprecated.
* `custom_getter`: Callable or dictionary of callables to use as
    custom getters inside the module. If a dictionary, the keys
    correspond to regexes to match variable names. See the `tf.get_variable`
    documentation for information about the custom_getter API.
* `name`: Name of the module.

##### Raises:

  base.Error: If the given `mode` is not one of `AlexNet.FULL`,
    or `AlexNet.MINI`.

* `KeyError`: If `initializers`, `partitioners` or `regularizers` contains any
    keys other than 'w' or 'b'.


#### [`nets.AlexNet.__call__(inputs, keep_prob=None, is_training=None, test_local_stats=True)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/alexnet.py?l=183)<a id="nets.AlexNet.__call__" />

Connects the AlexNet module into the graph.

The is_training flag only controls the batch norm settings, if `False` it
does not force no dropout by overriding any input `keep_prob`. To avoid any
confusion this may cause, if `is_training=False` and `keep_prob` would cause
dropout to be applied, an error is thrown.

##### Args:


* `inputs`: A Tensor of size [batch_size, input_height, input_width,
    input_channels], representing a batch of input images.
* `keep_prob`: A scalar Tensor representing the dropout keep probability.
    When `is_training=False` this must be None or 1 to give no dropout.
* `is_training`: Boolean to indicate if we are currently training. Must be
      specified if batch normalization or dropout is used.
* `test_local_stats`: Boolean to indicate to `snt.BatchNorm` if batch
    normalization should  use local batch statistics at test time.
    By default `True`.

##### Returns:

  A Tensor of size [batch_size, output_size], where `output_size` depends
  on the mode the network was constructed in.

##### Raises:

  base.IncompatibleShapeError: If any of the input image dimensions
    (input_height, input_width) are too small for the given network mode.

* `ValueError`: If `keep_prob` is not None or 1 when `is_training=False`.
* `ValueError`: If `is_training` is not explicitly specified when using
    batch normalization.


#### [`nets.AlexNet.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="nets.AlexNet.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`nets.AlexNet.conv_modules`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/alexnet.py?l=319)<a id="nets.AlexNet.conv_modules" />

Returns list containing convolutional modules of network.

##### Returns:

  A list containing the Conv2D modules.


#### [`nets.AlexNet.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="nets.AlexNet.defun" />

Wraps this modules call method in a callable graph function.


#### [`nets.AlexNet.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="nets.AlexNet.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`nets.AlexNet.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="nets.AlexNet.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.AlexNet.get_possible_initializer_keys()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=505)<a id="nets.AlexNet.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`nets.AlexNet.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="nets.AlexNet.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.AlexNet.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="nets.AlexNet.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`nets.AlexNet.initializers`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/alexnet.py?l=295)<a id="nets.AlexNet.initializers" />




#### [`nets.AlexNet.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="nets.AlexNet.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`nets.AlexNet.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="nets.AlexNet.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.AlexNet.linear_modules`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/alexnet.py?l=330)<a id="nets.AlexNet.linear_modules" />

Returns list containing linear modules of network.

##### Returns:

  A list containing the Linear modules.


#### [`nets.AlexNet.min_input_size`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/alexnet.py?l=307)<a id="nets.AlexNet.min_input_size" />

Returns integer specifying the minimum width and height for the input.

Note that the input can be non-square, but both the width and height must
be >= this number in size.

##### Returns:

  The minimum size as an integer.


#### [`nets.AlexNet.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="nets.AlexNet.module_name" />

Returns the name of the Module.


#### [`nets.AlexNet.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="nets.AlexNet.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`nets.AlexNet.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="nets.AlexNet.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.AlexNet.partitioners`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/alexnet.py?l=299)<a id="nets.AlexNet.partitioners" />




#### [`nets.AlexNet.regularizers`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/alexnet.py?l=303)<a id="nets.AlexNet.regularizers" />




#### [`nets.AlexNet.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="nets.AlexNet.scope_name" />

Returns the full name of the Module's variable scope.


#### [`nets.AlexNet.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="nets.AlexNet.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.AlexNet.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="nets.AlexNet.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.AlexNet.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="nets.AlexNet.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.



### [`class nets.AlexNetFull`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/alexnet.py?q=class:AlexNetFull)<a id="nets.AlexNetFull" />

AlexNet constructed in the 'FULL' mode.

#### [`nets.AlexNetFull.__init__(use_batch_norm=False, batch_norm_config=None, initializers=None, partitioners=None, regularizers=None, custom_getter=None, name='alex_net_full')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/alexnet.py?l=345)<a id="nets.AlexNetFull.__init__" />

Constructs AlexNet.

##### Args:


* `use_batch_norm`: Whether to use batch normalization between the output of
      a layer and the activation function.
* `batch_norm_config`: Optional mapping of additional configuration for the
      `snt.BatchNorm` modules.
* `initializers`: Optional dict containing ops to initialize the filters (with
      key 'w') or biases (with key 'b'). The default initializers are
      truncated normal initializers, which are commonly used when the inputs
      are zero centered (see https://arxiv.org/pdf/1502.03167v3.pdf).
* `partitioners`: Optional dict containing partitioners for the filters
    (with key 'w') and the biases (with key 'b'). As a default, no
    partitioners are used.
* `regularizers`: Optional dict containing regularizers for the filters
    (with key 'w') and the biases (with key 'b'). As a default, no
    regularizers are used. A regularizer should be a function that takes
    a single `Tensor` as an input and returns a scalar `Tensor` output, e.g.
    the L1 and L2 regularizers in `tf.contrib.layers`.
* `custom_getter`: Callable or dictionary of callables to use as
    custom getters inside the module. If a dictionary, the keys
    correspond to regexes to match variable names. See the `tf.get_variable`
    documentation for information about the custom_getter API.
* `name`: Name of the module.

##### Raises:


* `KeyError`: If `initializers`, `partitioners` or `regularizers` contains any
    keys other than 'w' or 'b'.


#### [`nets.AlexNetFull.__call__(inputs, keep_prob=None, is_training=None, test_local_stats=True)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/alexnet.py?l=183)<a id="nets.AlexNetFull.__call__" />

Connects the AlexNet module into the graph.

The is_training flag only controls the batch norm settings, if `False` it
does not force no dropout by overriding any input `keep_prob`. To avoid any
confusion this may cause, if `is_training=False` and `keep_prob` would cause
dropout to be applied, an error is thrown.

##### Args:


* `inputs`: A Tensor of size [batch_size, input_height, input_width,
    input_channels], representing a batch of input images.
* `keep_prob`: A scalar Tensor representing the dropout keep probability.
    When `is_training=False` this must be None or 1 to give no dropout.
* `is_training`: Boolean to indicate if we are currently training. Must be
      specified if batch normalization or dropout is used.
* `test_local_stats`: Boolean to indicate to `snt.BatchNorm` if batch
    normalization should  use local batch statistics at test time.
    By default `True`.

##### Returns:

  A Tensor of size [batch_size, output_size], where `output_size` depends
  on the mode the network was constructed in.

##### Raises:

  base.IncompatibleShapeError: If any of the input image dimensions
    (input_height, input_width) are too small for the given network mode.

* `ValueError`: If `keep_prob` is not None or 1 when `is_training=False`.
* `ValueError`: If `is_training` is not explicitly specified when using
    batch normalization.


#### [`nets.AlexNetFull.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="nets.AlexNetFull.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`nets.AlexNetFull.conv_modules`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/alexnet.py?l=319)<a id="nets.AlexNetFull.conv_modules" />

Returns list containing convolutional modules of network.

##### Returns:

  A list containing the Conv2D modules.


#### [`nets.AlexNetFull.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="nets.AlexNetFull.defun" />

Wraps this modules call method in a callable graph function.


#### [`nets.AlexNetFull.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="nets.AlexNetFull.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`nets.AlexNetFull.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="nets.AlexNetFull.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.AlexNetFull.get_possible_initializer_keys()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=505)<a id="nets.AlexNetFull.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`nets.AlexNetFull.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="nets.AlexNetFull.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.AlexNetFull.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="nets.AlexNetFull.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`nets.AlexNetFull.initializers`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/alexnet.py?l=295)<a id="nets.AlexNetFull.initializers" />




#### [`nets.AlexNetFull.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="nets.AlexNetFull.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`nets.AlexNetFull.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="nets.AlexNetFull.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.AlexNetFull.linear_modules`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/alexnet.py?l=330)<a id="nets.AlexNetFull.linear_modules" />

Returns list containing linear modules of network.

##### Returns:

  A list containing the Linear modules.


#### [`nets.AlexNetFull.min_input_size`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/alexnet.py?l=307)<a id="nets.AlexNetFull.min_input_size" />

Returns integer specifying the minimum width and height for the input.

Note that the input can be non-square, but both the width and height must
be >= this number in size.

##### Returns:

  The minimum size as an integer.


#### [`nets.AlexNetFull.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="nets.AlexNetFull.module_name" />

Returns the name of the Module.


#### [`nets.AlexNetFull.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="nets.AlexNetFull.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`nets.AlexNetFull.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="nets.AlexNetFull.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.AlexNetFull.partitioners`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/alexnet.py?l=299)<a id="nets.AlexNetFull.partitioners" />




#### [`nets.AlexNetFull.regularizers`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/alexnet.py?l=303)<a id="nets.AlexNetFull.regularizers" />




#### [`nets.AlexNetFull.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="nets.AlexNetFull.scope_name" />

Returns the full name of the Module's variable scope.


#### [`nets.AlexNetFull.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="nets.AlexNetFull.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.AlexNetFull.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="nets.AlexNetFull.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.AlexNetFull.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="nets.AlexNetFull.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.



### [`class nets.AlexNetMini`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/alexnet.py?q=class:AlexNetMini)<a id="nets.AlexNetMini" />

AlexNet constructed in the 'MINI' mode.

#### [`nets.AlexNetMini.__init__(use_batch_norm=False, batch_norm_config=None, initializers=None, partitioners=None, regularizers=None, custom_getter=None, name='alex_net_mini')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/alexnet.py?l=397)<a id="nets.AlexNetMini.__init__" />

Constructs AlexNet.

##### Args:


* `use_batch_norm`: Whether to use batch normalization between the output of
      a layer and the activation function.
* `batch_norm_config`: Optional mapping of additional configuration for the
      `snt.BatchNorm` modules.
* `initializers`: Optional dict containing ops to initialize the filters (with
      key 'w') or biases (with key 'b'). The default initializers are
      truncated normal initializers, which are commonly used when the inputs
      are zero centered (see https://arxiv.org/pdf/1502.03167v3.pdf).
* `partitioners`: Optional dict containing partitioners for the filters
    (with key 'w') and the biases (with key 'b'). As a default, no
    partitioners are used.
* `regularizers`: Optional dict containing regularizers for the filters
    (with key 'w') and the biases (with key 'b'). As a default, no
    regularizers are used. A regularizer should be a function that takes
    a single `Tensor` as an input and returns a scalar `Tensor` output, e.g.
    the L1 and L2 regularizers in `tf.contrib.layers`.
* `custom_getter`: Callable or dictionary of callables to use as
    custom getters inside the module. If a dictionary, the keys
    correspond to regexes to match variable names. See the `tf.get_variable`
    documentation for information about the custom_getter API.
* `name`: Name of the module.

##### Raises:


* `KeyError`: If `initializers`, `partitioners` or `regularizers` contains any
    keys other than 'w' or 'b'.


#### [`nets.AlexNetMini.__call__(inputs, keep_prob=None, is_training=None, test_local_stats=True)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/alexnet.py?l=183)<a id="nets.AlexNetMini.__call__" />

Connects the AlexNet module into the graph.

The is_training flag only controls the batch norm settings, if `False` it
does not force no dropout by overriding any input `keep_prob`. To avoid any
confusion this may cause, if `is_training=False` and `keep_prob` would cause
dropout to be applied, an error is thrown.

##### Args:


* `inputs`: A Tensor of size [batch_size, input_height, input_width,
    input_channels], representing a batch of input images.
* `keep_prob`: A scalar Tensor representing the dropout keep probability.
    When `is_training=False` this must be None or 1 to give no dropout.
* `is_training`: Boolean to indicate if we are currently training. Must be
      specified if batch normalization or dropout is used.
* `test_local_stats`: Boolean to indicate to `snt.BatchNorm` if batch
    normalization should  use local batch statistics at test time.
    By default `True`.

##### Returns:

  A Tensor of size [batch_size, output_size], where `output_size` depends
  on the mode the network was constructed in.

##### Raises:

  base.IncompatibleShapeError: If any of the input image dimensions
    (input_height, input_width) are too small for the given network mode.

* `ValueError`: If `keep_prob` is not None or 1 when `is_training=False`.
* `ValueError`: If `is_training` is not explicitly specified when using
    batch normalization.


#### [`nets.AlexNetMini.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="nets.AlexNetMini.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`nets.AlexNetMini.conv_modules`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/alexnet.py?l=319)<a id="nets.AlexNetMini.conv_modules" />

Returns list containing convolutional modules of network.

##### Returns:

  A list containing the Conv2D modules.


#### [`nets.AlexNetMini.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="nets.AlexNetMini.defun" />

Wraps this modules call method in a callable graph function.


#### [`nets.AlexNetMini.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="nets.AlexNetMini.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`nets.AlexNetMini.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="nets.AlexNetMini.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.AlexNetMini.get_possible_initializer_keys()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=505)<a id="nets.AlexNetMini.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`nets.AlexNetMini.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="nets.AlexNetMini.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.AlexNetMini.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="nets.AlexNetMini.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`nets.AlexNetMini.initializers`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/alexnet.py?l=295)<a id="nets.AlexNetMini.initializers" />




#### [`nets.AlexNetMini.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="nets.AlexNetMini.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`nets.AlexNetMini.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="nets.AlexNetMini.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.AlexNetMini.linear_modules`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/alexnet.py?l=330)<a id="nets.AlexNetMini.linear_modules" />

Returns list containing linear modules of network.

##### Returns:

  A list containing the Linear modules.


#### [`nets.AlexNetMini.min_input_size`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/alexnet.py?l=307)<a id="nets.AlexNetMini.min_input_size" />

Returns integer specifying the minimum width and height for the input.

Note that the input can be non-square, but both the width and height must
be >= this number in size.

##### Returns:

  The minimum size as an integer.


#### [`nets.AlexNetMini.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="nets.AlexNetMini.module_name" />

Returns the name of the Module.


#### [`nets.AlexNetMini.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="nets.AlexNetMini.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`nets.AlexNetMini.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="nets.AlexNetMini.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.AlexNetMini.partitioners`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/alexnet.py?l=299)<a id="nets.AlexNetMini.partitioners" />




#### [`nets.AlexNetMini.regularizers`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/alexnet.py?l=303)<a id="nets.AlexNetMini.regularizers" />




#### [`nets.AlexNetMini.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="nets.AlexNetMini.scope_name" />

Returns the full name of the Module's variable scope.


#### [`nets.AlexNetMini.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="nets.AlexNetMini.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.AlexNetMini.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="nets.AlexNetMini.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.AlexNetMini.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="nets.AlexNetMini.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.



### [`class nets.ConvNet2D`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/convnet.py?q=class:ConvNet2D)<a id="nets.ConvNet2D" />

A 2D Convolutional Network module.

#### [`nets.ConvNet2D.__init__(output_channels, kernel_shapes, strides, paddings, rates=(1,), activation=<function relu>, activate_final=False, normalization_ctor=None, normalization_kwargs=None, normalize_final=None, initializers=None, partitioners=None, regularizers=None, use_batch_norm=None, use_bias=True, batch_norm_config=None, data_format='NHWC', custom_getter=None, name='conv_net_2d')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/convnet.py?l=51)<a id="nets.ConvNet2D.__init__" />

Constructs a `ConvNet2D` module.

By default, neither batch normalization nor activation are applied to the
output of the final layer.

##### Args:


* `output_channels`: Iterable of output channels, as defined in
    `conv.Conv2D`. Output channels can be defined either as number or via a
    callable. In the latter case, since the function invocation is deferred
    to graph construction time, the user must only ensure that entries can
    be called when build is called. Each entry in the iterable defines
    properties in the corresponding convolutional layer.
* `kernel_shapes`: Iterable of kernel sizes as defined in `conv.Conv2D`; if
    the list contains one element only, the same kernel shape is used in
    each layer of the network.
* `strides`: Iterable of kernel strides as defined in `conv.Conv2D`; if the
    list contains one element only, the same stride is used in each layer of
    the network.
* `paddings`: Iterable of padding options as defined in `conv.Conv2D`. Each
    can be `snt.SAME`, `snt.VALID`, `snt.FULL`, `snt.CAUSAL`,
    `snt.REVERSE_CAUSAL` or a pair of these to use for height and width.
    If the Iterable contains one element only, the same padding is used in
    each layer of the network.
* `rates`: Iterable of dilation rates as defined in `conv.Conv2D`; if the
    list contains one element only, the same rate is used in each layer of
    the network.
* `activation`: An activation op.
* `activate_final`: Boolean determining if the activation and batch
    normalization, if turned on, are applied to the final layer.
* `normalization_ctor`: Constructor to return a callable which will perform
    normalization at each layer. Defaults to None / no normalization.
    Examples of what could go here: `snt.BatchNormV2`, `snt.LayerNorm`. If
    a string is provided, importlib is used to convert the string to a
    callable, so either `snt.LayerNorm` or `"snt.LayerNorm"` can be
    provided.
* `normalization_kwargs`: kwargs to be provided to `normalization_ctor` when
    it is called.
* `normalize_final`: Whether to apply normalization after the final conv
    layer. Default is to take the value of activate_final.
* `initializers`: Optional dict containing ops to initialize the filters of
    the whole network (with key 'w') or biases (with key 'b').
* `partitioners`: Optional dict containing partitioners to partition
      weights (with key 'w') or biases (with key 'b'). As a default, no
      partitioners are used.
* `regularizers`: Optional dict containing regularizers for the filters of the
    whole network (with key 'w') or biases (with key 'b'). As a default, no
    regularizers are used. A regularizer should be a function that takes a
    single `Tensor` as an input and returns a scalar `Tensor` output, e.g.
    the L1 and L2 regularizers in `tf.contrib.layers`.
* `use_batch_norm`: Boolean determining if batch normalization is applied
    after convolution. Deprecated, use `normalization_ctor` instead.
* `use_bias`: Boolean or iterable of booleans determining whether to include
    bias parameters in the convolutional layers. Default `True`.
* `batch_norm_config`: Optional mapping of additional configuration for the
    `snt.BatchNorm` modules. Deprecated, use `normalization_kwargs` instead.
* `data_format`: A string, one of "NCHW" or "NHWC". Specifies whether the
    channel dimension of the input and output is the last dimension
    (default, "NHWC"), or the second dimension ("NCHW").
* `custom_getter`: Callable or dictionary of callables to use as
    custom getters inside the module. If a dictionary, the keys
    correspond to regexes to match variable names. See the
    `tf.get_variable` documentation for information about the
    custom_getter API. Note that this `custom_getter` will not be passed
    to the `transpose` method. If you want to use a custom getter with
    the transposed of this convolutional network, you should provide one
    to the `transpose` method instead.
* `name`: Name of the module.

##### Raises:


* `TypeError`: If `output_channels` is not iterable; or if `kernel_shapes` is
    not iterable; or `strides` is not iterable; or `paddings` is not
    iterable; or if `activation` is not callable.
* `ValueError`: If `output_channels` is empty; or if `kernel_shapes` has not
    length 1 or `len(output_channels)`; or if `strides` has not
    length 1 or `len(output_channels)`; or if `paddings` has not
    length 1 or `len(output_channels)`; or if `rates` has not
    length 1 or `len(output_channels)`; or if the given data_format is not a
    supported format ("NHWC" or "NCHW"); or if `normalization_ctor` is
    provided but cannot be mapped to a callable.
* `KeyError`: If `initializers`, `partitioners` or `regularizers` contain any
    keys other than 'w' or 'b'.
* `TypeError`: If any of the given initializers, partitioners or regularizers
    are not callable.


#### [`nets.ConvNet2D.__call__(inputs, **normalization_build_kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/convnet.py?l=311)<a id="nets.ConvNet2D.__call__" />

Assembles the `ConvNet2D` and connects it to the graph.

##### Args:


* `inputs`: A 4D Tensor of shape `[batch_size, input_height, input_width,
    input_channels]`.
* `**normalization_build_kwargs`: kwargs passed to the normalization module
    at _build time.

##### Returns:

  A 4D Tensor of shape `[batch_size, output_height, output_width,
    output_channels[-1]]`.

##### Raises:


* `ValueError`: If `is_training` is not explicitly specified when using
    batch normalization.


#### [`nets.ConvNet2D.activate_final`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/convnet.py?l=434)<a id="nets.ConvNet2D.activate_final" />




#### [`nets.ConvNet2D.activation`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/convnet.py?l=430)<a id="nets.ConvNet2D.activation" />




#### [`nets.ConvNet2D.batch_norm_config`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/convnet.py?l=411)<a id="nets.ConvNet2D.batch_norm_config" />




#### [`nets.ConvNet2D.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="nets.ConvNet2D.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`nets.ConvNet2D.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="nets.ConvNet2D.defun" />

Wraps this modules call method in a callable graph function.


#### [`nets.ConvNet2D.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="nets.ConvNet2D.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`nets.ConvNet2D.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="nets.ConvNet2D.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.ConvNet2D.get_possible_initializer_keys()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=505)<a id="nets.ConvNet2D.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`nets.ConvNet2D.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="nets.ConvNet2D.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.ConvNet2D.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="nets.ConvNet2D.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`nets.ConvNet2D.initializers`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/convnet.py?l=368)<a id="nets.ConvNet2D.initializers" />




#### [`nets.ConvNet2D.input_shape`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/convnet.py?l=439)<a id="nets.ConvNet2D.input_shape" />

Returns shape of input `Tensor` passed at last call to `build`.


#### [`nets.ConvNet2D.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="nets.ConvNet2D.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`nets.ConvNet2D.kernel_shapes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/convnet.py?l=392)<a id="nets.ConvNet2D.kernel_shapes" />




#### [`nets.ConvNet2D.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="nets.ConvNet2D.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.ConvNet2D.layers`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/convnet.py?l=363)<a id="nets.ConvNet2D.layers" />

Returns a tuple containing the convolutional layers of the network.


#### [`nets.ConvNet2D.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="nets.ConvNet2D.module_name" />

Returns the name of the Module.


#### [`nets.ConvNet2D.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="nets.ConvNet2D.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`nets.ConvNet2D.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="nets.ConvNet2D.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.ConvNet2D.normalization_ctor`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/convnet.py?l=418)<a id="nets.ConvNet2D.normalization_ctor" />




#### [`nets.ConvNet2D.normalization_kwargs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/convnet.py?l=422)<a id="nets.ConvNet2D.normalization_kwargs" />




#### [`nets.ConvNet2D.normalize_final`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/convnet.py?l=426)<a id="nets.ConvNet2D.normalize_final" />




#### [`nets.ConvNet2D.output_channels`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/convnet.py?l=396)<a id="nets.ConvNet2D.output_channels" />




#### [`nets.ConvNet2D.paddings`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/convnet.py?l=384)<a id="nets.ConvNet2D.paddings" />




#### [`nets.ConvNet2D.partitioners`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/convnet.py?l=372)<a id="nets.ConvNet2D.partitioners" />




#### [`nets.ConvNet2D.rates`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/convnet.py?l=388)<a id="nets.ConvNet2D.rates" />




#### [`nets.ConvNet2D.regularizers`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/convnet.py?l=376)<a id="nets.ConvNet2D.regularizers" />




#### [`nets.ConvNet2D.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="nets.ConvNet2D.scope_name" />

Returns the full name of the Module's variable scope.


#### [`nets.ConvNet2D.strides`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/convnet.py?l=380)<a id="nets.ConvNet2D.strides" />




#### [`nets.ConvNet2D.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="nets.ConvNet2D.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.ConvNet2D.transpose(name=None, output_channels=None, kernel_shapes=None, strides=None, paddings=None, activation=None, activate_final=None, normalization_ctor=None, normalization_kwargs=None, normalize_final=None, initializers=None, partitioners=None, regularizers=None, use_batch_norm=None, use_bias=None, batch_norm_config=None, data_format=None, custom_getter=None)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/convnet.py?l=588)<a id="nets.ConvNet2D.transpose" />

Returns transposed version of this network.

##### Args:


* `name`: Optional string specifying the name of the transposed module. The
    default name is constructed by appending "_transpose"
    to `self.module_name`.
* `output_channels`: Optional iterable of numbers of output channels.
* `kernel_shapes`: Optional iterable of kernel sizes. The default value is
    constructed by reversing `self.kernel_shapes`.
* `strides`: Optional iterable of kernel strides. The default value is
    constructed by reversing `self.strides`.
* `paddings`: Optional iterable of padding options, either `snt.SAME` or
    `snt.VALID`; The default value is constructed by reversing
    `self.paddings`.
* `activation`: Optional activation op. Default value is `self.activation`.
* `activate_final`: Optional boolean determining if the activation and batch
    normalization, if turned on, are applied to the final layer.
* `normalization_ctor`: Constructor to return a callable which will perform
    normalization at each layer. Defaults to None / no normalization.
    Examples of what could go here: `snt.BatchNormV2`, `snt.LayerNorm`. If
    a string is provided, importlib is used to convert the string to a
    callable, so either `snt.LayerNorm` or `"snt.LayerNorm"` can be
    provided.
* `normalization_kwargs`: kwargs to be provided to `normalization_ctor` when
    it is called.
* `normalize_final`: Whether to apply normalization after the final conv
    layer. Default is to take the value of activate_final.
* `initializers`: Optional dict containing ops to initialize the filters of
    the whole network (with key 'w') or biases (with key 'b'). The default
    value is `self.initializers`.
* `partitioners`: Optional dict containing partitioners to partition
    weights (with key 'w') or biases (with key 'b'). The default value is
    `self.partitioners`.
* `regularizers`: Optional dict containing regularizers for the filters of the
    whole network (with key 'w') or biases (with key 'b'). The default is
    `self.regularizers`.
* `use_batch_norm`: Optional boolean determining if batch normalization is
    applied after convolution. The default value is `self.use_batch_norm`.
* `use_bias`: Optional boolean or iterable of booleans determining whether to
    include bias parameters in the convolutional layers. Default
    is constructed by reversing `self.use_bias`.
* `batch_norm_config`: Optional mapping of additional configuration for the
    `snt.BatchNorm` modules. Default is `self.batch_norm_config`.
* `data_format`: Optional string, one of "NCHW" or "NHWC". Specifies whether
    the channel dimension of the input and output is the last dimension.
    Default is `self._data_format`.
* `custom_getter`: Callable or dictionary of callables to use as
    custom getters inside the module. If a dictionary, the keys
    correspond to regexes to match variable names. See the
    `tf.get_variable` documentation for information about the
    custom_getter API.

##### Returns:

  Matching `ConvNet2DTranspose` module.

##### Raises:


* `ValueError`: If output_channels is specified and its length does not match
    the number of layers.
* `ValueError`: If the given data_format is not a supported format ("NHWC" or
    "NCHW").
* `NotImplementedError`: If the convolutions are dilated.


#### [`nets.ConvNet2D.use_batch_norm`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/convnet.py?l=404)<a id="nets.ConvNet2D.use_batch_norm" />




#### [`nets.ConvNet2D.use_bias`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/convnet.py?l=400)<a id="nets.ConvNet2D.use_bias" />




#### [`nets.ConvNet2D.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="nets.ConvNet2D.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.ConvNet2D.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="nets.ConvNet2D.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.



### [`class nets.ConvNet2DTranspose`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/convnet.py?q=class:ConvNet2DTranspose)<a id="nets.ConvNet2DTranspose" />

A 2D Transpose-Convolutional Network module.

#### [`nets.ConvNet2DTranspose.__init__(output_channels, output_shapes, kernel_shapes, strides, paddings, activation=<function relu>, activate_final=False, normalization_ctor=None, normalization_kwargs=None, normalize_final=None, initializers=None, partitioners=None, regularizers=None, use_batch_norm=False, use_bias=True, batch_norm_config=None, data_format='NHWC', custom_getter=None, name='conv_net_2d_transpose')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/convnet.py?l=718)<a id="nets.ConvNet2DTranspose.__init__" />

Constructs a `ConvNetTranspose2D` module.

`output_{shapes,channels}` can be defined either as iterable of
{iterables,integers} or via a callable. In the latter case, since the
function invocation is deferred to graph construction time, the user
must only ensure that entries can be called returning meaningful values when
build is called. Each entry in the iterable defines properties in the
corresponding convolutional layer.

By default, neither batch normalization nor activation are applied to the
output of the final layer.

##### Args:


* `output_channels`: Iterable of numbers of output channels.
* `output_shapes`: Iterable of output shapes as defined in
    `conv.conv2DTranpose`; if the iterable contains one element only, the
    same shape is used in each layer of the network.
* `kernel_shapes`: Iterable of kernel sizes as defined in `conv.Conv2D`; if
    the list contains one element only, the same kernel shape is used in
    each layer of the network.
* `strides`: Iterable of kernel strides as defined in `conv.Conv2D`; if the
    list contains one element only, the same stride is used in each layer of
    the network.
* `paddings`: Iterable of padding options, either `snt.SAME` or
    `snt.VALID`; if the Iterable contains one element only, the same padding
    is used in each layer of the network.
* `activation`: An activation op.
* `activate_final`: Boolean determining if the activation and batch
    normalization, if turned on, are applied to the final layer.
* `normalization_ctor`: Constructor to return a callable which will perform
    normalization at each layer. Defaults to None / no normalization.
    Examples of what could go here: `snt.BatchNormV2`, `snt.LayerNorm`. If
    a string is provided, importlib is used to convert the string to a
    callable, so either `snt.LayerNorm` or `"snt.LayerNorm"` can be
    provided.
* `normalization_kwargs`: kwargs to be provided to `normalization_ctor` when
    it is called.
* `normalize_final`: Whether to apply normalization after the final conv
    layer. Default is to take the value of activate_final.
* `initializers`: Optional dict containing ops to initialize the filters of
    the whole network (with key 'w') or biases (with key 'b').
* `partitioners`: Optional dict containing partitioners to partition
      weights (with key 'w') or biases (with key 'b'). As a default, no
      partitioners are used.
* `regularizers`: Optional dict containing regularizers for the filters of the
    whole network (with key 'w') or biases (with key 'b'). As a default, no
    regularizers are used. A regularizer should be a function that takes a
    single `Tensor` as an input and returns a scalar `Tensor` output, e.g.
    the L1 and L2 regularizers in `tf.contrib.layers`.
* `use_batch_norm`: Boolean determining if batch normalization is applied
    after convolution.
* `use_bias`: Boolean or iterable of booleans determining whether to include
    bias parameters in the convolutional layers. Default `True`.
* `batch_norm_config`: Optional mapping of additional configuration for the
    `snt.BatchNorm` modules.
* `data_format`: A string, one of "NCHW" or "NHWC". Specifies whether the
    channel dimension of the input and output is the last dimension
    (default, "NHWC"), or the second dimension ("NCHW").
* `custom_getter`: Callable or dictionary of callables to use as
    custom getters inside the module. If a dictionary, the keys
    correspond to regexes to match variable names. See the
    `tf.get_variable` documentation for information about the
    custom_getter API.
* `name`: Name of the module.

##### Raises:


* `TypeError`: If `output_channels` is not iterable; or if `output_shapes`
    is not iterable; or if `kernel_shapes` is not iterable; or if `strides`
    is not iterable; or if `paddings` is not iterable; or if `activation` is
    not callable.
* `ValueError`: If `output_channels` is empty; or if `kernel_shapes` has not
    length 1 or `len(output_channels)`; or if `strides` has not
    length 1 or `len(output_channels)`; or if `paddings` has not
    length 1 or `len(output_channels)`.
* `ValueError`: If the given data_format is not a supported format ("NHWC" or
    "NCHW").
* `ValueError`: If `normalization_ctor` is provided but cannot be converted
    to a callable.
* `KeyError`: If `initializers`, `partitioners` or `regularizers` contain any
    keys other than 'w' or 'b'.
* `TypeError`: If any of the given initializers, partitioners or regularizers
    are not callable.


#### [`nets.ConvNet2DTranspose.__call__(inputs, **normalization_build_kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/convnet.py?l=311)<a id="nets.ConvNet2DTranspose.__call__" />

Assembles the `ConvNet2D` and connects it to the graph.

##### Args:


* `inputs`: A 4D Tensor of shape `[batch_size, input_height, input_width,
    input_channels]`.
* `**normalization_build_kwargs`: kwargs passed to the normalization module
    at _build time.

##### Returns:

  A 4D Tensor of shape `[batch_size, output_height, output_width,
    output_channels[-1]]`.

##### Raises:


* `ValueError`: If `is_training` is not explicitly specified when using
    batch normalization.


#### [`nets.ConvNet2DTranspose.activate_final`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/convnet.py?l=434)<a id="nets.ConvNet2DTranspose.activate_final" />




#### [`nets.ConvNet2DTranspose.activation`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/convnet.py?l=430)<a id="nets.ConvNet2DTranspose.activation" />




#### [`nets.ConvNet2DTranspose.batch_norm_config`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/convnet.py?l=411)<a id="nets.ConvNet2DTranspose.batch_norm_config" />




#### [`nets.ConvNet2DTranspose.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="nets.ConvNet2DTranspose.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`nets.ConvNet2DTranspose.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="nets.ConvNet2DTranspose.defun" />

Wraps this modules call method in a callable graph function.


#### [`nets.ConvNet2DTranspose.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="nets.ConvNet2DTranspose.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`nets.ConvNet2DTranspose.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="nets.ConvNet2DTranspose.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.ConvNet2DTranspose.get_possible_initializer_keys()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=505)<a id="nets.ConvNet2DTranspose.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`nets.ConvNet2DTranspose.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="nets.ConvNet2DTranspose.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.ConvNet2DTranspose.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="nets.ConvNet2DTranspose.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`nets.ConvNet2DTranspose.initializers`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/convnet.py?l=368)<a id="nets.ConvNet2DTranspose.initializers" />




#### [`nets.ConvNet2DTranspose.input_shape`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/convnet.py?l=439)<a id="nets.ConvNet2DTranspose.input_shape" />

Returns shape of input `Tensor` passed at last call to `build`.


#### [`nets.ConvNet2DTranspose.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="nets.ConvNet2DTranspose.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`nets.ConvNet2DTranspose.kernel_shapes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/convnet.py?l=392)<a id="nets.ConvNet2DTranspose.kernel_shapes" />




#### [`nets.ConvNet2DTranspose.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="nets.ConvNet2DTranspose.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.ConvNet2DTranspose.layers`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/convnet.py?l=363)<a id="nets.ConvNet2DTranspose.layers" />

Returns a tuple containing the convolutional layers of the network.


#### [`nets.ConvNet2DTranspose.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="nets.ConvNet2DTranspose.module_name" />

Returns the name of the Module.


#### [`nets.ConvNet2DTranspose.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="nets.ConvNet2DTranspose.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`nets.ConvNet2DTranspose.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="nets.ConvNet2DTranspose.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.ConvNet2DTranspose.normalization_ctor`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/convnet.py?l=418)<a id="nets.ConvNet2DTranspose.normalization_ctor" />




#### [`nets.ConvNet2DTranspose.normalization_kwargs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/convnet.py?l=422)<a id="nets.ConvNet2DTranspose.normalization_kwargs" />




#### [`nets.ConvNet2DTranspose.normalize_final`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/convnet.py?l=426)<a id="nets.ConvNet2DTranspose.normalize_final" />




#### [`nets.ConvNet2DTranspose.output_channels`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/convnet.py?l=396)<a id="nets.ConvNet2DTranspose.output_channels" />




#### [`nets.ConvNet2DTranspose.output_shapes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/convnet.py?l=875)<a id="nets.ConvNet2DTranspose.output_shapes" />




#### [`nets.ConvNet2DTranspose.paddings`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/convnet.py?l=384)<a id="nets.ConvNet2DTranspose.paddings" />




#### [`nets.ConvNet2DTranspose.partitioners`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/convnet.py?l=372)<a id="nets.ConvNet2DTranspose.partitioners" />




#### [`nets.ConvNet2DTranspose.rates`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/convnet.py?l=388)<a id="nets.ConvNet2DTranspose.rates" />




#### [`nets.ConvNet2DTranspose.regularizers`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/convnet.py?l=376)<a id="nets.ConvNet2DTranspose.regularizers" />




#### [`nets.ConvNet2DTranspose.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="nets.ConvNet2DTranspose.scope_name" />

Returns the full name of the Module's variable scope.


#### [`nets.ConvNet2DTranspose.strides`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/convnet.py?l=380)<a id="nets.ConvNet2DTranspose.strides" />




#### [`nets.ConvNet2DTranspose.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="nets.ConvNet2DTranspose.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.ConvNet2DTranspose.transpose(name=None, output_channels=None, kernel_shapes=None, strides=None, paddings=None, activation=None, activate_final=None, normalization_ctor=None, normalization_kwargs=None, normalize_final=None, initializers=None, partitioners=None, regularizers=None, use_batch_norm=None, use_bias=None, batch_norm_config=None, data_format=None, custom_getter=None)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/convnet.py?l=880)<a id="nets.ConvNet2DTranspose.transpose" />

Returns transposed version of this network.

##### Args:


* `name`: Optional string specifying the name of the transposed module. The
    default name is constructed by appending "_transpose"
    to `self.module_name`.
* `output_channels`: Optional iterable of numbers of output channels.
* `kernel_shapes`: Optional iterable of kernel sizes. The default value is
    constructed by reversing `self.kernel_shapes`.
* `strides`: Optional iterable of kernel strides. The default value is
    constructed by reversing `self.strides`.
* `paddings`: Optional iterable of padding options, either `snt.SAME` or
    `snt.VALID`; The default value is constructed by reversing
    `self.paddings`.
* `activation`: Optional activation op. Default value is `self.activation`.
* `activate_final`: Optional boolean determining if the activation and batch
    normalization, if turned on, are applied to the final layer.
* `normalization_ctor`: Constructor to return a callable which will perform
    normalization at each layer. Defaults to None / no normalization.
    Examples of what could go here: `snt.BatchNormV2`, `snt.LayerNorm`. If
    a string is provided, importlib is used to convert the string to a
    callable, so either `snt.LayerNorm` or `"snt.LayerNorm"` can be
    provided.
* `normalization_kwargs`: kwargs to be provided to `normalization_ctor` when
    it is called.
* `normalize_final`: Whether to apply normalization after the final conv
    layer. Default is to take the value of activate_final.
* `initializers`: Optional dict containing ops to initialize the filters of
    the whole network (with key 'w') or biases (with key 'b'). The default
    value is `self.initializers`.
* `partitioners`: Optional dict containing partitioners to partition
    weights (with key 'w') or biases (with key 'b'). The default value is
    `self.partitioners`.
* `regularizers`: Optional dict containing regularizers for the filters of the
    whole network (with key 'w') or biases (with key 'b'). The default is
    `self.regularizers`.
* `use_batch_norm`: Optional boolean determining if batch normalization is
    applied after convolution. The default value is `self.use_batch_norm`.
* `use_bias`: Optional boolean or iterable of booleans determining whether to
    include bias parameters in the convolutional layers. Default
    is constructed by reversing `self.use_bias`.
* `batch_norm_config`: Optional mapping of additional configuration for the
    `snt.BatchNorm` modules. Default is `self.batch_norm_config`.
* `data_format`: Optional string, one of "NCHW" or "NHWC". Specifies whether
    the channel dimension of the input and output is the last dimension.
    Default is `self._data_format`.
* `custom_getter`: Callable or dictionary of callables to use as
    custom getters inside the module. If a dictionary, the keys
    correspond to regexes to match variable names. See the
    `tf.get_variable` documentation for information about the
    custom_getter API.

##### Returns:

  Matching `ConvNet2D` module.

##### Raises:


* `ValueError`: If output_channels is specified and its length does not match
    the number of layers.


#### [`nets.ConvNet2DTranspose.use_batch_norm`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/convnet.py?l=404)<a id="nets.ConvNet2DTranspose.use_batch_norm" />




#### [`nets.ConvNet2DTranspose.use_bias`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/convnet.py?l=400)<a id="nets.ConvNet2DTranspose.use_bias" />




#### [`nets.ConvNet2DTranspose.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="nets.ConvNet2DTranspose.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.ConvNet2DTranspose.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="nets.ConvNet2DTranspose.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.



### [`class nets.Dilation`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/dilation.py?q=class:Dilation)<a id="nets.Dilation" />

A convolutional module for per-pixel classification.

Consists of 8 convolutional layers, 4 of which are dilated. When applied to
the output of a model like VGG-16 (before fully connected layers), can be used
to make predictions on a per-pixel basis.

Note that the default initializers for the 'basic' model size require that
the number of input channels be equal to the number of output classes, and the
initializers for the 'large' model require it be a multiple.

Based on:
  'Multi-Scale Context Aggregation by Dilated Convolutions'
  Fisher Yu, Vladlen Koltun, ICLR 2016
  https://arxiv.org/abs/1511.07122

Properties:
  conv_modules: list of sonnet modules. The 8 convolution layers used in the
    Dilation module.

#### [`nets.Dilation.__init__(num_output_classes, initializers=None, regularizers=None, model_size='basic', name='dilation')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/dilation.py?l=227)<a id="nets.Dilation.__init__" />

Creates a dilation module.

##### Args:


* `num_output_classes`: Int. Number of output classes to predict for
    each pixel in an image.
* `initializers`: Optional dict containing ops to initialize filters (with key
    'w') or biases (with key 'b'). The default initializer makes this module
    equivalent to the identity.
* `regularizers`: Optional dict containing regularizers for the weights
    (with key 'w') or biases (with key 'b'). As a default, no regularizers
    are used. A regularizer should be a function that takes a single
    `Tensor` as an input and returns a scalar `Tensor` output, e.g. the L1
    and L2 regularizers in `tf.contrib.layers`.
* `model_size`: string. One of 'basic' or 'large'.
* `name`: string. Name of module.


#### [`nets.Dilation.__call__(images)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/dilation.py?l=257)<a id="nets.Dilation.__call__" />

Build dilation module.

##### Args:


* `images`: Tensor of shape [batch_size, height, width, depth]
    and dtype float32. Represents a set of images with an arbitrary depth.
    Note that when using the default initializer, depth must equal
    num_output_classes.

##### Returns:

  Tensor of shape [batch_size, height, width, num_output_classes] and dtype
    float32. Represents, for each image and pixel, logits for per-class
    predictions.

##### Raises:


* `IncompatibleShapeError`: If images is not rank 4.
* `ValueError`: If model_size is not one of 'basic' or 'large'.


#### [`nets.Dilation.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="nets.Dilation.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`nets.Dilation.conv_modules`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/dilation.py?l=347)<a id="nets.Dilation.conv_modules" />




#### [`nets.Dilation.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="nets.Dilation.defun" />

Wraps this modules call method in a callable graph function.


#### [`nets.Dilation.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="nets.Dilation.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`nets.Dilation.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="nets.Dilation.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.Dilation.get_possible_initializer_keys()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=505)<a id="nets.Dilation.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`nets.Dilation.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="nets.Dilation.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.Dilation.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="nets.Dilation.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`nets.Dilation.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="nets.Dilation.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`nets.Dilation.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="nets.Dilation.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.Dilation.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="nets.Dilation.module_name" />

Returns the name of the Module.


#### [`nets.Dilation.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="nets.Dilation.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`nets.Dilation.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="nets.Dilation.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.Dilation.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="nets.Dilation.scope_name" />

Returns the full name of the Module's variable scope.


#### [`nets.Dilation.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="nets.Dilation.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.Dilation.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="nets.Dilation.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.Dilation.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="nets.Dilation.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.



### [`class nets.MLP`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/mlp.py?q=class:MLP)<a id="nets.MLP" />

A Multi-Layer perceptron module.

#### [`nets.MLP.__init__(output_sizes, activation=<function relu>, activate_final=False, initializers=None, partitioners=None, regularizers=None, use_bias=True, use_dropout=False, custom_getter=None, name='mlp')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/mlp.py?l=38)<a id="nets.MLP.__init__" />

Constructs an MLP module.

##### Args:


* `output_sizes`: An iterable of output dimensionalities as defined in
    `basic.Linear`. Output size can be defined either as number or via a
    callable. In the latter case, since the function invocation is deferred
    to graph construction time, the user must only ensure that entries can
    be called when build is called. Each entry in the iterable defines
    properties in the corresponding linear layer.
* `activation`: An activation op. The activation is applied to intermediate
    layers, and optionally to the output of the final layer.
* `activate_final`: Boolean determining if the activation is applied to
    the output of the final layer. Default `False`.
* `initializers`: Optional dict containing ops to initialize the linear
    layers' weights (with key 'w') or biases (with key 'b').
* `partitioners`: Optional dict containing partitioners to partition the
    linear layers' weights (with key 'w') or biases (with key 'b').
* `regularizers`: Optional dict containing regularizers for the linear layers'
    weights (with key 'w') and the biases (with key 'b'). As a default, no
    regularizers are used. A regularizer should be a function that takes
    a single `Tensor` as an input and returns a scalar `Tensor` output, e.g.
    the L1 and L2 regularizers in `tf.contrib.layers`.
* `use_bias`: Whether to include bias parameters in the linear layers.
    Default `True`.
* `use_dropout`: Whether to perform dropout on the linear layers.
    Default `False`.
* `custom_getter`: Callable or dictionary of callables to use as
    custom getters inside the module. If a dictionary, the keys
    correspond to regexes to match variable names. See the `tf.get_variable`
    documentation for information about the custom_getter API.
* `name`: Name of the module.

##### Raises:


* `KeyError`: If initializers contains any keys other than 'w' or 'b'.
* `KeyError`: If regularizers contains any keys other than 'w' or 'b'.
* `ValueError`: If output_sizes is empty.
* `TypeError`: If `activation` is not callable; or if `output_sizes` is not
    iterable.


#### [`nets.MLP.__call__(inputs, is_training=True, dropout_keep_prob=0.5)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/mlp.py?l=150)<a id="nets.MLP.__call__" />

Assembles the `MLP` and connects it to the graph.

##### Args:


* `inputs`: A 2D Tensor of size `[batch_size, input_size]`.
* `is_training`: A bool or tf.Bool Tensor. Indicates whether we are
    currently training. Defaults to `True`.
* `dropout_keep_prob`: The probability that each element is kept when
    both `use_dropout` and `is_training` are True. Defaults to 0.5.

##### Returns:

  A 2D Tensor of size `[batch_size, output_sizes[-1]]`.


#### [`nets.MLP.activate_final`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/mlp.py?l=230)<a id="nets.MLP.activate_final" />




#### [`nets.MLP.activation`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/mlp.py?l=226)<a id="nets.MLP.activation" />




#### [`nets.MLP.clone(name=None)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/mlp.py?l=272)<a id="nets.MLP.clone" />

Creates a new MLP with the same structure.

##### Args:


* `name`: Optional string specifying the name of the new module. The default
    name is constructed by appending "_clone" to the original name.

##### Returns:

  A cloned `MLP` module.


#### [`nets.MLP.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="nets.MLP.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`nets.MLP.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="nets.MLP.defun" />

Wraps this modules call method in a callable graph function.


#### [`nets.MLP.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="nets.MLP.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`nets.MLP.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="nets.MLP.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.MLP.get_possible_initializer_keys(use_bias=True)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/mlp.py?l=146)<a id="nets.MLP.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`nets.MLP.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="nets.MLP.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.MLP.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="nets.MLP.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`nets.MLP.initializers`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/mlp.py?l=211)<a id="nets.MLP.initializers" />

Returns the intializers dictionary.


#### [`nets.MLP.input_shape`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/mlp.py?l=235)<a id="nets.MLP.input_shape" />

Returns shape of input `Tensor` passed at last call to `build`.


#### [`nets.MLP.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="nets.MLP.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`nets.MLP.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="nets.MLP.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.MLP.layers`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/mlp.py?l=181)<a id="nets.MLP.layers" />

Returns a tuple containing the linear layers of the `MLP`.


#### [`nets.MLP.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="nets.MLP.module_name" />

Returns the name of the Module.


#### [`nets.MLP.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="nets.MLP.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`nets.MLP.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="nets.MLP.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.MLP.output_size`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/mlp.py?l=191)<a id="nets.MLP.output_size" />

Returns the size of the module output, not including the batch dimension.

This allows the MLP to be used inside a DeepRNN.

##### Returns:

  The scalar size of the module output.


#### [`nets.MLP.output_sizes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/mlp.py?l=186)<a id="nets.MLP.output_sizes" />

Returns a tuple of all output sizes of all the layers.


#### [`nets.MLP.partitioners`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/mlp.py?l=216)<a id="nets.MLP.partitioners" />

Returns the partitioners dictionary.


#### [`nets.MLP.regularizers`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/mlp.py?l=221)<a id="nets.MLP.regularizers" />

Returns the regularizers dictionary.


#### [`nets.MLP.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="nets.MLP.scope_name" />

Returns the full name of the Module's variable scope.


#### [`nets.MLP.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="nets.MLP.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.MLP.transpose(name=None, activate_final=None)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/mlp.py?l=242)<a id="nets.MLP.transpose" />

Returns transposed `MLP`.

##### Args:


* `name`: Optional string specifying the name of the transposed module. The
    default name is constructed by appending "_transpose"
    to `self.module_name`.
* `activate_final`: Optional boolean determining if the activation and batch
    normalization, if turned on, are applied to the final layer.

##### Returns:

  Matching transposed `MLP` module.


#### [`nets.MLP.use_bias`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/mlp.py?l=203)<a id="nets.MLP.use_bias" />




#### [`nets.MLP.use_dropout`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/mlp.py?l=207)<a id="nets.MLP.use_dropout" />




#### [`nets.MLP.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="nets.MLP.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.MLP.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="nets.MLP.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.



### [`class nets.TransformerTower`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/transformer.py?q=class:TransformerTower)<a id="nets.TransformerTower" />

Transformer tower.

Deep residual network using blocks of attention and MLPs, specified in
Vaswani et al. 2017.

#### [`nets.TransformerTower.__init__(value_size, num_heads, num_layers, causal=True, key_size=None, shared_attention=False, output_size=None, mlp_hidden_sizes=(1024,), dropout_rate=0.1, use_relative_positions=True, clamp_time_range=0, same_attention_length=False, layer_norm='input', name='transformer_tower')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/transformer.py?l=379)<a id="nets.TransformerTower.__init__" />

Initializes TransformerTower.

##### Args:


* `value_size`: dimensionality of values per-head.
* `num_heads`: number of attention heads.
* `num_layers`: number of transformer blocks, where each block contains a
    multi-head attention layer and an MLP.
* `causal`: if True, applies a causal mask.
* `key_size`: optional dimensionality of key size. If unspecified then it is
    set to `value_size`.
* `shared_attention`: if True, attention params are shared across all layers.
* `output_size`: if set, the desired output dimensionality. By default the
    output size is `value_size` x `num_heads`.
* `mlp_hidden_sizes`: tuple containing dimensionality of mlp layer(s). If
    multiple values are specified, the mlp contains multiple layers for each
    transformer block.
* `dropout_rate`: dropout rate applied to hidden activations, attention, and
    positional encodings.
* `use_relative_positions`: if False, applies absolute positional encodings.
    If true, uses relative positional encodings from Dai et al. 2019.
* `clamp_time_range`: clamps max temporal positional encoding if specified.
* `same_attention_length`: if True, attention is masked to ensure each
    position in the sequence contains the same length of attention.
* `layer_norm`: Where to apply layer-norm in Transformer block. Can be one of
    'input' (Vaswani et al. 2017), 'output', or 'both'.
* `name`: name of variable scope.


#### [`nets.TransformerTower.__call__(inputs, state=None, condition=None, is_training=True)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/transformer.py?l=468)<a id="nets.TransformerTower.__call__" />

Calculates multi-layer self attention and mlp transformation.

##### Args:


* `inputs`: Tensor of shape [batch_size, num_steps, dim_size].
* `state`: optional tensor of shape [batch_size, memory_size, dim_size].
* `condition`: optional tensor to condition on. The shape is shape
    [batch_size, dim_size].
* `is_training`: If true, dropout is applied.

##### Returns:


* `output`: tensor of shape [batch_size, num_steps, output_dim_size].
* `state`: list of length `num_layers` containing AttentionState tuples.


#### [`nets.TransformerTower.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="nets.TransformerTower.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`nets.TransformerTower.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="nets.TransformerTower.defun" />

Wraps this modules call method in a callable graph function.


#### [`nets.TransformerTower.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="nets.TransformerTower.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`nets.TransformerTower.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="nets.TransformerTower.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.TransformerTower.get_possible_initializer_keys()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=505)<a id="nets.TransformerTower.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`nets.TransformerTower.get_sublayers(is_training)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/transformer.py?l=446)<a id="nets.TransformerTower.get_sublayers" />




#### [`nets.TransformerTower.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="nets.TransformerTower.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.TransformerTower.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="nets.TransformerTower.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`nets.TransformerTower.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="nets.TransformerTower.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`nets.TransformerTower.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="nets.TransformerTower.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.TransformerTower.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="nets.TransformerTower.module_name" />

Returns the name of the Module.


#### [`nets.TransformerTower.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="nets.TransformerTower.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`nets.TransformerTower.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="nets.TransformerTower.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.TransformerTower.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="nets.TransformerTower.scope_name" />

Returns the full name of the Module's variable scope.


#### [`nets.TransformerTower.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="nets.TransformerTower.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.TransformerTower.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="nets.TransformerTower.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.TransformerTower.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="nets.TransformerTower.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.



### [`class nets.TransformerXL`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/transformer.py?q=class:TransformerXL)<a id="nets.TransformerXL" />

Transformer with memory of past activations (dai et al. 2019).

The TransformerXL can be used in two modes:

* batched, i.e. when chunk_size > 0. Here the model expects 3D input of size
  `[batch_size, chunk_size, input_dim]`. In practice, the input chunk size
  can be of varying (but statically defined) shape.
* single-step, i.e. when chunk_size = 0. Here the model expects 2D input
  `[batch_size, input_dim]`.

#### [`nets.TransformerXL.__init__(core_config, memory_size, chunk_size, name='transformer_xl')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/transformer.py?l=551)<a id="nets.TransformerXL.__init__" />

Constructs TransformerXL graph.

##### Args:


* `core_config`: dictionary with TransformerTower config.
* `memory_size`: size of memory.
* `chunk_size`: expected chunk size of inputs, if greater than zero inputs are
    of size [batch_size, chunk_size, input_dim]. If equal to zero inputs are
    of size [batch_size, input_dim].
* `name`: name of variable scope.


#### [`nets.TransformerXL.__call__(inputs, prev_state, is_training=True)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/transformer.py?l=580)<a id="nets.TransformerXL.__call__" />

Add elements to the Graph, computing output Tensors from input Tensors.

Subclasses must implement this method, which will be wrapped in a Template.

##### Args:


* `*args`: Input Tensors.
* `**kwargs`: Additional Python flags controlling connection.

##### Returns:

  output Tensor(s).


#### [`nets.TransformerXL.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="nets.TransformerXL.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`nets.TransformerXL.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="nets.TransformerXL.defun" />

Wraps this modules call method in a callable graph function.


#### [`nets.TransformerXL.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="nets.TransformerXL.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`nets.TransformerXL.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="nets.TransformerXL.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.TransformerXL.get_possible_initializer_keys()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=505)<a id="nets.TransformerXL.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`nets.TransformerXL.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="nets.TransformerXL.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.TransformerXL.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="nets.TransformerXL.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`nets.TransformerXL.initial_state(batch_size, dtype=tf.float32, trainable=False, trainable_initializers=None, trainable_regularizers=None, name=None, **unused_kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/rnn_core.py?l=204)<a id="nets.TransformerXL.initial_state" />

Builds the default start state for an RNNCore.

##### Args:


* `batch_size`: An int, or scalar int32 Tensor representing the batch size.
* `dtype`: The data type to use for the state.
* `trainable`: Boolean that indicates whether to learn the initial state.
    Note that intializers and regularizers will be ignored if
    `trainable=False`.
* `trainable_initializers`: An initializer function or nested structure of
      functions with same structure as the `state_size` property of the
      core, to be used as initializers of the initial state variable.
* `trainable_regularizers`: Optional regularizer function or nested structure
    of functions with the same structure as the `state_size` property of the
    core, to be used as regularizers of the initial state variable. As a
    default, no regularizers are used. A regularizer should be a function
    that takes a single `Tensor` as an input and returns a scalar `Tensor`
    output, e.g. the L1 and L2 regularizers in `tf.contrib.layers`.
* `name`: Optional string used to prefix the initial state variable names, in
      the case of a trainable initial state. If not provided, defaults to
      the name of the module.

##### Returns:

  A tensor or nested tuple of tensors with same structure and shape as the
  `state_size` property of the core.

##### Raises:


* `ValueError`: if the user passes initializers that are not functions.
* `ValueError`: if the user passes regularizers that are not functions.


#### [`nets.TransformerXL.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="nets.TransformerXL.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`nets.TransformerXL.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="nets.TransformerXL.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.TransformerXL.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="nets.TransformerXL.module_name" />

Returns the name of the Module.


#### [`nets.TransformerXL.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="nets.TransformerXL.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`nets.TransformerXL.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="nets.TransformerXL.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.TransformerXL.output_size`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/transformer.py?l=614)<a id="nets.TransformerXL.output_size" />

Integer or TensorShape: size of outputs produced by this cell.


#### [`nets.TransformerXL.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="nets.TransformerXL.scope_name" />

Returns the full name of the Module's variable scope.


#### [`nets.TransformerXL.state_size`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/transformer.py?l=609)<a id="nets.TransformerXL.state_size" />

size(s) of state(s) used by this cell.

It can be represented by an Integer, a TensorShape or a tuple of Integers
or TensorShapes.


#### [`nets.TransformerXL.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="nets.TransformerXL.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.TransformerXL.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="nets.TransformerXL.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.TransformerXL.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="nets.TransformerXL.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.TransformerXL.zero_state(batch_size, dtype)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/rnn_core.py?l=260)<a id="nets.TransformerXL.zero_state" />

Return zero-filled state tensor(s).

##### Args:


* `batch_size`: int, float, or unit Tensor representing the batch size.
* `dtype`: the data type to use for the state.

##### Returns:

  If `state_size` is an int or TensorShape, then the return value is a
  `N-D` tensor of shape `[batch_size x state_size]` filled with zeros.

  If `state_size` is a nested list or tuple, then the return value is
  a nested list or tuple (of the same structure) of `2-D` tensors with
  the shapes `[batch_size x s]` for each s in `state_size`.



### [`class nets.VectorQuantizer`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/vqvae.py?q=class:VectorQuantizer)<a id="nets.VectorQuantizer" />

Sonnet module representing the VQ-VAE layer.

Implements the algorithm presented in
'Neural Discrete Representation Learning' by van den Oord et al.
https://arxiv.org/abs/1711.00937

Input any tensor to be quantized. Last dimension will be used as space in
which to quantize. All other dimensions will be flattened and will be seen
as different examples to quantize.

The output tensor will have the same shape as the input.

For example a tensor with shape [16, 32, 32, 64] will be reshaped into
[16384, 64] and all 16384 vectors (each of 64 dimensions)  will be quantized
independently.

Args:
  embedding_dim: integer representing the dimensionality of the tensors in the
    quantized space. Inputs to the modules must be in this format as well.
  num_embeddings: integer, the number of vectors in the quantized space.
  commitment_cost: scalar which controls the weighting of the loss terms
    (see equation 4 in the paper - this variable is Beta).

#### [`nets.VectorQuantizer.__init__(embedding_dim, num_embeddings, commitment_cost, name='vq_layer')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/vqvae.py?l=54)<a id="nets.VectorQuantizer.__init__" />

Performs the initialisation necessary for all AbstractModule instances.

Every subclass of AbstractModule must begin their constructor with a call to
this constructor, i.e.

`super(MySubModule, self).__init__(custom_getter=custom_getter, name=name)`.

If you instantiate sub-modules in __init__ you must create them within the
`_enter_variable_scope` context manager to ensure they are in the module's
variable scope. Alternatively, instantiate sub-modules in `_build`.

##### Args:

  _sentinel: Variable that only carries a non-None value if `__init__` was
      called without named parameters. If this is the case, a deprecation
      warning is issued in form of a `ValueError`.

* `custom_getter`: Callable or dictionary of callables to use as
    custom getters inside the module. If a dictionary, the keys
    correspond to regexes to match variable names. See the `tf.get_variable`
    documentation for information about the custom_getter API.
* `name`: Name of this module. Used to construct the Templated build function.
      If `None` the module's class name is used (converted to snake case).

##### Raises:


* `TypeError`: If `name` is not a string.
* `TypeError`: If a given `custom_getter` is not callable.
* `ValueError`: If `__init__` was called without named arguments.


#### [`nets.VectorQuantizer.__call__(inputs, is_training)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/vqvae.py?l=66)<a id="nets.VectorQuantizer.__call__" />

Connects the module to some inputs.

##### Args:


* `inputs`: Tensor, final dimension must be equal to embedding_dim. All other
    leading dimensions will be flattened and treated as a large batch.
* `is_training`: boolean, whether this connection is to training data.

##### Returns:

  dict containing the following keys and values:

* `quantize`: Tensor containing the quantized version of the input.
* `loss`: Tensor containing the loss to optimize.
* `perplexity`: Tensor containing the perplexity of the encodings.
* `encodings`: Tensor containing the discrete encodings, ie which element
      of the quantized space each input element was mapped to.
* `encoding_indices`: Tensor containing the discrete encoding indices, ie
      which element of the quantized space each input element was mapped to.


#### [`nets.VectorQuantizer.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="nets.VectorQuantizer.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`nets.VectorQuantizer.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="nets.VectorQuantizer.defun" />

Wraps this modules call method in a callable graph function.


#### [`nets.VectorQuantizer.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="nets.VectorQuantizer.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`nets.VectorQuantizer.embeddings`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/vqvae.py?l=114)<a id="nets.VectorQuantizer.embeddings" />




#### [`nets.VectorQuantizer.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="nets.VectorQuantizer.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.VectorQuantizer.get_possible_initializer_keys()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=505)<a id="nets.VectorQuantizer.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`nets.VectorQuantizer.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="nets.VectorQuantizer.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.VectorQuantizer.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="nets.VectorQuantizer.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`nets.VectorQuantizer.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="nets.VectorQuantizer.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`nets.VectorQuantizer.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="nets.VectorQuantizer.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.VectorQuantizer.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="nets.VectorQuantizer.module_name" />

Returns the name of the Module.


#### [`nets.VectorQuantizer.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="nets.VectorQuantizer.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`nets.VectorQuantizer.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="nets.VectorQuantizer.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.VectorQuantizer.quantize(encoding_indices)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/vqvae.py?l=118)<a id="nets.VectorQuantizer.quantize" />




#### [`nets.VectorQuantizer.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="nets.VectorQuantizer.scope_name" />

Returns the full name of the Module's variable scope.


#### [`nets.VectorQuantizer.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="nets.VectorQuantizer.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.VectorQuantizer.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="nets.VectorQuantizer.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.VectorQuantizer.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="nets.VectorQuantizer.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.



### [`class nets.VectorQuantizerEMA`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/vqvae.py?q=class:VectorQuantizerEMA)<a id="nets.VectorQuantizerEMA" />

Sonnet module representing the VQ-VAE layer.

Implements a slightly modified version of the algorithm presented in
'Neural Discrete Representation Learning' by van den Oord et al.
https://arxiv.org/abs/1711.00937

The difference between VectorQuantizerEMA and VectorQuantizer is that
this module uses exponential moving averages to update the embedding vectors
instead of an auxiliary loss. This has the advantage that the embedding
updates are independent of the choice of optimizer (SGD, RMSProp, Adam, K-Fac,
...) used for the encoder, decoder and other parts of the architecture. For
most experiments the EMA version trains faster than the non-EMA version.

Input any tensor to be quantized. Last dimension will be used as space in
which to quantize. All other dimensions will be flattened and will be seen
as different examples to quantize.

The output tensor will have the same shape as the input.

For example a tensor with shape [16, 32, 32, 64] will be reshaped into
[16384, 64] and all 16384 vectors (each of 64 dimensions)  will be quantized
independently.

Args:
  embedding_dim: integer representing the dimensionality of the tensors in the
    quantized space. Inputs to the modules must be in this format as well.
  num_embeddings: integer, the number of vectors in the quantized space.
  commitment_cost: scalar which controls the weighting of the loss terms (see
    equation 4 in the paper).
  decay: float, decay for the moving averages.
  epsilon: small float constant to avoid numerical instability.

#### [`nets.VectorQuantizerEMA.__init__(embedding_dim, num_embeddings, commitment_cost, decay, epsilon=1e-05, name='VectorQuantizerEMA')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/vqvae.py?l=158)<a id="nets.VectorQuantizerEMA.__init__" />

Performs the initialisation necessary for all AbstractModule instances.

Every subclass of AbstractModule must begin their constructor with a call to
this constructor, i.e.

`super(MySubModule, self).__init__(custom_getter=custom_getter, name=name)`.

If you instantiate sub-modules in __init__ you must create them within the
`_enter_variable_scope` context manager to ensure they are in the module's
variable scope. Alternatively, instantiate sub-modules in `_build`.

##### Args:

  _sentinel: Variable that only carries a non-None value if `__init__` was
      called without named parameters. If this is the case, a deprecation
      warning is issued in form of a `ValueError`.

* `custom_getter`: Callable or dictionary of callables to use as
    custom getters inside the module. If a dictionary, the keys
    correspond to regexes to match variable names. See the `tf.get_variable`
    documentation for information about the custom_getter API.
* `name`: Name of this module. Used to construct the Templated build function.
      If `None` the module's class name is used (converted to snake case).

##### Raises:


* `TypeError`: If `name` is not a string.
* `TypeError`: If a given `custom_getter` is not callable.
* `ValueError`: If `__init__` was called without named arguments.


#### [`nets.VectorQuantizerEMA.__call__(inputs, is_training)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/vqvae.py?l=181)<a id="nets.VectorQuantizerEMA.__call__" />

Connects the module to some inputs.

##### Args:


* `inputs`: Tensor, final dimension must be equal to embedding_dim. All other
    leading dimensions will be flattened and treated as a large batch.
* `is_training`: boolean, whether this connection is to training data. When
    this is set to False, the internal moving average statistics will not be
    updated.

##### Returns:

  dict containing the following keys and values:

* `quantize`: Tensor containing the quantized version of the input.
* `loss`: Tensor containing the loss to optimize.
* `perplexity`: Tensor containing the perplexity of the encodings.
* `encodings`: Tensor containing the discrete encodings, ie which element
      of the quantized space each input element was mapped to.
* `encoding_indices`: Tensor containing the discrete encoding indices, ie
      which element of the quantized space each input element was mapped to.


#### [`nets.VectorQuantizerEMA.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="nets.VectorQuantizerEMA.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`nets.VectorQuantizerEMA.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="nets.VectorQuantizerEMA.defun" />

Wraps this modules call method in a callable graph function.


#### [`nets.VectorQuantizerEMA.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="nets.VectorQuantizerEMA.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`nets.VectorQuantizerEMA.embeddings`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/vqvae.py?l=254)<a id="nets.VectorQuantizerEMA.embeddings" />




#### [`nets.VectorQuantizerEMA.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="nets.VectorQuantizerEMA.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.VectorQuantizerEMA.get_possible_initializer_keys()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=505)<a id="nets.VectorQuantizerEMA.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`nets.VectorQuantizerEMA.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="nets.VectorQuantizerEMA.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.VectorQuantizerEMA.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="nets.VectorQuantizerEMA.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`nets.VectorQuantizerEMA.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="nets.VectorQuantizerEMA.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`nets.VectorQuantizerEMA.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="nets.VectorQuantizerEMA.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.VectorQuantizerEMA.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="nets.VectorQuantizerEMA.module_name" />

Returns the name of the Module.


#### [`nets.VectorQuantizerEMA.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="nets.VectorQuantizerEMA.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`nets.VectorQuantizerEMA.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="nets.VectorQuantizerEMA.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.VectorQuantizerEMA.quantize(encoding_indices)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/vqvae.py?l=258)<a id="nets.VectorQuantizerEMA.quantize" />




#### [`nets.VectorQuantizerEMA.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="nets.VectorQuantizerEMA.scope_name" />

Returns the full name of the Module's variable scope.


#### [`nets.VectorQuantizerEMA.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="nets.VectorQuantizerEMA.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.VectorQuantizerEMA.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="nets.VectorQuantizerEMA.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.VectorQuantizerEMA.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="nets.VectorQuantizerEMA.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.



### [`nets.future_mask(chunk_size, dtype)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/transformer.py?l=146)<a id="nets.future_mask" />

Creates attention mask to ensure an element i cannot attend to j > i.


### [`nets.identity_kernel_initializer(shape, dtype=tf.float32, partition_info=None)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/dilation.py?l=74)<a id="nets.identity_kernel_initializer" />

An initializer for constructing identity convolution kernels.

Constructs a convolution kernel such that applying it is the same as an
identity operation on the input. Formally, the kernel has entry [i, j, in,
out] = 1 if in equals out and i and j are the middle of the kernel and 0
otherwise.

##### Args:


* `shape`: List of integers. Represents shape of result.
* `dtype`: data type for values in result.
* `partition_info`: Partition information for initializer functions. Ignored.

##### Returns:

  Tensor of desired shape and dtype such that applying it as a convolution
    kernel results in the identity operation.

##### Raises:


* `ValueError`: If shape does not define a valid kernel.
              If filter width and height differ.
              If filter width and height are not odd numbers.
              If number of input and output channels differ.


### [`nets.noisy_identity_kernel_initializer(base_num_channels, stddev=1e-08)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/dilation.py?l=121)<a id="nets.noisy_identity_kernel_initializer" />

Build an initializer for constructing near-identity convolution kernels.

Construct a convolution kernel where in_channels and out_channels are
multiples of base_num_channels, but need not be equal. This initializer is
essentially the same as identity_kernel_initializer, except that magnitude
is "spread out" across multiple copies of the input.

##### Args:


* `base_num_channels`: int. Number that divides both in_channels and
    out_channels.
* `stddev`: float. Standard deviation of truncated normal noise added to
    off-entries to break ties.

##### Returns:

  Initializer function for building a noisy identity kernel.


### [`class nets.transformer.AttentionState`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/transformer.py?q=class:AttentionState)<a id="nets.transformer.AttentionState" />

AttentionState(queries, keys, values, logits, weights, embeddings, read_words)

#### `nets.transformer.AttentionState.embeddings`<a id="nets.transformer.AttentionState.embeddings" />

Alias for field number 5


#### `nets.transformer.AttentionState.keys`<a id="nets.transformer.AttentionState.keys" />

Alias for field number 1


#### `nets.transformer.AttentionState.logits`<a id="nets.transformer.AttentionState.logits" />

Alias for field number 3


#### `nets.transformer.AttentionState.queries`<a id="nets.transformer.AttentionState.queries" />

Alias for field number 0


#### `nets.transformer.AttentionState.read_words`<a id="nets.transformer.AttentionState.read_words" />

Alias for field number 6


#### `nets.transformer.AttentionState.values`<a id="nets.transformer.AttentionState.values" />

Alias for field number 2


#### `nets.transformer.AttentionState.weights`<a id="nets.transformer.AttentionState.weights" />

Alias for field number 4



### [`class nets.transformer.MultiheadAttention`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/transformer.py?q=class:MultiheadAttention)<a id="nets.transformer.MultiheadAttention" />

Implements multi-head attention with optional state context.

#### [`nets.transformer.MultiheadAttention.__init__(value_size, key_size, num_heads, mask=None, scaling=True, positional_encodings=None, use_relative_positions=False, init_std=2.0, name='multihead_attention')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/transformer.py?l=234)<a id="nets.transformer.MultiheadAttention.__init__" />

Creates a MultiheadAttention module.

##### Args:


* `value_size`: V parameter. See size glossary in class docstring.
* `key_size`: K parameter. See size glossary in class docstring.
* `num_heads`: The number of independent queries per timestep.
* `mask`: Optional mask to attention logits. This can prevent attending to
    future positions or unused memory slots.
* `scaling`: Whether to scale the attention logits.
* `positional_encodings`: Either None (none given) or a tuple of
    `(key_positional_encodings, query_positional_encodings)`.
* `use_relative_positions`: If True then relative positions are incorporated,
    vs absolute, into the attention logits. This is done exactly as
    described in the TransformerXL, Dai et al. 2019.
* `init_std`: scaling of standard deviation for weight matrices init.
* `name`: Name of module.


#### [`nets.transformer.MultiheadAttention.__call__(inputs, is_training, query_inputs=None, state=None, dropout_keep_prob=0.5)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/transformer.py?l=290)<a id="nets.transformer.MultiheadAttention.__call__" />

Add elements to the Graph, computing output Tensors from input Tensors.

Subclasses must implement this method, which will be wrapped in a Template.

##### Args:


* `*args`: Input Tensors.
* `**kwargs`: Additional Python flags controlling connection.

##### Returns:

  output Tensor(s).


#### [`nets.transformer.MultiheadAttention.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="nets.transformer.MultiheadAttention.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`nets.transformer.MultiheadAttention.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="nets.transformer.MultiheadAttention.defun" />

Wraps this modules call method in a callable graph function.


#### [`nets.transformer.MultiheadAttention.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="nets.transformer.MultiheadAttention.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`nets.transformer.MultiheadAttention.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="nets.transformer.MultiheadAttention.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.transformer.MultiheadAttention.get_possible_initializer_keys()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=505)<a id="nets.transformer.MultiheadAttention.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`nets.transformer.MultiheadAttention.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="nets.transformer.MultiheadAttention.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.transformer.MultiheadAttention.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="nets.transformer.MultiheadAttention.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`nets.transformer.MultiheadAttention.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="nets.transformer.MultiheadAttention.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`nets.transformer.MultiheadAttention.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="nets.transformer.MultiheadAttention.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.transformer.MultiheadAttention.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="nets.transformer.MultiheadAttention.module_name" />

Returns the name of the Module.


#### [`nets.transformer.MultiheadAttention.multihead_linear(inputs, name)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/transformer.py?l=278)<a id="nets.transformer.MultiheadAttention.multihead_linear" />




#### [`nets.transformer.MultiheadAttention.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="nets.transformer.MultiheadAttention.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`nets.transformer.MultiheadAttention.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="nets.transformer.MultiheadAttention.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.transformer.MultiheadAttention.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="nets.transformer.MultiheadAttention.scope_name" />

Returns the full name of the Module's variable scope.


#### [`nets.transformer.MultiheadAttention.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="nets.transformer.MultiheadAttention.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.transformer.MultiheadAttention.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="nets.transformer.MultiheadAttention.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.transformer.MultiheadAttention.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="nets.transformer.MultiheadAttention.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.



### [`class nets.transformer.ResidualDropoutWrapper`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/transformer.py?q=class:ResidualDropoutWrapper)<a id="nets.transformer.ResidualDropoutWrapper" />

Wrapper class that applies residual connections, dropout and layer norm.

By default applies a relu to the module output before the other operations.

#### [`nets.transformer.ResidualDropoutWrapper.__init__(layer, dropout_rate, layer_norm='input', name='residual_dropout_wrapper')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/transformer.py?l=115)<a id="nets.transformer.ResidualDropoutWrapper.__init__" />

Performs the initialisation necessary for all AbstractModule instances.

Every subclass of AbstractModule must begin their constructor with a call to
this constructor, i.e.

`super(MySubModule, self).__init__(custom_getter=custom_getter, name=name)`.

If you instantiate sub-modules in __init__ you must create them within the
`_enter_variable_scope` context manager to ensure they are in the module's
variable scope. Alternatively, instantiate sub-modules in `_build`.

##### Args:

  _sentinel: Variable that only carries a non-None value if `__init__` was
      called without named parameters. If this is the case, a deprecation
      warning is issued in form of a `ValueError`.

* `custom_getter`: Callable or dictionary of callables to use as
    custom getters inside the module. If a dictionary, the keys
    correspond to regexes to match variable names. See the `tf.get_variable`
    documentation for information about the custom_getter API.
* `name`: Name of this module. Used to construct the Templated build function.
      If `None` the module's class name is used (converted to snake case).

##### Raises:


* `TypeError`: If `name` is not a string.
* `TypeError`: If a given `custom_getter` is not callable.
* `ValueError`: If `__init__` was called without named arguments.


#### [`nets.transformer.ResidualDropoutWrapper.__call__(inputs, *args, **kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/transformer.py?l=125)<a id="nets.transformer.ResidualDropoutWrapper.__call__" />

Add elements to the Graph, computing output Tensors from input Tensors.

Subclasses must implement this method, which will be wrapped in a Template.

##### Args:


* `*args`: Input Tensors.
* `**kwargs`: Additional Python flags controlling connection.

##### Returns:

  output Tensor(s).


#### [`nets.transformer.ResidualDropoutWrapper.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="nets.transformer.ResidualDropoutWrapper.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`nets.transformer.ResidualDropoutWrapper.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="nets.transformer.ResidualDropoutWrapper.defun" />

Wraps this modules call method in a callable graph function.


#### [`nets.transformer.ResidualDropoutWrapper.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="nets.transformer.ResidualDropoutWrapper.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`nets.transformer.ResidualDropoutWrapper.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="nets.transformer.ResidualDropoutWrapper.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.transformer.ResidualDropoutWrapper.get_possible_initializer_keys()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=505)<a id="nets.transformer.ResidualDropoutWrapper.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`nets.transformer.ResidualDropoutWrapper.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="nets.transformer.ResidualDropoutWrapper.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.transformer.ResidualDropoutWrapper.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="nets.transformer.ResidualDropoutWrapper.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`nets.transformer.ResidualDropoutWrapper.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="nets.transformer.ResidualDropoutWrapper.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`nets.transformer.ResidualDropoutWrapper.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="nets.transformer.ResidualDropoutWrapper.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.transformer.ResidualDropoutWrapper.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="nets.transformer.ResidualDropoutWrapper.module_name" />

Returns the name of the Module.


#### [`nets.transformer.ResidualDropoutWrapper.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="nets.transformer.ResidualDropoutWrapper.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`nets.transformer.ResidualDropoutWrapper.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="nets.transformer.ResidualDropoutWrapper.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.transformer.ResidualDropoutWrapper.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="nets.transformer.ResidualDropoutWrapper.scope_name" />

Returns the full name of the Module's variable scope.


#### [`nets.transformer.ResidualDropoutWrapper.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="nets.transformer.ResidualDropoutWrapper.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.transformer.ResidualDropoutWrapper.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="nets.transformer.ResidualDropoutWrapper.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`nets.transformer.ResidualDropoutWrapper.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="nets.transformer.ResidualDropoutWrapper.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.



### [`nets.transformer.create_mask(inputs, state, equal_window)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/transformer.py?l=156)<a id="nets.transformer.create_mask" />

Creates mask for future sequence positions.

##### Args:


* `inputs`: inputs tensor of shape [B, N, D]
* `state`: optional tensor of shape [B, M, D]
* `equal_window`: if True, then each activation has an equally-sized attention
    window of length 'M'. This only makes sense if a state is given.

##### Returns:

  Float tensor of shape [1, 1, N, N + M], to be summed with logits.


### [`nets.transformer.default_mlp(hidden_sizes, activate_final=False, init_std=2.0, **kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/transformer.py?l=193)<a id="nets.transformer.default_mlp" />

Standard batch-applied MLP for transformer modules.


### [`nets.transformer.get_position_encodings(sequence_length, hidden_size, clamp_value, max_timescale=10000.0, min_timescale=2.0)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/transformer.py?l=205)<a id="nets.transformer.get_position_encodings" />

Creates sinusoidal encodings of shape [1, N + M, D].


### [`nets.transformer.rel_shift(position_logits)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/nets/transformer.py?l=54)<a id="nets.transformer.rel_shift" />

Shifting of logits for relative attention.

##### Args:


* `position_logits`: A tensor of shape [B, H, N, N + M].

##### Returns:

  The shifted logits. Example, for input (H=1, B=1):
    [5, 4, 3, 2, 1]
    [5, 4, 3, 2, 1]
    [5, 4, 3, 2, 1]
    [5, 4, 3, 2, 1]
    [5, 4, 3, 2, 1]

  the function outputs:
    [1, 0, 5, 4, 3]
    [2, 1, 0, 5, 4]
    [3, 2, 1, 0, 5]
    [4, 3, 2, 1, 0]
    [5, 4, 3, 2, 1]

##### Raises:

  ValueError if position_logits is not 4D.


* `Note`: this is not an exact shift as the upper triangle is non-zero. This
works as intended in the causally-masked case. If this is used with un-masked
attention, we'd want these to also be zero.


### [`class protos.module_pb2.NestedData`](https://github.com/deepmind/sonnet/blob/master/sonnet/protos/module_pb2.py?q=class:NestedData)<a id="protos.module_pb2.NestedData" />

A ProtocolMessage


### [`class protos.module_pb2.SonnetModule`](https://github.com/deepmind/sonnet/blob/master/sonnet/protos/module_pb2.py?q=class:SonnetModule)<a id="protos.module_pb2.SonnetModule" />

A ProtocolMessage


### [`class python.modules.attention.AttentionOutput`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/attention.py?q=class:AttentionOutput)<a id="python.modules.attention.AttentionOutput" />

AttentionOutput(read, weights, weight_logits)

#### `python.modules.attention.AttentionOutput.read`<a id="python.modules.attention.AttentionOutput.read" />

Alias for field number 0


#### `python.modules.attention.AttentionOutput.weight_logits`<a id="python.modules.attention.AttentionOutput.weight_logits" />

Alias for field number 2


#### `python.modules.attention.AttentionOutput.weights`<a id="python.modules.attention.AttentionOutput.weights" />

Alias for field number 1



### [`python.modules.base.get_connection_stack()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=72)<a id="python.modules.base.get_connection_stack" />




### [`python.modules.base.get_module_stack()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=71)<a id="python.modules.base.get_module_stack" />




### [`class python.modules.base_info.ConnectedSubGraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base_info.py?q=class:ConnectedSubGraph)<a id="python.modules.base_info.ConnectedSubGraph" />

ConnectedSubGraph(module, name_scope, inputs, outputs)

#### `python.modules.base_info.ConnectedSubGraph.inputs`<a id="python.modules.base_info.ConnectedSubGraph.inputs" />

Alias for field number 2


#### `python.modules.base_info.ConnectedSubGraph.module`<a id="python.modules.base_info.ConnectedSubGraph.module" />

Alias for field number 0


#### `python.modules.base_info.ConnectedSubGraph.name_scope`<a id="python.modules.base_info.ConnectedSubGraph.name_scope" />

Alias for field number 1


#### `python.modules.base_info.ConnectedSubGraph.outputs`<a id="python.modules.base_info.ConnectedSubGraph.outputs" />

Alias for field number 3



### [`class python.modules.base_info.ModuleInfo`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base_info.py?q=class:ModuleInfo)<a id="python.modules.base_info.ModuleInfo" />

ModuleInfo(module_name, scope_name, class_name, connected_subgraphs)

#### `python.modules.base_info.ModuleInfo.class_name`<a id="python.modules.base_info.ModuleInfo.class_name" />

Alias for field number 2


#### `python.modules.base_info.ModuleInfo.connected_subgraphs`<a id="python.modules.base_info.ModuleInfo.connected_subgraphs" />

Alias for field number 3


#### `python.modules.base_info.ModuleInfo.module_name`<a id="python.modules.base_info.ModuleInfo.module_name" />

Alias for field number 0


#### `python.modules.base_info.ModuleInfo.scope_name`<a id="python.modules.base_info.ModuleInfo.scope_name" />

Alias for field number 1



### [`python.modules.basic.calculate_bias_shape(input_shape, bias_dims)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?l=495)<a id="python.modules.basic.calculate_bias_shape" />

Calculate `bias_shape` based on the `input_shape` and `bias_dims`.

##### Args:


* `input_shape`: Shape of the input being passed into the module. The leading
      dimension is the minibatch size.
* `bias_dims`: The dimensions that bias should be applied over. The remaining
      dimensions will get broadcasted over.

##### Returns:


* `bias_shape`: Tuple corresponding to the shape of bias Variable to create.

##### Raises:


* `ValueError`: If the user attempts to add bias over the minibatch dimension,
      e.g. `bias_dims=[0]`.


### [`python.modules.basic.create_bias_initializer(unused_bias_shape, dtype=tf.float32)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?l=130)<a id="python.modules.basic.create_bias_initializer" />

Returns a default initializer for the biases of a linear/AddBias module.


### [`python.modules.basic.create_linear_initializer(input_size, dtype=tf.float32)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/basic.py?l=124)<a id="python.modules.basic.create_linear_initializer" />

Returns a default initializer for weights of a linear module.


### [`python.modules.batch_norm.create_beta_initializer()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/batch_norm.py?l=37)<a id="python.modules.batch_norm.create_beta_initializer" />

Returns a default initializer for the `beta` in batch norm.


### [`python.modules.batch_norm.create_gamma_initializer()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/batch_norm.py?l=42)<a id="python.modules.batch_norm.create_gamma_initializer" />

Returns a default initializer for the `gamma` in batch norm.


### [`python.modules.batch_norm.create_mean_initializer()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/batch_norm.py?l=47)<a id="python.modules.batch_norm.create_mean_initializer" />

Returns a default initializer for the `moving_mean` in batch norm.


### [`python.modules.batch_norm.create_variance_initializer()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/batch_norm.py?l=52)<a id="python.modules.batch_norm.create_variance_initializer" />

Returns a default initializer for the `moving_variance` in batch norm.


### [`python.modules.batch_norm_v2.create_beta_initializer()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/batch_norm_v2.py?l=49)<a id="python.modules.batch_norm_v2.create_beta_initializer" />

Returns a default initializer for the `beta` in batch norm.


### [`python.modules.batch_norm_v2.create_gamma_initializer()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/batch_norm_v2.py?l=54)<a id="python.modules.batch_norm_v2.create_gamma_initializer" />

Returns a default initializer for the `gamma` in batch norm.


### [`python.modules.batch_norm_v2.create_mean_initializer()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/batch_norm_v2.py?l=59)<a id="python.modules.batch_norm_v2.create_mean_initializer" />

Returns a default initializer for the `moving_mean` in batch norm.


### [`python.modules.batch_norm_v2.create_variance_initializer()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/batch_norm_v2.py?l=64)<a id="python.modules.batch_norm_v2.create_variance_initializer" />

Returns a default initializer for the `moving_variance` in batch norm.


### [`python.modules.conv.create_bias_initializer(unused_bias_shape, dtype=tf.float32)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=328)<a id="python.modules.conv.create_bias_initializer" />

Returns a default initializer for the biases of a convolutional module.


### [`python.modules.conv.create_weight_initializer(fan_in_shape, dtype=tf.float32)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/conv.py?l=322)<a id="python.modules.conv.create_weight_initializer" />

Returns a default initializer for the weights of a convolutional module.


### [`class python.modules.gated_rnn.ConvLSTM`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?q=class:ConvLSTM)<a id="python.modules.gated_rnn.ConvLSTM" />

Convolutional LSTM.

#### [`python.modules.gated_rnn.ConvLSTM.__init__(conv_ndims, input_shape, output_channels, kernel_shape, stride=1, rate=1, padding='SAME', use_bias=True, legacy_bias_behaviour=True, forget_bias=1.0, initializers=None, partitioners=None, regularizers=None, use_layer_norm=False, custom_getter=None, name='conv_lstm')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=1232)<a id="python.modules.gated_rnn.ConvLSTM.__init__" />

Construct ConvLSTM.

##### Args:


* `conv_ndims`: Convolution dimensionality (1, 2 or 3).
* `input_shape`: Shape of the input as an iterable, excluding the batch size.
* `output_channels`: Number of output channels of the conv LSTM.
* `kernel_shape`: Sequence of kernel sizes (of size conv_ndims), or integer
      that is used to define kernel size in all dimensions.
* `stride`: Sequence of kernel strides (of size conv_ndims), or integer that
      is used to define stride in all dimensions.
* `rate`: Sequence of dilation rates (of size conv_ndims), or integer that is
      used to define dilation rate in all dimensions. 1 corresponds to a
      standard convolution, while rate > 1 corresponds to a dilated
      convolution. Cannot be > 1 if any of stride is also > 1.
* `padding`: Padding algorithm, either `snt.SAME` or `snt.VALID`.
* `use_bias`: Use bias in convolutions.
* `legacy_bias_behaviour`: If True, bias is applied to both input and hidden
    convolutions, creating a redundant bias variable. If False, bias is only
    applied to input convolution, removing the redundancy.
* `forget_bias`: Forget bias.
* `initializers`: Dict containing ops to initialize the convolutional weights.
* `partitioners`: Optional dict containing partitioners to partition
    the convolutional weights and biases. As a default, no partitioners are
    used.
* `regularizers`: Optional dict containing regularizers for the convolutional
    weights and biases. As a default, no regularizers are used.
* `use_layer_norm`: Boolean that indicates whether to apply layer
    normalization. This is applied across the entire layer, normalizing
    over all non-batch dimensions.
* `custom_getter`: Callable that takes as a first argument the true getter,
    and allows overwriting the internal get_variable method. See the
    `tf.get_variable` documentation for more details.
* `name`: Name of the module.

##### Raises:


* `ValueError`: If `skip_connection` is `True` and stride is different from 1
    or if `input_shape` is incompatible with `conv_ndims`.


#### [`python.modules.gated_rnn.ConvLSTM.__call__(inputs, state)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=1371)<a id="python.modules.gated_rnn.ConvLSTM.__call__" />

Add elements to the Graph, computing output Tensors from input Tensors.

Subclasses must implement this method, which will be wrapped in a Template.

##### Args:


* `*args`: Input Tensors.
* `**kwargs`: Additional Python flags controlling connection.

##### Returns:

  output Tensor(s).


#### [`python.modules.gated_rnn.ConvLSTM.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="python.modules.gated_rnn.ConvLSTM.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`python.modules.gated_rnn.ConvLSTM.convolutions`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=1354)<a id="python.modules.gated_rnn.ConvLSTM.convolutions" />




#### [`python.modules.gated_rnn.ConvLSTM.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="python.modules.gated_rnn.ConvLSTM.defun" />

Wraps this modules call method in a callable graph function.


#### [`python.modules.gated_rnn.ConvLSTM.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="python.modules.gated_rnn.ConvLSTM.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`python.modules.gated_rnn.ConvLSTM.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="python.modules.gated_rnn.ConvLSTM.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`python.modules.gated_rnn.ConvLSTM.get_possible_initializer_keys(conv_ndims, use_bias=True)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=1216)<a id="python.modules.gated_rnn.ConvLSTM.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`python.modules.gated_rnn.ConvLSTM.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="python.modules.gated_rnn.ConvLSTM.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`python.modules.gated_rnn.ConvLSTM.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="python.modules.gated_rnn.ConvLSTM.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`python.modules.gated_rnn.ConvLSTM.initial_state(batch_size, dtype=tf.float32, trainable=False, trainable_initializers=None, trainable_regularizers=None, name=None, **unused_kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/rnn_core.py?l=204)<a id="python.modules.gated_rnn.ConvLSTM.initial_state" />

Builds the default start state for an RNNCore.

##### Args:


* `batch_size`: An int, or scalar int32 Tensor representing the batch size.
* `dtype`: The data type to use for the state.
* `trainable`: Boolean that indicates whether to learn the initial state.
    Note that intializers and regularizers will be ignored if
    `trainable=False`.
* `trainable_initializers`: An initializer function or nested structure of
      functions with same structure as the `state_size` property of the
      core, to be used as initializers of the initial state variable.
* `trainable_regularizers`: Optional regularizer function or nested structure
    of functions with the same structure as the `state_size` property of the
    core, to be used as regularizers of the initial state variable. As a
    default, no regularizers are used. A regularizer should be a function
    that takes a single `Tensor` as an input and returns a scalar `Tensor`
    output, e.g. the L1 and L2 regularizers in `tf.contrib.layers`.
* `name`: Optional string used to prefix the initial state variable names, in
      the case of a trainable initial state. If not provided, defaults to
      the name of the module.

##### Returns:

  A tensor or nested tuple of tensors with same structure and shape as the
  `state_size` property of the core.

##### Raises:


* `ValueError`: if the user passes initializers that are not functions.
* `ValueError`: if the user passes regularizers that are not functions.


#### [`python.modules.gated_rnn.ConvLSTM.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="python.modules.gated_rnn.ConvLSTM.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`python.modules.gated_rnn.ConvLSTM.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="python.modules.gated_rnn.ConvLSTM.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`python.modules.gated_rnn.ConvLSTM.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="python.modules.gated_rnn.ConvLSTM.module_name" />

Returns the name of the Module.


#### [`python.modules.gated_rnn.ConvLSTM.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="python.modules.gated_rnn.ConvLSTM.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`python.modules.gated_rnn.ConvLSTM.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="python.modules.gated_rnn.ConvLSTM.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`python.modules.gated_rnn.ConvLSTM.output_size`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=1365)<a id="python.modules.gated_rnn.ConvLSTM.output_size" />

`tf.TensorShape` indicating the size of the core output.


#### [`python.modules.gated_rnn.ConvLSTM.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="python.modules.gated_rnn.ConvLSTM.scope_name" />

Returns the full name of the Module's variable scope.


#### [`python.modules.gated_rnn.ConvLSTM.state_size`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=1358)<a id="python.modules.gated_rnn.ConvLSTM.state_size" />

Tuple of `tf.TensorShape`s indicating the size of state tensors.


#### [`python.modules.gated_rnn.ConvLSTM.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="python.modules.gated_rnn.ConvLSTM.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`python.modules.gated_rnn.ConvLSTM.use_layer_norm`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=1403)<a id="python.modules.gated_rnn.ConvLSTM.use_layer_norm" />

Boolean indicating whether layer norm is enabled.


#### [`python.modules.gated_rnn.ConvLSTM.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="python.modules.gated_rnn.ConvLSTM.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`python.modules.gated_rnn.ConvLSTM.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="python.modules.gated_rnn.ConvLSTM.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`python.modules.gated_rnn.ConvLSTM.zero_state(batch_size, dtype)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/rnn_core.py?l=260)<a id="python.modules.gated_rnn.ConvLSTM.zero_state" />

Return zero-filled state tensor(s).

##### Args:


* `batch_size`: int, float, or unit Tensor representing the batch size.
* `dtype`: the data type to use for the state.

##### Returns:

  If `state_size` is an int or TensorShape, then the return value is a
  `N-D` tensor of shape `[batch_size x state_size]` filled with zeros.

  If `state_size` is a nested list or tuple, then the return value is
  a nested list or tuple (of the same structure) of `2-D` tensors with
  the shapes `[batch_size x s]` for each s in `state_size`.



### [`class python.modules.gated_rnn.RecurrentDropoutWrapper`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?q=class:RecurrentDropoutWrapper)<a id="python.modules.gated_rnn.RecurrentDropoutWrapper" />

Wraps an RNNCore so that recurrent dropout can be applied.

#### [`python.modules.gated_rnn.RecurrentDropoutWrapper.__init__(core, keep_probs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=363)<a id="python.modules.gated_rnn.RecurrentDropoutWrapper.__init__" />

Builds a new wrapper around a given core.

##### Args:


* `core`: the RNN core to be wrapped.
* `keep_probs`: the recurrent dropout keep probabilities to apply.
    This should have the same structure has core.init_state. No dropout is
    applied for leafs set to None.


#### [`python.modules.gated_rnn.RecurrentDropoutWrapper.__call__(inputs, prev_state)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=394)<a id="python.modules.gated_rnn.RecurrentDropoutWrapper.__call__" />

Add elements to the Graph, computing output Tensors from input Tensors.

Subclasses must implement this method, which will be wrapped in a Template.

##### Args:


* `*args`: Input Tensors.
* `**kwargs`: Additional Python flags controlling connection.

##### Returns:

  output Tensor(s).


#### [`python.modules.gated_rnn.RecurrentDropoutWrapper.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="python.modules.gated_rnn.RecurrentDropoutWrapper.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`python.modules.gated_rnn.RecurrentDropoutWrapper.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="python.modules.gated_rnn.RecurrentDropoutWrapper.defun" />

Wraps this modules call method in a callable graph function.


#### [`python.modules.gated_rnn.RecurrentDropoutWrapper.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="python.modules.gated_rnn.RecurrentDropoutWrapper.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`python.modules.gated_rnn.RecurrentDropoutWrapper.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="python.modules.gated_rnn.RecurrentDropoutWrapper.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`python.modules.gated_rnn.RecurrentDropoutWrapper.get_possible_initializer_keys()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=505)<a id="python.modules.gated_rnn.RecurrentDropoutWrapper.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`python.modules.gated_rnn.RecurrentDropoutWrapper.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="python.modules.gated_rnn.RecurrentDropoutWrapper.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`python.modules.gated_rnn.RecurrentDropoutWrapper.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="python.modules.gated_rnn.RecurrentDropoutWrapper.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`python.modules.gated_rnn.RecurrentDropoutWrapper.initial_state(batch_size, dtype=tf.float32, trainable=False, trainable_initializers=None, trainable_regularizers=None, name=None)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=406)<a id="python.modules.gated_rnn.RecurrentDropoutWrapper.initial_state" />

Builds the default start state tensor of zeros.


#### [`python.modules.gated_rnn.RecurrentDropoutWrapper.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="python.modules.gated_rnn.RecurrentDropoutWrapper.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`python.modules.gated_rnn.RecurrentDropoutWrapper.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="python.modules.gated_rnn.RecurrentDropoutWrapper.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`python.modules.gated_rnn.RecurrentDropoutWrapper.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="python.modules.gated_rnn.RecurrentDropoutWrapper.module_name" />

Returns the name of the Module.


#### [`python.modules.gated_rnn.RecurrentDropoutWrapper.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="python.modules.gated_rnn.RecurrentDropoutWrapper.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`python.modules.gated_rnn.RecurrentDropoutWrapper.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="python.modules.gated_rnn.RecurrentDropoutWrapper.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`python.modules.gated_rnn.RecurrentDropoutWrapper.output_size`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=431)<a id="python.modules.gated_rnn.RecurrentDropoutWrapper.output_size" />

Integer or TensorShape: size of outputs produced by this cell.


#### [`python.modules.gated_rnn.RecurrentDropoutWrapper.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="python.modules.gated_rnn.RecurrentDropoutWrapper.scope_name" />

Returns the full name of the Module's variable scope.


#### [`python.modules.gated_rnn.RecurrentDropoutWrapper.state_size`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=427)<a id="python.modules.gated_rnn.RecurrentDropoutWrapper.state_size" />

size(s) of state(s) used by this cell.

It can be represented by an Integer, a TensorShape or a tuple of Integers
or TensorShapes.


#### [`python.modules.gated_rnn.RecurrentDropoutWrapper.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="python.modules.gated_rnn.RecurrentDropoutWrapper.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`python.modules.gated_rnn.RecurrentDropoutWrapper.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="python.modules.gated_rnn.RecurrentDropoutWrapper.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`python.modules.gated_rnn.RecurrentDropoutWrapper.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="python.modules.gated_rnn.RecurrentDropoutWrapper.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`python.modules.gated_rnn.RecurrentDropoutWrapper.zero_state(batch_size, dtype)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/rnn_core.py?l=260)<a id="python.modules.gated_rnn.RecurrentDropoutWrapper.zero_state" />

Return zero-filled state tensor(s).

##### Args:


* `batch_size`: int, float, or unit Tensor representing the batch size.
* `dtype`: the data type to use for the state.

##### Returns:

  If `state_size` is an int or TensorShape, then the return value is a
  `N-D` tensor of shape `[batch_size x state_size]` filled with zeros.

  If `state_size` is a nested list or tuple, then the return value is
  a nested list or tuple (of the same structure) of `2-D` tensors with
  the shapes `[batch_size x s]` for each s in `state_size`.



### [`class python.modules.gated_rnn.ZoneoutWrapper`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?q=class:ZoneoutWrapper)<a id="python.modules.gated_rnn.ZoneoutWrapper" />

Wraps an RNNCore so that zoneout can be applied.

Zoneout was introduced in https://arxiv.org/abs/1606.01305
It consists of randomly freezing some RNN state in the same way recurrent
dropout would replace this state with zero.

#### [`python.modules.gated_rnn.ZoneoutWrapper.__init__(core, keep_probs, is_training)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=462)<a id="python.modules.gated_rnn.ZoneoutWrapper.__init__" />

Builds a new wrapper around a given core.

##### Args:


* `core`: the RNN core to be wrapped.
* `keep_probs`: the probabilities to use the updated states rather than
    keeping the old state values. This is one minus the probability
    that zoneout gets applied.
    This should have the same structure has core.init_state. No zoneout is
    applied for leafs set to None.
* `is_training`: when set, apply some stochastic zoneout. Otherwise perform
    a linear combination of the previous state and the current state based
    on the zoneout probability.


#### [`python.modules.gated_rnn.ZoneoutWrapper.__call__(inputs, prev_state)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=483)<a id="python.modules.gated_rnn.ZoneoutWrapper.__call__" />

Add elements to the Graph, computing output Tensors from input Tensors.

Subclasses must implement this method, which will be wrapped in a Template.

##### Args:


* `*args`: Input Tensors.
* `**kwargs`: Additional Python flags controlling connection.

##### Returns:

  output Tensor(s).


#### [`python.modules.gated_rnn.ZoneoutWrapper.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="python.modules.gated_rnn.ZoneoutWrapper.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`python.modules.gated_rnn.ZoneoutWrapper.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="python.modules.gated_rnn.ZoneoutWrapper.defun" />

Wraps this modules call method in a callable graph function.


#### [`python.modules.gated_rnn.ZoneoutWrapper.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="python.modules.gated_rnn.ZoneoutWrapper.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`python.modules.gated_rnn.ZoneoutWrapper.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="python.modules.gated_rnn.ZoneoutWrapper.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`python.modules.gated_rnn.ZoneoutWrapper.get_possible_initializer_keys()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=505)<a id="python.modules.gated_rnn.ZoneoutWrapper.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`python.modules.gated_rnn.ZoneoutWrapper.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="python.modules.gated_rnn.ZoneoutWrapper.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`python.modules.gated_rnn.ZoneoutWrapper.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="python.modules.gated_rnn.ZoneoutWrapper.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`python.modules.gated_rnn.ZoneoutWrapper.initial_state(batch_size, dtype=tf.float32, trainable=False, trainable_initializers=None, trainable_regularizers=None, name=None)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=505)<a id="python.modules.gated_rnn.ZoneoutWrapper.initial_state" />

Builds the default start state tensor of zeros.


#### [`python.modules.gated_rnn.ZoneoutWrapper.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="python.modules.gated_rnn.ZoneoutWrapper.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`python.modules.gated_rnn.ZoneoutWrapper.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="python.modules.gated_rnn.ZoneoutWrapper.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`python.modules.gated_rnn.ZoneoutWrapper.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="python.modules.gated_rnn.ZoneoutWrapper.module_name" />

Returns the name of the Module.


#### [`python.modules.gated_rnn.ZoneoutWrapper.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="python.modules.gated_rnn.ZoneoutWrapper.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`python.modules.gated_rnn.ZoneoutWrapper.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="python.modules.gated_rnn.ZoneoutWrapper.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`python.modules.gated_rnn.ZoneoutWrapper.output_size`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=518)<a id="python.modules.gated_rnn.ZoneoutWrapper.output_size" />

Integer or TensorShape: size of outputs produced by this cell.


#### [`python.modules.gated_rnn.ZoneoutWrapper.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="python.modules.gated_rnn.ZoneoutWrapper.scope_name" />

Returns the full name of the Module's variable scope.


#### [`python.modules.gated_rnn.ZoneoutWrapper.state_size`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/gated_rnn.py?l=514)<a id="python.modules.gated_rnn.ZoneoutWrapper.state_size" />

size(s) of state(s) used by this cell.

It can be represented by an Integer, a TensorShape or a tuple of Integers
or TensorShapes.


#### [`python.modules.gated_rnn.ZoneoutWrapper.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="python.modules.gated_rnn.ZoneoutWrapper.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`python.modules.gated_rnn.ZoneoutWrapper.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="python.modules.gated_rnn.ZoneoutWrapper.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`python.modules.gated_rnn.ZoneoutWrapper.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="python.modules.gated_rnn.ZoneoutWrapper.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`python.modules.gated_rnn.ZoneoutWrapper.zero_state(batch_size, dtype)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/rnn_core.py?l=260)<a id="python.modules.gated_rnn.ZoneoutWrapper.zero_state" />

Return zero-filled state tensor(s).

##### Args:


* `batch_size`: int, float, or unit Tensor representing the batch size.
* `dtype`: the data type to use for the state.

##### Returns:

  If `state_size` is an int or TensorShape, then the return value is a
  `N-D` tensor of shape `[batch_size x state_size]` filled with zeros.

  If `state_size` is a nested list or tuple, then the return value is
  a nested list or tuple (of the same structure) of `2-D` tensors with
  the shapes `[batch_size x s]` for each s in `state_size`.



### [`python.modules.layer_norm.create_beta_initializer()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/layer_norm.py?l=204)<a id="python.modules.layer_norm.create_beta_initializer" />

Returns a default initializer for the `beta` in layer norm.


### [`python.modules.layer_norm.create_gamma_initializer()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/layer_norm.py?l=209)<a id="python.modules.layer_norm.create_gamma_initializer" />

Returns a default initializer for the `gamma` in layer norm.


### [`python.modules.rnn_core.with_doc(fn_with_doc_to_copy)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/rnn_core.py?l=386)<a id="python.modules.rnn_core.with_doc" />

Returns a decorator to copy documentation from the given function.

Docstring is copied, including *args and **kwargs documentation.

##### Args:


* `fn_with_doc_to_copy`: Function whose docstring, including *args and
    **kwargs documentation, is to be copied.

##### Returns:

  Decorated version of `wrapper_init` with documentation copied from
  `fn_with_doc_to_copy`.


### [`class python.modules.spectral_normalization.SpectralNormWrapper`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/spectral_normalization.py?q=class:SpectralNormWrapper)<a id="python.modules.spectral_normalization.SpectralNormWrapper" />

Wraps a Sonnet Module to selectively apply Spectral Normalization.

#### [`python.modules.spectral_normalization.SpectralNormWrapper.__init__(module, sn_kwargs, pow_iter_collection, *args, **kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/spectral_normalization.py?l=80)<a id="python.modules.spectral_normalization.SpectralNormWrapper.__init__" />

Constructs a wrapped Sonnet module with Spectral Normalization.

The module expects a first argument which should be a Sonnet AbstractModule
and a second argument which is a dictionary which is passed to the inner
spectral_norm function as kwargs.

When connecting this module to the graph,the argument 'pow_iter_collection'
is treated specially for this wrapper (rather than for the _build
method of the inner module). If pow_iter_collection is None (the default),
the approximate first singular value for weights will *not* be updated based
on the inputs passed at the given _build call. However an op for updating
the singular value will be placed into the pow_iter_collection global
collection.

If pow_iter_collection is None or not passed, a control dependency on the
update op will be applied to the output of the _build function. Regardless,
the kwarg is deleted from the list of keywords passed to the inner module.

##### Args:


* `module`: A constructor/class reference for a Sonnet module you would like
      to construct.
* `sn_kwargs`: Keyword arguments to be passed to the spectral_norm function
      in addition to the weight tensor.
* `pow_iter_collection`: The name of a global collection for potentially
      storing ops for updating internal variables.
* `*args`: Construction-time arguments to the module.
* `**kwargs`: Construction-time  keyword arguments to the module.


#### [`python.modules.spectral_normalization.SpectralNormWrapper.__call__(*args, **kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/spectral_normalization.py?l=125)<a id="python.modules.spectral_normalization.SpectralNormWrapper.__call__" />

Add elements to the Graph, computing output Tensors from input Tensors.

Subclasses must implement this method, which will be wrapped in a Template.

##### Args:


* `*args`: Input Tensors.
* `**kwargs`: Additional Python flags controlling connection.

##### Returns:

  output Tensor(s).


#### [`python.modules.spectral_normalization.SpectralNormWrapper.connected_subgraphs`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=481)<a id="python.modules.spectral_normalization.SpectralNormWrapper.connected_subgraphs" />

Returns the subgraphs created by this module so far.


#### [`python.modules.spectral_normalization.SpectralNormWrapper.defun()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=393)<a id="python.modules.spectral_normalization.SpectralNormWrapper.defun" />

Wraps this modules call method in a callable graph function.


#### [`python.modules.spectral_normalization.SpectralNormWrapper.defun_wrapped`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=388)<a id="python.modules.spectral_normalization.SpectralNormWrapper.defun_wrapped" />

Returns boolean indicating whether this module is defun wrapped.


#### [`python.modules.spectral_normalization.SpectralNormWrapper.get_all_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=680)<a id="python.modules.spectral_normalization.SpectralNormWrapper.get_all_variables" />

Returns all `tf.Variable`s used when the module is connected.

See the documentation for `AbstractModule._capture_variables()` for more
information.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`python.modules.spectral_normalization.SpectralNormWrapper.get_possible_initializer_keys()`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=505)<a id="python.modules.spectral_normalization.SpectralNormWrapper.get_possible_initializer_keys" />

Returns the keys the dictionary of variable initializers may contain.

This provides the user with a way of knowing the initializer keys that are
available without having to instantiate a sonnet module. Subclasses may
override this class method if they need additional arguments to determine
what initializer keys may be provided.

##### Returns:

  Set with strings corresponding to the strings that may be passed to the
      constructor.


#### [`python.modules.spectral_normalization.SpectralNormWrapper.get_variables(collection='trainable_variables')`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=642)<a id="python.modules.spectral_normalization.SpectralNormWrapper.get_variables" />

Returns tuple of `tf.Variable`s declared inside this module.

Note that this operates by searching this module's variable scope,
and so does not know about any modules that were constructed elsewhere but
used inside this module.

This method explicitly re-enters the Graph which this module has been
connected to.

##### Args:


* `collection`: Collection to restrict query to. By default this is
    `tf.GraphKeys.TRAINABLE_VARIABLES`, which doesn't
    include non-trainable variables such as moving averages.

##### Returns:

  A tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`python.modules.spectral_normalization.SpectralNormWrapper.graph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=476)<a id="python.modules.spectral_normalization.SpectralNormWrapper.graph" />

Returns the Graph instance which the module is connected to, or None.


#### [`python.modules.spectral_normalization.SpectralNormWrapper.is_connected`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=471)<a id="python.modules.spectral_normalization.SpectralNormWrapper.is_connected" />

Returns true iff the Module been connected to the Graph at least once.


#### [`python.modules.spectral_normalization.SpectralNormWrapper.last_connected_subgraph`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=489)<a id="python.modules.spectral_normalization.SpectralNormWrapper.last_connected_subgraph" />

Returns the last subgraph created by this module.

##### Returns:

  The last connected subgraph.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`python.modules.spectral_normalization.SpectralNormWrapper.module_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=466)<a id="python.modules.spectral_normalization.SpectralNormWrapper.module_name" />

Returns the name of the Module.


#### [`python.modules.spectral_normalization.SpectralNormWrapper.name_scopes`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=432)<a id="python.modules.spectral_normalization.SpectralNormWrapper.name_scopes" />

Returns a tuple of all name_scopes generated by this module.


#### [`python.modules.spectral_normalization.SpectralNormWrapper.non_trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=624)<a id="python.modules.spectral_normalization.SpectralNormWrapper.non_trainable_variables" />

All **non-trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`python.modules.spectral_normalization.SpectralNormWrapper.scope_name`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=461)<a id="python.modules.spectral_normalization.SpectralNormWrapper.scope_name" />

Returns the full name of the Module's variable scope.


#### [`python.modules.spectral_normalization.SpectralNormWrapper.sn_getter(spectral_norm_kwargs)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/spectral_normalization.py?l=132)<a id="python.modules.spectral_normalization.SpectralNormWrapper.sn_getter" />

Returns a curried spectral normalization Custom Getter.


#### [`python.modules.spectral_normalization.SpectralNormWrapper.trainable_variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=606)<a id="python.modules.spectral_normalization.SpectralNormWrapper.trainable_variables" />

All **trainable** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`python.modules.spectral_normalization.SpectralNormWrapper.variable_scope`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=440)<a id="python.modules.spectral_normalization.SpectralNormWrapper.variable_scope" />

Returns the variable_scope declared by the module.

It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection. Therefore we
raise an error here if the variable_scope is requested before connection.

The only case where it does make sense to access the variable_scope before
connection is to get the post-uniquification name, which we support using
the separate .scope_name property.

##### Returns:


* `variable_scope`: `tf.VariableScope` instance of the internal `tf.Template`.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.


#### [`python.modules.spectral_normalization.SpectralNormWrapper.variables`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/base.py?l=587)<a id="python.modules.spectral_normalization.SpectralNormWrapper.variables" />

**All** `tf.Variable`s used when the module is connected.

This property does not rely on global collections and should generally be
preferred vs. `get_variables` and `get_all_variables`.

See the documentation for `AbstractModule._capture_variables()` for more
information about what variables are captured.

##### Returns:

  A sorted (by variable name) tuple of `tf.Variable` objects.

##### Raises:


* `NotConnectedError`: If the module is not connected to the Graph.



### [`python.modules.spectral_normalization.spectral_norm(weight, num_iters=1, update_collection=None, eps=0.0001)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/spectral_normalization.py?l=167)<a id="python.modules.spectral_normalization.spectral_norm" />

Spectral Weight Normalization.

Applies first-singular-value spectral normalization to weight and returns a
tensor equivalent to weight with spectral normalization applies. By default,
it also updates an inner variable for keeping track of the spectral values of
this weight matrix. If update_collection is not None, however, this function
does not update the variable automatically, instead placing an op for this
update in the 'update_collection' global collection.

##### Args:


* `weight`: The weight tensor which requires spectral normalization
* `num_iters`: Number of SN iterations.
* `update_collection`: The update collection for assigning persisted variable u.
    If None, the function will update u0 during the forward pass. Otherwise if
    the update_collection equals 'update_collection', it will put the
    assignment in a collection defined by the user. Then the user will need to
    run the assignment explicitly.
* `eps`: numerical stability constant > 0.

##### Returns:

  A dictionary of:

* `w_bar`: The normalized weight tensor
* `sigma`: The estimated singular value for the weight tensor.
* `u0`: The internal persisted variable.


### [`python.modules.util.get_variable_scope_name(value)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/util.py?l=39)<a id="python.modules.util.get_variable_scope_name" />

Returns the name of the variable scope indicated by the given value.

##### Args:


* `value`: String, variable scope, or object with `variable_scope` attribute
  (e.g., Sonnet module).

##### Returns:

  The name (a string) of the corresponding variable scope.

##### Raises:


* `ValueError`: If `value` does not identify a variable scope.


### [`python.modules.util.name_for_callable(func)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/util.py?l=884)<a id="python.modules.util.name_for_callable" />

Returns a module name for a callable or `None` if no name can be found.


### [`python.modules.util.notify_about_new_variables(callback)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/util.py?l=157)<a id="python.modules.util.notify_about_new_variables" />

Calls `callback(var)` for all newly created variables.

Callback should not modify the variable passed in. Use cases that require
variables to be modified should use `variable_creator_scope` directly and sit
within the variable creator stack.

    >>> variables = []
    >>> with notify_about_new_variables(variables.append):
    ...   v = tf.Variable(1.0, name='v')
    ...   w = tf.get_variable('w', [])
    >>> assert variables == [v, w]

##### Args:


* `callback`: a callable taking a single argument which is a tf.Variable.

##### Yields:

  `None` - used for contextmanager API.


### [`python.modules.util.sort_by_name(variables)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/util.py?l=936)<a id="python.modules.util.sort_by_name" />

Returns a tuple of `variables` sorted ascending by name.


### [`python.modules.util.to_snake_case(camel_case)`](https://github.com/deepmind/sonnet/blob/master/sonnet/python/modules/util.py?l=900)<a id="python.modules.util.to_snake_case" />

Returns a CamelCase string as a snake_case string.


